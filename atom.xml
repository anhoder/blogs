<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[anhoderçš„è¿›é˜¶æ—¥å¿—]]></title>
  <link href="https://anhoder.github.io/atom.xml" rel="self"/>
  <link href="https://anhoder.github.io/"/>
  <updated>2020-12-20T21:21:23+08:00</updated>
  <id>https://anhoder.github.io/</id>
  <author>
    <name><![CDATA[]]></name>
    
  </author>
  <generator uri="http://www.mweb.im/">MWeb</generator>
  
  <entry>
    <title type="html"><![CDATA[PHPæ‰©å±•å¼€å‘ä¸­å¸¸ç”¨çš„å‡½æ•°]]></title>
    <link href="https://anhoder.github.io/16078713339147.html"/>
    <updated>2020-12-13T22:55:33+08:00</updated>
    <id>https://anhoder.github.io/16078713339147.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">PHPå‡½æ•°ç›¸å…³</h2>

<pre><code class="language-c">
zend_parse_parameters()     // è§£æå‡½æ•°å‚æ•°
// ä¾‹å¦‚ï¼Œsè¡¨ç¤ºå­—ç¬¦ä¸², è§£æä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å‚æ•°åˆ°name, åŠå…¶é•¿åº¦åˆ°name_len: 
if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, &quot;s&quot;, &amp;name, &amp;name_len) == FAILURE) {
    RETURN_NULL();
}

/* è§£æå‚æ•°æ—¶çš„ç±»å‹ä»£ç  */
b: å¸ƒå°”ç±»å‹ï¼ˆå¯¹åº”cç±»å‹: zend_boolï¼‰
l: æ•´å‹ï¼ˆlongï¼‰
d: æµ®ç‚¹å‹ï¼ˆdoubleï¼‰
s: å­—ç¬¦ä¸²ï¼ˆchar*, intï¼‰
r: èµ„æºå‹ï¼ˆzval*ï¼‰
a: æ•°ç»„ï¼ˆzval*ï¼‰
o: å¯¹è±¡ï¼ˆzval*ï¼‰
z: zvalï¼ˆzval*ï¼‰
</code></pre>

<blockquote>
<p>é™„ï¼šPHP 7ä¸­ä½¿ç”¨FAST_ZPPæ–¹å¼è§£æå‡½æ•°å‚æ•°çš„å®ï¼š<br/>
  <img src="media/16078683686223/16078723189095.jpg" alt=""/></p>
</blockquote>

<h2 id="toc_1">æ•°ç»„æ“ä½œ</h2>

<pre><code class="language-c">array_init(arr)                         // åˆå§‹åŒ–æ•°ç»„
add_next_index_null(zval*)              // å‘æ•°å­—ç´¢å¼•çš„æ•°ç»„å¢åŠ null
add_next_index_long(zval*, long)        // ...æ·»åŠ longç±»å‹
add_next_index_bool(zval*, 0|1)         // ...æ·»åŠ boolç±»å‹
add_next_index_double(zval*, double)  
add_next_index_string(zval*, char*, zend_bool)
add_next_index_zval(zval*, zval*)
// ...
</code></pre>

<p>æ›´å¤šæ“ä½œæ•°ç»„çš„å‡½æ•°: <a href="https://www.php.net/manual/en/internals2.variables.arrays.php">https://www.php.net/manual/en/internals2.variables.arrays.php</a></p>

<blockquote>
<p>æœªå®Œå¾…ç»­...</p>
</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPæ‰©å±•å¼€å‘ä¸­å¸¸ç”¨çš„å®å‡½æ•°]]></title>
    <link href="https://anhoder.github.io/16078683686223.html"/>
    <updated>2020-12-13T22:06:08+08:00</updated>
    <id>https://anhoder.github.io/16078683686223.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">zvalç±»å‹ç›¸å…³</h2>

<pre><code class="language-c">
Z_TYPE(zval)        // è·å–zvalçš„ç±»å‹
Z_TYPE_P(*zval)     // è·å–*zvalçš„ç±»å‹
Z_TYPE_PP(**zval)   // è·å–**zvalçš„ç±»å‹

/* zvalç±»å‹ç›¸å…³å¸¸é‡ */
IS_NULL         // null 
IS_BOOL         // å¸ƒå°”
IS_LONG         // æ•´å‹
IS_DOUBLE       // æµ®ç‚¹å‹
IS_STRING       // å­—ç¬¦ä¸²
IS_ARRAY        // æ•°ç»„
IS_OBJECT       // å¯¹è±¡
IS_RESOURCE     // èµ„æº

</code></pre>

<h2 id="toc_1">zvalå€¼ç›¸å…³</h2>

<pre><code class="language-c">//æ“ä½œæ•´æ•°çš„
#define Z_LVAL(zval)            (zval).value.lval
#define Z_LVAL_P(zval_p)        Z_LVAL(*zval_p)
#define Z_LVAL_PP(zval_pp)      Z_LVAL(**zval_pp)

//æ“ä½œIS_BOOLå¸ƒå°”å‹çš„
#define Z_BVAL(zval)            ((zend_bool)(zval).value.lval)
#define Z_BVAL_P(zval_p)        Z_BVAL(*zval_p)
#define Z_BVAL_PP(zval_pp)      Z_BVAL(**zval_pp)

//æ“ä½œæµ®ç‚¹æ•°çš„
#define Z_DVAL(zval)            (zval).value.dval
#define Z_DVAL_P(zval_p)        Z_DVAL(*zval_p)
#define Z_DVAL_PP(zval_pp)      Z_DVAL(**zval_pp)

//æ“ä½œå­—ç¬¦ä¸²çš„å€¼å’Œé•¿åº¦çš„
#define Z_STRVAL(zval)          (zval).value.str.val
#define Z_STRVAL_P(zval_p)      Z_STRVAL(*zval_p)
#define Z_STRVAL_PP(zval_pp)        Z_STRVAL(**zval_pp)

#define Z_STRLEN(zval)          (zval).value.str.len
#define Z_STRLEN_P(zval_p)      Z_STRLEN(*zval_p)
#define Z_STRLEN_PP(zval_pp)        Z_STRLEN(**zval_pp)

#define Z_ARRVAL(zval)          (zval).value.ht
#define Z_ARRVAL_P(zval_p)      Z_ARRVAL(*zval_p)
#define Z_ARRVAL_PP(zval_pp)        Z_ARRVAL(**zval_pp)

//æ“ä½œå¯¹è±¡çš„
#define Z_OBJVAL(zval)          (zval).value.obj
#define Z_OBJVAL_P(zval_p)      Z_OBJVAL(*zval_p)
#define Z_OBJVAL_PP(zval_pp)        Z_OBJVAL(**zval_pp)

#define Z_OBJ_HANDLE(zval)      Z_OBJVAL(zval).handle
#define Z_OBJ_HANDLE_P(zval_p)      Z_OBJ_HANDLE(*zval_p)
#define Z_OBJ_HANDLE_PP(zval_p)     Z_OBJ_HANDLE(**zval_p)

#define Z_OBJ_HT(zval)          Z_OBJVAL(zval).handlers
#define Z_OBJ_HT_P(zval_p)      Z_OBJ_HT(*zval_p)
#define Z_OBJ_HT_PP(zval_p)     Z_OBJ_HT(**zval_p)

#define Z_OBJCE(zval)           zend_get_class_entry(&amp;(zval) TSRMLS_CC)
#define Z_OBJCE_P(zval_p)       Z_OBJCE(*zval_p)
#define Z_OBJCE_PP(zval_pp)     Z_OBJCE(**zval_pp)

#define Z_OBJPROP(zval)         Z_OBJ_HT((zval))-&gt;get_properties(&amp;(zval) TSRMLS_CC)
#define Z_OBJPROP_P(zval_p)     Z_OBJPROP(*zval_p)
#define Z_OBJPROP_PP(zval_pp)       Z_OBJPROP(**zval_pp)

#define Z_OBJ_HANDLER(zval, hf)     Z_OBJ_HT((zval))-&gt;hf
#define Z_OBJ_HANDLER_P(zval_p, h)  Z_OBJ_HANDLER(*zval_p, h)
#define Z_OBJ_HANDLER_PP(zval_p, h)     Z_OBJ_HANDLER(**zval_p, h)

#define Z_OBJDEBUG(zval,is_tmp)     (Z_OBJ_HANDLER((zval),get_debug_info)?  \
                        Z_OBJ_HANDLER((zval),get_debug_info)(&amp;(zval),&amp;is_tmp TSRMLS_CC): \
                        (is_tmp=0,Z_OBJ_HANDLER((zval),get_properties)?Z_OBJPROP(zval):NULL)) 
#define Z_OBJDEBUG_P(zval_p,is_tmp) Z_OBJDEBUG(*zval_p,is_tmp) 
#define Z_OBJDEBUG_PP(zval_pp,is_tmp)   Z_OBJDEBUG(**zval_pp,is_tmp)

//æ“ä½œèµ„æºçš„
#define Z_RESVAL(zval)          (zval).value.lval
#define Z_RESVAL_P(zval_p)      Z_RESVAL(*zval_p)
#define Z_RESVAL_PP(zval_pp)        Z_RESVAL(**zval_pp)
</code></pre>

<h2 id="toc_2">åˆ›å»ºzval</h2>

<pre><code class="language-c">ALLOC_ZVAL              // PHP 7ä¸­ç§»é™¤
ALLOC_INIT_ZVAL         // PHP 7ä¸­ç§»é™¤
MAKE_STD_ZVAL           // PHP 7ä¸­ç§»é™¤
// ä¾‹å¦‚ï¼š
zval *val; MAKE_STD_ZVAL(val);

ZVAL_LONG(*zval, long)      // å°†æ•´å‹å€¼èµ‹ç»™*zval
ZVAL_NULL(*zval)            // null
ZVAL_BOOL(*zval, int)       // bool
ZVAL_TRUE(*zval)            // true
ZVAL_FALSE(*zval)           // false
ZVAL_LONG(*zval, long)      // long
ZVAL_DOUBLE(*zval, double)  // double
ZVAL_STRINGL(*zval,str,len,dup); // string with length
ZVAL_STRING(*zval, str, dup)     // string, dupæŒ‡æ˜äº†è¯¥å­—ç¬¦ä¸²æ˜¯å¦éœ€è¦è¢«å¤åˆ¶ã€‚ å€¼ä¸º 1 å°†å…ˆç”³è¯·ä¸€å—æ–°å†…å­˜å¹¶èµ‹å€¼è¯¥å­—ç¬¦ä¸²ï¼Œç„¶åæŠŠæ–°å†…å­˜çš„åœ°å€å¤åˆ¶ç»™pzvï¼Œ ä¸º 0 æ—¶åˆ™æ˜¯ç›´æ¥æŠŠstrçš„åœ°å€èµ‹å€¼ç»™zvalã€‚
ZVAL_RESOURCE(*zval, res);       // resource
</code></pre>

<h2 id="toc_3">å‡½æ•°ç›¸å…³</h2>

<pre><code class="language-c">ZEND_NUM_ARGS()             // è·å–å‡½æ•°å‚æ•°çš„æ•°é‡

RETVAL_STRING(s)            // å‡½æ•°è¿”å›å­—ç¬¦ä¸²
RETURN_STRING(s)            // å‡½æ•°è¿”å›å­—ç¬¦ä¸², #define RETURN_STRING(s) { RETVAL_STRING(s); return; }
RETURN_NULL()               // å‡½æ•°è¿”å›null
RETURN_TRUE()               // å‡½æ•°è¿”å›true
</code></pre>

<blockquote>
<p>é™„ï¼šPHP 7ä¸­ä½¿ç”¨FAST_ZPPæ–¹å¼è§£æå‡½æ•°å‚æ•°çš„å®ï¼š<br/>
  <img src="media/16078683686223/16078723189095.jpg" alt=""/></p>
</blockquote>

<h2 id="toc_4">æ•°ç»„æ“ä½œ</h2>

<pre><code class="language-c">ZEND_HASH_FOREACH_VAL(ht, val)
ZEND_HASH_FOREACH_KEY(ht, h, key) 
ZEND_HASH_FOREACH_PTR(ht, ptr)
ZEND_HASH_FOREACH_NUM_KEY(ht, h) 
ZEND_HASH_FOREACH_STR_KEY(ht, key)
ZEND_HASH_FOREACH_STR_KEY_VAL(ht, key, val)
ZEND_HASH_FOREACH_KEY_VAL(ht, h, key, val)

// ä¾‹å¦‚ï¼š
ZEND_HASH_FOREACH_KEY_VAL(arr_hash, num_key, key, val) {
    //if (key) { //HASH_KEY_IS_STRING
    //}
    PHPWRITE(Z_STRVAL_P(val), Z_STRLEN_P(val));
    php_printf(&quot;\n&quot;);
}ZEND_HASH_FOREACH_END();
</code></pre>

<h2 id="toc_5">ç¬¦å·è¡¨</h2>

<p>PHPçš„å˜é‡å­˜å‚¨åœ¨ç¬¦å·è¡¨ä¸­ï¼Œä¸åŒä½œç”¨åŸŸæœ‰ä¸åŒçš„ç¬¦å·è¡¨ã€‚</p>

<pre><code class="language-c">struct _zend_executor_globals {
    ...
    HashTable symbol_table;         // å…¨å±€ç¬¦å·è¡¨
    HashTable *active_symbol_table; // å½“å‰ä½œç”¨åŸŸç¬¦å·è¡¨
    ...
};
</code></pre>

<pre><code class="language-c">EG(active_symbol_table)
EG(symbol_table)
ZEND_SET_SYMBOL(symbol, var_name, val)  // è®¾ç½®å˜é‡åˆ°ç¬¦å·è¡¨
// ä¾‹å¦‚ï¼š
ZEND_SET_SYMBOL( EG(active_symbol_table) ,  &quot;foo&quot; , fooval);
</code></pre>

<blockquote>
<p>æœªå®Œå¾…ç»­...</p>
</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[åˆä¸€ä¸ªå‘½ä»¤è¡Œç‰ˆç½‘æ˜“äº‘éŸ³ä¹â€”â€”musicfox]]></title>
    <link href="https://anhoder.github.io/15981627088641.html"/>
    <updated>2020-08-23T14:05:08+08:00</updated>
    <id>https://anhoder.github.io/15981627088641.html</id>
    <content type="html"><![CDATA[
<p>musicfoxæ˜¯ä¸€æ¬¾ä½¿ç”¨Dartç¼–å†™çš„ç½‘æ˜“äº‘éŸ³ä¹å‘½ä»¤è¡Œç¨‹åºã€‚</p>

<p><img src="https://badgen.net/github/release/anhoder/musicfox" alt="last release"/> <img src="https://badgen.net/github/license/anhoder/musicfox" alt="GitHub"/> <img src="https://badgen.net/github/tag/anhoder/musicfox" alt="Last Tag"/> <img src="https://badgen.net/github/stars/anhoder/musicfox" alt="Star"/> <img src="https://badgen.net/github/last-commit/anhoder/musicfox" alt="GitHub last commit"/></p>

<h2 id="toc_0">ä¸€ã€ä¸ºä»€ä¹ˆåšè¿™ä¸ªé¡¹ç›®</h2>

<p>åœ¨å¼€å§‹è¿™ä¸ªé¡¹ç›®çš„ä¹‹å‰ï¼Œå…¶å®æ˜¯å·²ç»æœ‰ä¸€ä¸ªåŸºäºå‘½ä»¤è¡Œçš„ç½‘æ˜“äº‘éŸ³ä¹é¡¹ç›®â€”â€”<a href="https://github.com/darknessomi/musicbox" title="musicbox">musicbox</a>ã€‚</p>

<p>æˆ‘ä¹Ÿä½¿ç”¨å®ƒå¬äº†å¾ˆé•¿ä¸€æ®µæ—¶é—´çš„æ­Œäº†ï¼Œå…¶ä¸­è¿˜è´¡çŒ®è¿‡ä¸€äº›ä»£ç ï¼Œä¿®å¤å‡ ä¸ªå°é—®é¢˜ã€‚é‚£ä¸ºä»€ä¹ˆè¿˜è¦é‡æ–°é€ ä¸€ä¸ªè½®å­å‘¢ï¼Ÿ</p>

<blockquote>
<ol>
<li>musicboxç¼ºå°‘ä¸€äº›æˆ‘ç‰¹åˆ«æƒ³è¦çš„åŠŸèƒ½</li>
<li>musicboxä½¿ç”¨pythonè¿›è¡Œç¼–å†™ï¼Œæˆ‘å¯¹pythonå¹¶ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥ä¿®æ”¹æˆ–è€…æ–°å¢åŠŸèƒ½æ—¶æ¯”è¾ƒéº»çƒ¦</li>
</ol>
</blockquote>

<h2 id="toc_1">äºŒã€ä¸ºä»€ä¹ˆä½¿ç”¨Dart</h2>

<ul>
<li>Dartçš„è¯­æ³•æåƒJavaï¼Œæˆ‘æœ¬èº«ä¹Ÿå­¦è¿‡Javaï¼Œå› æ­¤å­¦ä¹ æˆæœ¬è¾ƒä½ï¼›</li>
<li>Dartå¯ä»¥å°†ä»£ç ç¼–è¯‘æˆèƒ½åœ¨ä¸‰å¤§å¹³å°ï¼ˆWindowsã€Linuxã€Macï¼‰ä¸Šç›´æ¥è¿è¡Œçš„å¯æ‰§è¡Œç¨‹åºã€‚</li>
</ul>

<h2 id="toc_2">ä¸‰ã€æ•ˆæœé¢„è§ˆ</h2>

<p><img src="media/15981627088641/preview0.png" alt="æ¬¢è¿ç•Œé¢"/></p>

<p><img src="media/15981627088641/preview1.png" alt="ä¸»ç•Œé¢1"/></p>

<p><img src="media/15981627088641/preview2.png" alt="ä¸»ç•Œé¢2"/></p>

<h2 id="toc_3">å››ã€å®‰è£…</h2>

<p>ä¾èµ–mpg123ï¼Œ<strong>å¿…é¡»å…ˆå®‰è£…mpg123</strong></p>

<h3 id="toc_4">Mac</h3>

<p>æä¾›ä¸¤ç§æ–¹å¼å®‰è£…ï¼š</p>

<ol>
<li>è¿›å…¥åˆ°<a href="https://github.com/anhoder/musicfox/releases/latest" title="Release">Release</a>ä¸‹è½½musicfox.macæ–‡ä»¶ï¼Œåœ¨iTermæˆ–Terminalä¸­è¿è¡Œ</li>
<li>ä½¿ç”¨brewå®‰è£…ï¼š
<code>sh
brew tap anhoder/musicfox &amp;&amp; brew install musicfox
</code></li>
</ol>

<h3 id="toc_5">Linux(Ubuntu)</h3>

<p>è¿›å…¥åˆ°<a href="https://github.com/anhoder/musicfox/releases/latest" title="Release">Release</a>ä¸‹è½½musicfox.ubuntuæ–‡ä»¶ï¼Œåœ¨ç»ˆç«¯ä¸­è¿è¡Œã€‚</p>

<blockquote>
<p>æœ¬äººæ²¡æœ‰Linuxç³»ç»Ÿï¼Œè¯¥æ‰§è¡Œæ–‡ä»¶æ˜¯åœ¨WSL2(Ubuntu 2004)ä¸‹æ‰“åŒ…çš„ï¼Œä¸ç¡®å®šå…¶ä»–Linuxç³»ç»Ÿæ˜¯å¦ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨</p>
</blockquote>

<h3 id="toc_6">Windows</h3>

<p>ä¸‹è½½<a href="./bin/musicfox.exe" title="Windowså¯æ‰§è¡Œæ–‡ä»¶">Windowså¯æ‰§è¡Œæ–‡ä»¶</a>ï¼Œåœ¨å‘½ä»¤è¡Œ(æ¨èWindows Terminal)ä¸­è¿è¡Œå³å¯ã€‚</p>

<p><strong>Windowsä¸‹å­˜åœ¨å‡ ä¸ªå·²çŸ¥é—®é¢˜ï¼Œæš‚æ—¶æ²¡æœ‰è§£å†³æ–¹æ³•ï¼š</strong></p>

<ol>
<li>æš‚åœæ—¶ä¼šå»¶è¿Ÿå‡ ç§’ï¼Œæ’­æ”¾æ—¶ä¸ä¼šå»¶è¿Ÿ</li>
<li>ç™»å½•æˆ–æœç´¢è¾“å…¥æ—¶ï¼Œä¼šåæ‰ç¬¬ä¸€ä¸ªå­—ç¬¦</li>
<li>ä¸Šã€ä¸‹ã€å·¦ã€å³åŠESCé”®æ— æ³•ç›‘å¬ï¼Œåªèƒ½ä½¿ç”¨å­—æ¯ä»£æ›¿è¿™äº›æ“ä½œ</li>
<li>å‘½ä»¤è¡Œçª—å£å¤§å°å‘ç”Ÿå˜åŒ–åï¼ŒUIä¼šå˜ä¹±ï¼ˆå› ä¸ºWindowsä¸æ”¯æŒresizeäº‹ä»¶ï¼‰</li>
</ol>

<p><em>å› ä¸ºå­˜åœ¨ä»¥ä¸Šé—®é¢˜ï¼Œæ‰€ä»¥æ¨èåœ¨WSLä¸‹ä½¿ç”¨ï¼ŒWSLçš„å£°éŸ³è½¬å‘å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ä¸ª<a href="https://github.com/anhoder/wsl-audio-musicbox" title="é¡¹ç›®">é¡¹ç›®</a></em>ã€‚</p>

<h2 id="toc_7">äº”ã€é€šçŸ¥åŠŸèƒ½</h2>

<h3 id="toc_8">Mac</h3>

<p>Macä¸‹é»˜è®¤ä½¿ç”¨<code>AppleScript</code>å‘é€é€šçŸ¥ã€‚å¦‚ä¸‹ï¼š</p>

<p><img src="media/15981627088641/AppleScript.png" alt="AppleScript"/></p>

<p>å¦‚æœæƒ³è¦æ›´å¥½çš„é€šçŸ¥ä½“éªŒï¼Œå¯ä»¥å®‰è£…<code>terminal-notifier</code>:</p>

<pre><code class="language-bash">brew install terminal-notifier
</code></pre>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>

<p><img src="media/15981627088641/terminal-notifier.png" alt="terminal-notifie"/></p>

<h3 id="toc_9">Linux</h3>

<p>Linuxå¯ä»¥å®‰è£…<code>libnotify-bin</code>æ¥ä½¿ç”¨é€šçŸ¥åŠŸèƒ½ï¼ˆæœªç»æµ‹è¯•ï¼‰</p>

<h3 id="toc_10">Windows</h3>

<p>Windowsä¸‹å¯ä»¥å®‰è£…<code>notifu</code>å®ç°é€šçŸ¥ï¼Œä½“éªŒä¸å¤ªå¥½ï¼ˆæ²¡æ‰¾åˆ°å…¶ä»–æ›´å¥½çš„é€šçŸ¥å·¥å…·ï¼‰</p>

<blockquote>
<p>å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„å‘½ä»¤è¡Œé€šçŸ¥ç¨‹åºï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å®ç°INotifieræ¥å£è¾¾åˆ°ä½ æƒ³è¦çš„æ•ˆæœï¼š</p>

<pre><code class="language-dart">abstract class INotifier {
  // æ£€æŸ¥è¯¥é€šçŸ¥ç¨‹åºæ˜¯å¦å¯ç”¨
  bool isAvailable();

  // å‘é€æ¶ˆæ¯
  void send(String message, {String title, String subtitle, String soundName, String groupID, String activateID, String appIcon, String contentImage, String openURL, String executeCmd});
}
</code></pre>
</blockquote>

<h2 id="toc_11">å…­ã€ä½¿ç”¨</h2>

<pre><code class="language-bash">$ musicfox
</code></pre>

<p><strong>æŒ‰é”®ï¼š</strong></p>

<table>
<thead>
<tr>
<th>æŒ‰é”®</th>
<th>ä½œç”¨</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>

<tbody>
<tr>
<td>h/H/LEFT</td>
<td>å·¦</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>h</code></td>
</tr>
<tr>
<td>l/L/RIGHT</td>
<td>å³</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>l</code></td>
</tr>
<tr>
<td>k/K/UP</td>
<td>ä¸Š</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>k</code></td>
</tr>
<tr>
<td>j/J/DOWN</td>
<td>ä¸‹</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>j</code></td>
</tr>
<tr>
<td>q/Q</td>
<td>é€€å‡º</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>q</code></td>
</tr>
<tr>
<td>space</td>
<td>æš‚åœ/æ’­æ”¾</td>
<td></td>
</tr>
<tr>
<td>[</td>
<td>ä¸Šä¸€æ›²</td>
<td></td>
</tr>
<tr>
<td>]</td>
<td>ä¸‹ä¸€æ›²</td>
<td></td>
</tr>
<tr>
<td>-</td>
<td>å‡å°éŸ³é‡</td>
<td></td>
</tr>
<tr>
<td>=</td>
<td>åŠ å¤§éŸ³é‡</td>
<td></td>
</tr>
<tr>
<td>n/N/ENTER</td>
<td>è¿›å…¥é€‰ä¸­çš„èœå•</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>n</code></td>
</tr>
<tr>
<td>b/B/ESC</td>
<td>è¿”å›ä¸Šçº§èœå•</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>b</code></td>
</tr>
<tr>
<td>w/W</td>
<td>é€€å‡ºå¹¶é€€å‡ºç™»å½•</td>
<td>Windowsåªèƒ½ä½¿ç”¨<code>w</code></td>
</tr>
<tr>
<td>p</td>
<td>åˆ‡æ¢æ’­æ”¾æ–¹å¼</td>
<td></td>
</tr>
<tr>
<td>P</td>
<td>å¿ƒåŠ¨æ¨¡å¼(ä»…åœ¨æ­Œå•ä¸­æ—¶æœ‰æ•ˆ)</td>
<td>Windowsä¸‹ä½¿ç”¨<code>o</code></td>
</tr>
<tr>
<td>,</td>
<td>å–œæ¬¢å½“å‰æ’­æ”¾æ­Œæ›²</td>
<td></td>
</tr>
<tr>
<td>&lt;</td>
<td>å–œæ¬¢å½“å‰é€‰ä¸­æ­Œæ›²</td>
<td>Windowsä¸‹ä½¿ç”¨<code>;</code></td>
</tr>
<tr>
<td>.</td>
<td>å½“å‰æ’­æ”¾æ­Œæ›²ç§»é™¤å‡ºå–œæ¬¢</td>
<td></td>
</tr>
<tr>
<td>&gt;</td>
<td>å½“å‰é€‰ä¸­æ­Œæ›²ç§»é™¤å‡ºå–œæ¬¢</td>
<td>Windowsä¸‹ä½¿ç”¨<code>&#39;</code></td>
</tr>
<tr>
<td>/</td>
<td>æ ‡è®°å½“å‰æ’­æ”¾æ­Œæ›²ä¸ºä¸å–œæ¬¢</td>
<td></td>
</tr>
<tr>
<td>?</td>
<td>æ ‡è®°å½“å‰é€‰ä¸­æ­Œæ›²ä¸ºä¸å–œæ¬¢</td>
<td>Windowsä¸‹ä½¿ç”¨<code>\</code></td>
</tr>
</tbody>
</table>

<h2 id="toc_12">ä¸ƒã€TODO</h2>

<ul>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æˆ‘çš„æ­Œå•</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æ¯æ—¥æ¨èæ­Œæ›²</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æ¯æ—¥æ¨èæ­Œå•</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> ç§äººFM</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æ­Œè¯æ˜¾ç¤º</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æ¬¢è¿ç•Œé¢</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æœç´¢
<ul>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æŒ‰æ­Œæ›²</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æŒ‰æ­Œæ‰‹</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æŒ‰æ­Œè¯</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æŒ‰æ­Œå•</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æŒ‰ä¸“è¾‘</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æŒ‰ç”¨æˆ·</li>
</ul></li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æ’è¡Œæ¦œ</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> ç²¾é€‰æ­Œå•</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æœ€æ–°ä¸“è¾‘</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> çƒ­é—¨æ­Œæ‰‹</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> äº‘ç›˜</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> æ’­æ”¾æ–¹å¼åˆ‡æ¢</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> å–œæ¬¢/å–æ¶ˆå–œæ¬¢</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" checked /> å¿ƒåŠ¨æ¨¡å¼/æ™ºèƒ½æ¨¡å¼</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" /> éŸ³ä¹ç”µå° </li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" /> å°†éƒ¨åˆ†è®¾ç½®è½¬åŒ–ä¸ºæ–‡ä»¶å¯é…ç½®
<ul>
<li class="task-list-item"><input disabled="disabled" type="checkbox" /> æ¬¢è¿ç•Œé¢çš„æ¬¢è¿è¯­</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" /> æ¬¢è¿ç•Œé¢æ—¶é•¿</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" /> ä¸»é¢˜è‰²</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" /> æ­Œè¯æ˜¾ç¤ºè¡Œæ•°</li>
<li class="task-list-item"><input disabled="disabled" type="checkbox" /> ...</li>
</ul></li>
</ul>

<h2 id="toc_13">å…«ã€ä¼´ç”Ÿé¡¹ç›®</h2>

<p>åœ¨è¯¥é¡¹ç›®çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘å°†ä¸€äº›é€šç”¨çš„åŠŸèƒ½æ¨¡å—å•ç‹¬æŠ½ç¦»å‡ºæ¥ï¼Œåšæˆäº†å‡ ä¸ªä¼´ç”Ÿé¡¹ç›®ï¼š</p>

<ol>
<li><a href="https://github.com/anhoder/mp3_player" title="mp3_player">mp3_player</a>: dartå‘½ä»¤è¡Œè°ƒç”¨mpg123æ’­æ”¾éŸ³ä¹</li>
<li><a href="https://github.com/anhoder/netease_music_request" title="netease_music_request">netease_music_request</a>: Dartå®ç°çš„ç½‘æ˜“äº‘éŸ³ä¹æ¥å£åº“ï¼Œä½¿ç”¨Dioå‘èµ·è¯·æ±‚ï¼ŒCookieJarç®¡ç†Cookieä¿¡æ¯</li>
<li><a href="https://github.com/anhoder/colorful_cmd" title="colorful_cmd">colorful_cmd</a>: ä½¿ç”¨dartå®ç°çš„ä¸€äº›å‘½ä»¤è¡ŒUIç»„ä»¶ï¼Œå¦‚ï¼šWindowUIå‘½ä»¤è¡Œçª—å£åº”ç”¨UIã€RainbowProgresså½©è™¹è¿›åº¦æ¡ã€NotifierProxyä¸‰å¤§å¹³å°é€šçŸ¥ä»£ç†ã€ColorTexté¢œè‰²æ–‡æœ¬...
<img src="media/15981627088641/command.png" alt="command"/>  <img src="media/15981627088641/rainbow_progress.png" alt="rainbow_progress"/>
<img src="media/15981627088641/window_ui.png" alt="window_ui"/>
<img src="media/15981627088641/window_ui2.png" alt="window_ui2"/></li>
</ol>

<h2 id="toc_14">ä¹ã€æ„Ÿè°¢</h2>

<p>æ„Ÿè°¢ä»¥ä¸‹é¡¹ç›®åŠå…¶è´¡çŒ®è€…ä»¬ï¼ˆä¸é™äºï¼‰ï¼š</p>

<ul>
<li><a href="https://github.com/darknessomi/musicbox" title="musicbox">musicbox</a></li>
<li><a href="https://github.com/Binaryify/NeteaseCloudMusicApi" title="NeteaseCloudMusicApi">NeteaseCloudMusicApi</a></li>
<li><a href="https://github.com/DirectMyFile/console.dart" title="console.dart">console.dart</a></li>
</ul>

<p><img src="media/15981627088641/wechat.png" alt="wechat"/></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ä½¿ç”¨laravelçš„æ–¹å¼ç®¡ç†imiçš„è·¯ç”±]]></title>
    <link href="https://anhoder.github.io/15981633847284.html"/>
    <updated>2020-08-23T14:16:24+08:00</updated>
    <id>https://anhoder.github.io/15981633847284.html</id>
    <content type="html"><![CDATA[
<h2 id="toc_0">1ã€imiæ˜¯ä»€ä¹ˆ</h2>

<p>imiä¸Swoftã€Hyperfä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªåŸºäºSwooleçš„PHPæ¡†æ¶ã€‚</p>

<p><strong>ä¸åŒä¹‹å¤„åœ¨äºï¼ŒSwoftä¸Hyperfæ˜¯ä¸»è¦é’ˆå¯¹å¾®æœåŠ¡æ¨å‡ºçš„æ¡†æ¶ï¼Œè€Œimiè‡´åŠ›äºå•ä½“åº”ç”¨ã€‚</strong></p>

<p>æ­¤å¤–ï¼Œimiè¿˜æ”¯æŒä»£ç çƒ­æ›´æ–°ï¼Œåªè¦ç›‘å¬çš„æ–‡ä»¶å‘ç”Ÿäº†æ›´æ”¹ï¼Œimiå°±ä¼šåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…é‡å¯æœåŠ¡ã€‚å¤§ä½“å®ç°æ˜¯ï¼š</p>

<blockquote>
<p>â‘  åœ¨workerè¿›ç¨‹çš„å¯åŠ¨äº‹ä»¶onWorkerStartä¸­ï¼Œè½½å…¥ç›¸åº”çš„PHPæ–‡ä»¶ã€‚</p>

<p>â‘¡ å½“ç›‘å¬åˆ°ä»£ç æ›´æ–°åï¼Œå‘swooleå‘é€ä¸€ä¸ªSIGUSR1ä¿¡å·ï¼Œswooleä¼šé‡å¯æ‰€æœ‰çš„workerè¿›ç¨‹ï¼Œå¹¶è§¦å‘onWorkerStartäº‹ä»¶ï¼Œé‡æ–°è½½å…¥ç›¸åº”çš„PHPæ–‡ä»¶ã€‚æ­¤æ—¶ï¼Œworkerè¿›ç¨‹å°±æ˜¯æœ€æ–°çš„ä»£ç äº†ã€‚</p>
</blockquote>

<p>è™½ç„¶è¿™ä¸ªåŠŸèƒ½å¯¹äºçº¿ä¸ŠæœåŠ¡æ²¡æœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œä½†æ˜¯å´å¯ä»¥å¤§å¤§æé«˜å¼€å‘æ—¶æ•ˆç‡ã€‚</p>

<h2 id="toc_1">2ã€imiçš„è·¯ç”±ç®¡ç†</h2>

<h3 id="toc_2">æ³¨è§£</h3>

<p>imiè·¯ç”±çš„ç®¡ç†æ–¹å¼ä¸Swoftæ¡†æ¶ç±»ä¼¼ã€‚ä½¿ç”¨<strong>æ³¨è§£</strong>æ¥ç®¡ç†è·¯ç”±ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-php">&lt;?php
namespace Test;
 
use Imi\Controller\HttpController;
use Imi\Server\Route\Annotation\Route;
use Imi\Server\Route\Annotation\Action;
use Imi\Server\Route\Annotation\Controller;
 
/**
 * @Controller(prefix=&quot;home&quot;)
 */
class Index extends HttpController
{
    /**
     * @Action
     * @Route(url=&quot;/index&quot;)
     */
    public function index()
    {
        // ä½¿ç”¨/indexå¯ä»¥è®¿é—®åˆ°
        return $this-&gt;response-&gt;write(&#39;hello imi!&#39;);
    }
    
    /**
     * @Action
     * @Route(url=&quot;test&quot;)
     */
    public function test()
    {
        // ä½¿ç”¨/home/testå¯ä»¥è®¿é—®åˆ°
        return $this-&gt;response-&gt;write(&#39;hello test!&#39;);
    }
}
</code></pre>

<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>Index</code>ç±»ä¸Šæ·»åŠ äº†<code>@Controller</code>æ³¨è§£ï¼Œæ ‡è¯†è¯¥ç±»ä¸ºä¸€ä¸ªæ§åˆ¶å™¨ï¼Œå¹¶è®¾ç½®è·¯ç”±å‰ç¼€ä¸º<code>home</code>ï¼›<code>index</code>åŠ<code>test</code>æ–¹æ³•ä¸Šæ·»åŠ äº†<code>Action</code>ã€<code>Route</code>æ³¨è§£ï¼Œå¹¶åˆ†åˆ«ä¸ºå®ƒä»¬è®¾ç½®è·¯ç”±ä¸º<code>/home</code>ã€<code>test</code>ã€‚</p>

<p>ä½¿ç”¨æ³¨è§£ç®¡ç†è·¯ç”±å¯ä»¥å¾ˆç›´è§‚åœ°å°†æ§åˆ¶å™¨çš„æ–¹æ³•å’Œè·¯ç”±å¯¹åº”èµ·æ¥ï¼Œä½†æ˜¯å®ƒä¹Ÿä¼šå¸¦æ¥ä¸€äº›ç¼ºé™·ï¼š</p>

<ul>
<li>å½“è·¯ç”±è¶Šæ¥è¶Šå¤šæ—¶ï¼Œè·¯ç”±çš„ç®¡ç†å°±å˜å¾—å¾ˆå¤æ‚ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬éœ€è¦ä¸ºä¸€æ‰¹è·¯ç”±æ·»åŠ ä¸€ä¸ªä¸­é—´ä»¶ï¼Œæ­¤æ—¶ï¼Œå°±éœ€è¦ä¿®æ”¹å¾ˆå¤šæ–‡ä»¶ã€‚</li>
<li>è·¯ç”±ç»“æ„ä¸å¤Ÿæ¸…æ™°ã€‚</li>
</ul>

<h3 id="toc_3">é…ç½®</h3>

<p>å½“ç„¶ï¼Œimiä¹Ÿæ”¯æŒä½¿ç”¨é…ç½®çš„æ–¹å¼ç®¡ç†è·¯ç”±ï¼š</p>

<pre><code class="language-php">return [
    &#39;route&#39; =&gt; [
        [
            &#39;controller&#39; =&gt; \ImiDemo\HttpDemo\MainServer\Controller\Test::class,
            &#39;method&#39; =&gt; &#39;index&#39;,
            &#39;route&#39; =&gt; [
                &#39;url&#39; =&gt; &#39;/test&#39;,
                // &#39;method&#39;    =&gt;    &#39;PUT&#39;,
                // &#39;method&#39;    =&gt;    [&#39;GET&#39;, &#39;POST&#39;],
                // &#39;domain&#39;    =&gt;    &#39;{name}.xxx.com&#39;,
            ],
        ],
     ]
];
</code></pre>

<p>ä½†æ˜¯ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨å¤šé‡åµŒå¥—ï¼Œå¯è¯»æ€§å¹¶ä¸é«˜ã€‚</p>

<p>æ—¢ç„¶å¦‚æ­¤ï¼Œè¿˜æœ‰ä»€ä¹ˆå…¶ä»–è·¯ç”±ç®¡ç†æ–¹å¼å‘¢ï¼ŸğŸ¤”</p>

<h2 id="toc_4">3ã€imi-route</h2>

<p>æˆ‘è®¤ä¸ºlaravelçš„è·¯ç”±ç®¡ç†æ–¹å¼æ˜¯å¾ˆæ–¹ä¾¿ä¸”æ˜“è¯»çš„ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-php">Route::group([&#39;middleware&#39; =&gt; [&#39;auth&#39;]], function () {
    Route::get(&#39;/auth/userinfo&#39;, &#39;AuthController@getUser&#39;);
});
</code></pre>

<p>æ‰€ä»¥ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªç»„ä»¶â€”â€”<a href="https://github.com/anhoder/imi-route"><code>imi-route</code></a>ï¼Œå¸Œæœ›å¯ä»¥å°†laravelè·¯ç”±ç®¡ç†çš„åŸºæœ¬åŠŸèƒ½åº”ç”¨åˆ°åœ¨imiæ¡†æ¶ä¸­å»ã€‚</p>

<h3 id="toc_5">åŸºæœ¬å®ç°æ€è·¯</h3>

<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“imiæ¡†æ¶åœ¨å¯åŠ¨æ—¶æ˜¯å¦‚ä½•åŠ è½½ç›¸å…³è·¯ç”±çš„ï¼š</p>

<ol>
<li>è§£æåº”ç”¨ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œé€šè¿‡åå°„è·å–æ‰€æœ‰ç±»çš„æ³¨é‡Š</li>
<li>æ³¨é‡Šé€šè¿‡å­—ç¬¦ä¸²è§£æåå¾—åˆ°ç›¸åº”æ³¨è§£ï¼Œä¾‹å¦‚ï¼šè·¯ç”±æ³¨è§£ä¸º<code>RouteAnnotation</code></li>
<li>å°†æ‰€æœ‰çš„è·¯ç”±æ³¨è§£æ·»åŠ åˆ°HttpRouteä¸­</li>
</ol>

<p>ä»¥ä¸Šçš„æµç¨‹éƒ½æ˜¯åœ¨æœåŠ¡å¯åŠ¨æ—¶è¿›è¡Œå¤„ç†ï¼Œå¾—åˆ°è·¯ç”±ç»“æœä¼šå¸¸é©»å†…å­˜ã€‚</p>

<p>è€Œ<strong><code>imi-route</code>å°±æ˜¯åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œå°†å­˜å‚¨çš„è·¯ç”±è½¬åŒ–ä¸ºè·¯ç”±æ³¨è§£ï¼Œæ·»åŠ åˆ°HttpRouteä¸­ã€‚</strong></p>

<h3 id="toc_6">ä½¿ç”¨</h3>

<p>1ã€ä½¿ç”¨composerå®‰è£…ä¾èµ–ï¼š</p>

<pre><code class="language-bash">composer require alanalbert/imi-route
</code></pre>

<p>2ã€å°†ä¸‹åˆ—ä»£ç æ·»åŠ åˆ°é¡¹ç›®æ ¹ç›®å½•çš„<code>Main.php</code>æ–‡ä»¶ä¸­ï¼š</p>

<pre><code class="language-php">&lt;?php
namespace ImiApp;

use Imi\Main\AppBaseMain;
  
class Main extends AppBaseMain
{
  public function __init()
  {
      \Alan\ImiRoute\Route::init(); // Add this line
  }

}
</code></pre>

<p>3ã€åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»º<code>route/route.php</code>ç›®å½•åŠæ–‡ä»¶ï¼Œåœ¨<code>route.php</code>æ–‡ä»¶ä¸­ï¼Œä½ å°±å¯ä»¥ç®¡ç†ä½ çš„è·¯ç”±äº†ï¼š</p>

<pre><code class="language-php">/**
 * @var $router Route
 */

use Alan\ImiRoute\Route;
use ImiApp\ApiServer\Controller\IndexController;
use ImiApp\ApiServer\Middleware\Test2Middleware;
use ImiApp\ApiServer\Middleware\TestMiddleware;

$router-&gt;group([&#39;middleware&#39; =&gt; TestMiddleware::class], function (Route $router) {

    $router-&gt;group(
        [
            &#39;middleware&#39; =&gt; Test2Middleware::class, 
            &#39;ignoreCase&#39; =&gt; true, 
            &#39;prefix&#39; =&gt; &#39;prefix&#39;
        ], function (Route $router) {
        $router-&gt;get(&#39;hi&#39;, &#39;ImiApp\ApiServer\Controller\IndexController@index&#39;);
    });

    $router-&gt;any(&#39;/hi/api/abc&#39;, [IndexController::class, &#39;index&#39;]);

    $router-&gt;any(&#39;/hi/api/{time}&#39;, [IndexController::class, &#39;api&#39;]);

});

$router-&gt;group([&#39;prefix&#39; =&gt; &#39;prefix&#39;], function (Route $router) {
    $router-&gt;get(&#39;/TEST/{time}&#39;, [IndexController::class, &#39;api&#39;]);
});
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Windowsçš„WSLéŸ³é¢‘è§£å†³æ–¹æ¡ˆ]]></title>
    <link href="https://anhoder.github.io/15981627088961.html"/>
    <updated>2020-08-23T14:05:08+08:00</updated>
    <id>https://anhoder.github.io/15981627088961.html</id>
    <content type="html"><![CDATA[
<p>ä¸»è¦å®ç°æ€è·¯æ˜¯ä½¿ç”¨pulseaudioè¿›è¡ŒéŸ³é¢‘è½¬å‘ï¼Œ<a href="https://github.com/anhoder/wsl-audio-musicbox">wsl-audio-musicbox</a>é¡¹ç›®ä¸»è¦æ˜¯ä¸ºäº†ç®€åŒ–WSLä¸Windowsä¹‹é—´é€šä¿¡è½¬å‘çš„é…ç½®ã€‚</p>

<blockquote>
<p>å¯ä»¥å®ç°åœ¨WSLä¸­ä½¿ç”¨musicboxæ’­æ”¾æ­Œæ›²ï¼ˆ<strong>ç»™ä¸ªStarå§~~</strong>ï¼‰</p>
</blockquote>

<h2 id="toc_0">é¡¹ç›®ä¾èµ–</h2>

<ul>
<li>åŸºäºWSL2ï¼ŒWSL1æœªè¿›è¡Œæµ‹è¯•</li>
<li>åŸºäºubuntu1804ï¼Œå…¶ä»–éœ€è¦ä¿®æ”¹ä»£ç </li>
<li>php-cli, å› ä¸ºä½¿ç”¨åˆ°PHPè„šæœ¬å¤„ç†æ–‡ä»¶å†…å®¹</li>
</ul>

<h2 id="toc_1">åŸç†</h2>

<p>ä½¿ç”¨pulseaudioè½¯ä»¶å°†éŸ³é¢‘æ•°æ®ä¿¡å·è½¬å‘åˆ°Windowsä¸Šï¼Œæœ¬é¡¹ç›®åªæ˜¯å°†ç¹æ‚çš„é…ç½®è¿›è¡Œè‡ªåŠ¨åŒ–å¤„ç†ï¼Œå¹¶å¯ä»¥å®ç°å¼€æœºè‡ªå¯åŠ¨</p>

<h2 id="toc_2">ä½¿ç”¨</h2>

<ol>
<li><p>Windowsä¸‹å®‰è£…pulseaudioè½¯ä»¶</p></li>
<li><p>ä¸‹è½½æˆ–cloneæœ¬é¡¹ç›®ï¼Œå°†autoã€etcç›®å½•ç§»åŠ¨æˆ–è¦†ç›–åˆ°pulseaudioçš„æ ¹ç›®å½•ä¸‹</p></li>
<li><p>å¯åŠ¨WSLï¼Œå®‰è£…pulseaudio: <code>sudo apt install pulseaudio</code>ï¼Œå¦‚æœæ²¡æœ‰phpç¯å¢ƒï¼Œæ‰§è¡Œ<code>sudo apt install php-cli</code>è¿›è¡Œå®‰è£…ã€‚<strong>ç¡®ä¿/etc/wsl.confä¸­æœ‰é…ç½®é¡¹</strong>ï¼š<code>generateResolvConf = true</code>ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œéœ€è¦æ·»åŠ ä¸Šï¼Œå¹¶<strong>é‡å¯ç”µè„‘</strong>ï¼‰</p></li>
<li><p>Windowså›åˆ°pulseaudioæ ¹ç›®å½•ï¼Œæ‰‹åŠ¨è¿è¡Œ<code>auto</code>ç›®å½•ä¸‹çš„<code>start.bat</code>ï¼Œå‡ºç°<code>æˆåŠŸ</code>è¡¨æ˜ä¸€åˆ‡é¡ºåˆ©ã€‚ï¼ˆ<strong>å¦‚æœä½ åœ¨WSLä¸­ä½¿ç”¨çš„ä¸æ˜¯zshï¼Œåˆ™éœ€è¦æ‰“å¼€<code>auto/start.bat</code>æ–‡ä»¶ï¼Œå°†ubuntu1804.exe run &quot;./start.php <code>echo ~/.zshrc</code> &amp;&amp; source ~/.zshrc&quot;ä¸­çš„<code>~/.zshrc</code>ä¿®æ”¹ä¸ºä½ æ­£åœ¨ä½¿ç”¨çš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œä¾‹å¦‚<code>~/.bashrc</code></strong></p></li>
<li><p><strong>å…³é—­WSLå¹¶é‡æ–°æ‰“å¼€</strong>ï¼Œè¿è¡Œ<code>paplay -p /mnt/c/Windows/Media/Alarm04.wav</code>ï¼Œå¦‚æœæœ‰ç¾å¦™çš„å£°éŸ³æ’­æ”¾å‡ºæ¥ï¼Œæ­å–œä½ ï¼ŒéŸ³é¢‘è½¬å‘æˆåŠŸäº†ï¼ï¼</p></li>
<li><p>å¦‚æœä½ ä¸æƒ³æ¯æ¬¡å¼€æœºéƒ½æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡<code>start.bat</code>ï¼Œå¯ä»¥æ‰“å¼€<code>auto/start.vbs</code>æ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„<code>.\start.bat</code>æ›¿æ¢ä¸ºä½ ç”µè„‘<code>start.bat</code>æ–‡ä»¶çš„<strong>ç»å¯¹è·¯å¾„</strong>ï¼Œå¹¶å°†start.vbsç§»åŠ¨åˆ°Windowsçš„è‡ªå¯åŠ¨ç›®å½•ä¸‹ï¼ˆwin+Rè¿è¡Œ<code>shell:startup</code>å³å¯æ‰“å¼€è¯¥ç›®å½•ï¼‰ã€‚é‡å¯è¯•è¯•çœ‹å§~</p></li>
</ol>

<h2 id="toc_3">ä½¿ç”¨musicbox</h2>

<blockquote>
<p>åªéœ€è¦æ ¹æ®musicboxé¡¹ç›®çš„Linuxç³»ç»Ÿå®‰è£…æŒ‡å¼•è¿›è¡Œå®‰è£…å³å¯~~</p>
</blockquote>

<p><img src="media/15981627088961/musicbox.png" alt="musicbox"/></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Athemeâ€”â€”åŸºäºMWebçš„é™æ€ç«™ç‚¹ä¸»é¢˜]]></title>
    <link href="https://anhoder.github.io/15981627089010.html"/>
    <updated>2020-08-23T14:05:08+08:00</updated>
    <id>https://anhoder.github.io/15981627089010.html</id>
    <content type="html"><![CDATA[
<p>æœ€è¿‘æ€»è§‰å¾—æˆ‘çš„åšå®¢ä¸»é¢˜æœ‰ç‚¹ä¸‘ï¼Œäºæ˜¯è¶ç€å‡æœŸä¼˜åŒ–ä¸€ä¸‹ï¼ˆ<strong><em>è°ƒæ ·å¼çœŸçš„ç´¯ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¼ºè¿«ç—‡æ‚£è€…ã€‚ã€‚ã€‚ğŸ˜­</em></strong>ï¼‰</p>

<h2 id="toc_0">MWebæ˜¯ä»€ä¹ˆ</h2>

<p>MWebæ˜¯Mac OSä¸Šçš„ä¸€ä¸ªMarkdownç¼–è¾‘å™¨ï¼Œå…¶å…·å¤‡å¾ˆå¤šåŠŸèƒ½ï¼š</p>

<ul>
<li>å‘å¸ƒå›¾ç‰‡åˆ°å›¾åºŠ</li>
<li>ç›´æ¥å‘å¸ƒæ–‡ç« åˆ°WordPressã€å°è±¡ç¬”è®°ã€è¯­é›€ç­‰ç«™ç‚¹</li>
<li>Markdownå¯¼å‡ºä¸ºå›¾ç‰‡ã€PDFã€å¯Œæ–‡æœ¬ã€HTMLç­‰</li>
<li>è®¾ç½®é¡µé¢ä¸»é¢˜</li>
<li>å°†Markdownç¼–è¯‘ä¸ºé™æ€ç«™ç‚¹</li>
<li>...</li>
</ul>

<p>æ€»è€Œè¨€ä¹‹ï¼ŒMWebæ˜¯ä¸€æ¬¾å¾ˆä¼˜è´¨çš„Markdownç¼–è¾‘å™¨ï¼Œæ­é…ä¸ŠGithub PagesåŠGitee Pagesï¼Œç®€ç›´ä¸è¦å¤ªçˆ½ã€‚</p>

<h2 id="toc_1">Athemeä¸»é¢˜</h2>

<p>æœ¬æ–‡ä»‹ç»çš„Athemeå°±æ˜¯ä¸€æ¬¾åŸºäºMWebç¼–è¾‘å™¨çš„å¯é…ç½®çš„é™æ€ç«™ç‚¹ä¸»é¢˜ã€‚å®ƒæ˜¯æˆ‘åœ¨MWebè‡ªå¸¦ä¸»é¢˜â€”â€”<strong>BulmaCSS</strong>çš„åŸºç¡€ä¸Šè¿›è¡Œæ·»åŠ ã€ä¿®æ”¹ã€ä¼˜åŒ–è€Œå‡ºç°çš„äº§ç‰©ã€‚ä»¥ä¸‹ä¸»è¦ä»‹ç»è¿™ä¸ªä¸»é¢˜çš„ä¸»è¦åŠŸèƒ½ï¼š</p>

<ol>
<li>ç½‘ç«™èœå•</li>
<li>ç«™é•¿ä¿¡æ¯åŠè”ç³»æ–¹å¼</li>
<li>å…¬å‘Šã€åˆ†ç±»åŠæ ‡ç­¾</li>
<li><strong>éšæœºå›¾ç‰‡</strong></li>
<li><strong>æš—é»‘æ¨¡å¼</strong></li>
<li><strong>ä½¿ç”¨Githubè¯„è®º</strong></li>
<li><strong>çœ‹æ¿å¨˜</strong></li>
<li><strong>Google Analysisã€Baidu Analysis</strong></li>
</ol>
<span style="color: #F4635F;">
<p><strong>ï¼å¤šå›¾é¢„è­¦ï¼</strong><br/>
<strong>ï¼ï¼å¤šå›¾é¢„è­¦ï¼ï¼</strong><br/>
<strong>ï¼ï¼ï¼å¤šå›¾é¢„è­¦ï¼ï¼ï¼</strong></p>
</span>
<h3 id="toc_2">1ã€ç½‘ç«™èœå•</h3>

<p>ç½‘ç«™èœå•æ˜¯å‡ºç°åœ¨ç«™ç‚¹å¤´éƒ¨çš„å¯¼èˆªæ¡ï¼Œå®ƒæ˜¯MWebæä¾›çš„åŸºç¡€åŠŸèƒ½ï¼Œå¯ä»¥åœ¨<code>åå¥½è®¾ç½®-&gt;ç½‘ç«™æ‰©å±•-&gt;ç½‘ç«™èœå•</code>ä¸­è¿›è¡Œä¸ªæ€§åŒ–è®¾ç½®ã€‚</p>

<p><img src="media/15981627089010/15861393202173.jpg" alt="" style="width:707px;"/></p>

<p><strong>ç«™ç‚¹æ•ˆæœ</strong></p>

<p><img src="media/15981627089010/15861393669174.jpg" alt="" style="width:1440px;"/></p>

<h3 id="toc_3">2ã€è”ç³»æ–¹å¼åŠç«™é•¿ä¿¡æ¯</h3>

<p>è”ç³»æ–¹å¼ã€ç«™é•¿ä¿¡æ¯æ˜¯å‡ºç°åœ¨Headerä¸­çš„å†…å®¹ï¼š</p>

<p><img src="media/15981627089010/15861398063524.jpg" alt="" style="width:1437px;"/></p>

<p>å®ƒä»¬æ˜¯Athemeä¸»é¢˜æä¾›çš„ä¸ªæ€§åŒ–åŠŸèƒ½ï¼Œå¯ä»¥åœ¨<code>åå¥½è®¾ç½®-&gt;ç½‘ç«™æ‰©å±•-&gt;ç½‘ç«™æ‰©å±•è®¾ç½®</code>ä¸­è¿›è¡Œé…ç½®ï¼Œæ”¯æŒçš„é…ç½®é¡¹æœ‰ï¼š</p>

<ul>
<li>ç«™é•¿å</li>
<li>ç«™é•¿é¦–é¡µ</li>
<li>ç«™ç‚¹icon</li>
<li>ç«™é•¿çš„å¤´åƒ</li>
<li>å¾®åšä¸»é¡µ</li>
<li>Twitter</li>
<li>Github</li>
<li>Facebook</li>
<li>Instagram</li>
<li>YouTube</li>
<li>Stack Overflow</li>
<li>email</li>
<li>...</li>
</ul>

<h3 id="toc_4">3ã€å…¬å‘Šã€åˆ†ç±»åŠæ ‡ç­¾</h3>

<ul>
<li>å…¬å‘Šä¹Ÿæ˜¯Athemeä¸»é¢˜æä¾›çš„é…ç½®åŠŸèƒ½ï¼Œå¯ä»¥åœ¨<code>åå¥½è®¾ç½®-&gt;ç½‘ç«™æ‰©å±•-&gt;ç½‘ç«™æ‰©å±•è®¾ç½®</code>è¿›è¡Œè‡ªå®šä¹‰é…ç½®ã€‚</li>
<li>åˆ†ç±»åŠæ ‡ç­¾åˆ™æ˜¯æ ¹æ®å…·ä½“æ–‡ç« çš„åˆ†ç±»ã€æ ‡ç­¾è¿›è¡Œç”Ÿæˆ</li>
</ul>

<p><img src="media/15981627089010/15861406564340.jpg" alt="" style="width:426px;"/></p>

<h3 id="toc_5">4ã€éšæœºå›¾ç‰‡</h3>

<p>éšæœºå›¾ç‰‡ï¼Œæ˜¯åœ¨åšå®¢åˆ—è¡¨ä¸­é’ˆå¯¹æ¯ç¯‡åšå®¢éšæœºè·å–ä¸€å¼ å›¾ç‰‡è¿›è¡Œå±•ç¤ºï¼Œéšæœºå›¾ç‰‡çš„APIä¹Ÿæ”¯æŒé…ç½®ï¼Œæˆ‘ç›®å‰ä½¿ç”¨çš„æœ‰ä¸¤ä¸ªï¼š</p>

<ul>
<li><a href="https://picsum.photos/1024/">https://picsum.photos/1024/</a></li>
<li><a href="https://source.unsplash.com/random/1024x">https://source.unsplash.com/random/1024x</a></li>
</ul>

<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªAPIå¿…é¡»æ”¯æŒè®¾ç½®å›¾ç‰‡çš„å¤§å°ï¼Œå¹¶è®¾ç½®å®½åº¦ä¸º1024</p>
</blockquote>

<p><img src="media/15981627089010/15861412497796.jpg" alt="" style="width:844px;"/></p>

<h3 id="toc_6">5ã€æš—é»‘æ¨¡å¼</h3>

<p>æš—é»‘æ¨¡å¼æš‚ä¸æ”¯æŒé…ç½®ï¼Œç›®å‰æ˜¯æ ¹æ®æµè§ˆå™¨çš„å¤–è§‚åå¥½è¿›è¡Œè‡ªåŠ¨è°ƒæ•´</p>

<p><img src="media/15981627089010/15861414640564.jpg" alt="" style="width:1474px;"/></p>

<p><img src="media/15981627089010/15861414308809.jpg" alt="" style="width:1518px;"/></p>

<h3 id="toc_7">6ã€ä½¿ç”¨Githubè¯„è®º</h3>

<p>ä½¿ç”¨Githubè´¦å·è¿›è¡Œè¯„è®ºæ˜¯é›†æˆäº†utterancæ’ä»¶ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦å‡†å¤‡ä¸€ä¸ªGithubä»“åº“ç”¨äºå­˜æ”¾è¯„è®ºå†…å®¹ï¼Œå¹¶åœ¨é…ç½®(utteranc repo)ä¸­å¡«å…¥ä»“åº“åï¼Œä¾‹å¦‚ï¼šanhoder/blog-commentã€‚</p>

<p><img src="media/15981627089010/15861418927019.jpg" alt="" style="width:973px;"/></p>

<blockquote>
<p>è¯¥æ¨¡å—ä¸»é¢˜ä¹Ÿä¼šæ ¹æ®æ—¥é—´ã€æš—é»‘æ¨¡å¼åœ¨github-lightåŠgithub-darkä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚</p>

<p>Githubå¤´åƒğŸ‘¥å¯èƒ½ä¼šå› ä¸ºå›½å†…ç½‘ç»œåŸå› åŠ è½½å¤±è´¥</p>
</blockquote>

<h3 id="toc_8">7ã€çœ‹æ¿å¨˜</h3>

<p>çœ‹æ¿å¨˜æ˜¯å‡ºç°åœ¨ç«™ç‚¹å³ä¸‹è§’ï¼Œæ‚¬æµ®ç€çš„å°äººç‰©æˆ–å® ç‰©ã€‚ç›®å‰æ”¯æŒä¸¤ç§é€‰æ‹©ï¼š</p>

<ol>
<li>è¡€å°æ¿plt</li>
<li>é»‘çŒ«æˆ–ç™½çŒ«</li>
</ol>

<p><img src="media/15981627089010/15861422315868.jpg" alt="" style="width:291px;"/></p>

<h3 id="toc_9">8ã€Google Analysisã€Baidu Analysis</h3>

<p>è¯¥åŠŸèƒ½ä¸»è¦ç”¨äºç»Ÿè®¡ç”¨æˆ·è®¿é—®æ•°ï¼Œåˆ†æç”¨æˆ·ã€‚ä½ åªéœ€è¦åœ¨è®¾ç½®ä¸­é…ç½®Google Analysis IDåŠBaiduåˆ†æIDå³å¯ï¼Œä¹Ÿå¯ä»¥åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªç»Ÿè®¡æ–¹æ¡ˆã€‚</p>

<blockquote>
<p>ç™¾åº¦åˆ†æIDä¸ºï¼š<code>https://hm.baidu.com/hm.js?</code>åé¢çš„ä¸€ä¸²å­—ç¬¦ä¸²</p>
</blockquote>

<h2 id="toc_10">æ€»è¿°</h2>

<p>ä»¥ä¸Šå°±æ˜¯Athemeä¸»é¢˜ç›®å‰çš„æ ¸å¿ƒåŠŸèƒ½ä»‹ç»ï¼Œé¢„è§ˆç«™ç‚¹ï¼š<code>https://danlanhai.gitee.io</code>æˆ–<code>https://anhoder.github.io</code>ã€‚</p>

<p>å¦‚æœä»¥ä¸Šå†…å®¹å¯¹ä½ æœ‰å¸®åŠ©æˆ–è®©ä½ å¾ˆæ„Ÿå…´è¶£ï¼Œ<strong>è¯·ç‚¹å‡»å·¦ä¸‹è§’ã€Œ<span style="color:#028cca;">é˜…è¯»åŸæ–‡</span>ã€ï¼Œç»™ä¸ªStarå§~~</strong></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[åˆæ¢Docker---ä½¿ç”¨Docker Composeç¼–æ’å®¹å™¨]]></title>
    <link href="https://anhoder.github.io/15981627591782.html"/>
    <updated>2020-08-23T14:05:59+08:00</updated>
    <id>https://anhoder.github.io/15981627591782.html</id>
    <content type="html"><![CDATA[
<p>ä½¿ç”¨Docker Composeå°†ä¹‹å‰ä½¿ç”¨Dockeræ­å»ºçš„PHPå¼€å‘ç¯å¢ƒè¿›è¡Œç¼–æ’ã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">ä»€ä¹ˆæ˜¯Docker Composeï¼Ÿ</h2>

<p>Docker Composeæ˜¯Dockerå®˜æ–¹ç¼–æ’é¡¹ç›®ä¹‹ä¸€ï¼Œå¯ä»¥å¿«é€Ÿéƒ¨ç½²åº”ç”¨ã€‚</p>

<p>å…¶ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„YAMLæ–‡ä»¶ï¼ˆdocker-compose.ymlï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ä¸ºä¸€ä¸ªé¡¹ç›®ã€‚</p>

<p>Docker Composeä¸æ˜¯å¿…é¡»ä½¿ç”¨çš„ï¼Œä½ ä¹Ÿå¯ä»¥åªä½¿ç”¨Dockeræ¥æ„å»ºé¡¹ç›®ã€‚Docker Composeåªæ˜¯æä¾›ä¸€ç§æ›´ç®€å•æ–¹ä¾¿çš„æ–¹å¼æ¥ç®¡ç†åº”ç”¨å®¹å™¨ã€‚</p>

<h2 id="toc_1">ç¼–æ’PHPå¼€å‘ç¯å¢ƒ</h2>

<pre><code class="language-yaml">version: &quot;3&quot;

## ç½‘ç»œ
networks:
    frontend:
        driver: bridge
    backend:
        driver: bridge

services:
    ## PHP-FPM
    php-fpm:
        container_name: alan_php-fpm # å®¹å™¨å
        build: 
            context: ./php-fpm
        volumes: 
            - ${WEBSITES_DIR}:/home/www # ç«™ç‚¹ç›®å½•
            - ${PHP_FPM_LOG_DIR}:/var/log/php-fpm # php-fpmæ—¥å¿—
            - ${PHP_FPM_INI}:/usr/local/etc/php # php-fpmé…ç½®æ–‡ä»¶
        ports: 
            - &quot;${PHP_FPM_PORT}:9000&quot; # php-fpmç«¯å£
            - &quot;${SWOFT_PORT}:18306&quot;  # é¢„ç•™swoftç«¯å£
        networks:
            - backend 

        
    ## Nginx
    nginx:
        container_name: alan_nginx # å®¹å™¨å
        build:
            context: ./nginx 
        volumes: 
            - ${WEBSITES_DIR}:/home/www # ç«™ç‚¹ç›®å½•
            - ${NGINX_LOG_DIR}:/var/log/nginx # Nginxæ—¥å¿—
            - ${NGINX_CONF}:/etc/nginx/conf.d # Nginxé…ç½®æ–‡ä»¶
        ports: 
            - &quot;${NGINX_PORT}:80&quot; # Nginxç«¯å£
        depends_on:
            - php-fpm # ä¾èµ–ä¸php-fpm
        networks:
            - frontend
            - backend

    
    ## MySQL
    mysql:
        container_name: alan_mysql # å®¹å™¨å
        build: 
            context: ./mysql
        volumes: 
            - ${MYSQL_DATA}:/var/lib/mysql # MySQLæ•°æ®å­˜å‚¨ä½ç½®
            - ${MYSQL_CONF}:/etc/mysql/conf.d # MySQLé…ç½®æ–‡ä»¶
        ports: 
            - &quot;${MYSQL_PORT}:3306&quot; # MySQLç«¯å£
        environment:
            MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD} # MySQLçš„rootå¯†ç 
            MYSQL_USER: ${MYSQL_USER} # MySQLç”¨æˆ·
            MYSQL_PASSWORD: ${MYSQL_PASSWORD} # MySQLå¯†ç 
            MYSQL_ALLOW_EMPTY_PASSWORD: ${MYSQL_ALLOW_EMPTY_PASSWORD} # æ˜¯å¦å…è®¸ç©ºå¯†ç 
        networks:
            - backend

    
    ## Redis
    redis:
        container_name: alan_redis #å®¹å™¨å
        build: 
            context: ./redis
        ports: 
            - &quot;${REDIS_PORT}:6379&quot; # Redisç«¯å£
        networks:
            - backend

</code></pre>

<p>å…¶ä¸­çš„å˜é‡ï¼ˆä¾‹å¦‚ï¼š${REDIS_PORT}ï¼‰å¯ä»¥åœ¨.envæ–‡ä»¶ä¸­è¿›è¡Œè‡ªå®šä¹‰ã€‚</p>

<h2 id="toc_2">ENVç¯å¢ƒå˜é‡æ–‡ä»¶ç¤ºä¾‹</h2>

<p>.envé…ç½®æ–‡ä»¶çš„æ ·ä¾‹ï¼š</p>

<pre><code class="language-env"># webç«™ç‚¹ç›®å½•
WEBSITES_DIR=./www


## PHP-FPM
# PHP-FPMæ—¥å¿—
PHP_FPM_LOG_DIR=./logs/php-fpm

# PHP-FPMé…ç½®
PHP_FPM_INI=./php-fpm/php

# PHP-FPMç«¯å£
PHP_FPM_PORT=9000

# SWOFTç«¯å£
SWOFT_PORT=18306


## Nginx
# Nginxæ—¥å¿—
NGINX_LOG_DIR=./logs/nginx

# Nginxé…ç½®
NGINX_CONF=./nginx/sites

# Nginxç«¯å£
NGINX_PORT=8081


## MySQL
# MySQLæ•°æ®
MYSQL_DATA=./data

# MySQLé…ç½®
MYSQL_CONF=./mysql/conf.d

# MySQLç«¯å£
MYSQL_PORT=3306


## Redis
# Redisç«¯å£
REDIS_PORT=6379
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[åˆæ¢Docker---ç¼–å†™Dockerfileæ­å»ºPHPå¼€å‘ç¯å¢ƒ]]></title>
    <link href="https://anhoder.github.io/15981627591823.html"/>
    <updated>2020-08-23T14:05:59+08:00</updated>
    <id>https://anhoder.github.io/15981627591823.html</id>
    <content type="html"><![CDATA[
<p>ä½¿ç”¨Dockerfileæ­å»ºPHPå¼€å‘ç¯å¢ƒï¼ˆä¹‹åæ·»åŠ docker-composeï¼‰ï¼Œé¡¹ç›®åœ°å€è§<strong>åŸæ–‡é“¾æ¥</strong>ã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">ä¸€ã€ç¼–å†™Dockerfile</h2>

<h3 id="toc_1">1. PHP-FPM</h3>

<pre><code class="language-dockerfile">FROM php:7.2-fpm

LABEL maintainer=&quot;AlanAlbert&quot; version=&quot;1.0&quot; description=&quot;php-fpm(php 7.2)&quot;

# è®¾ç½®æ—¶åŒº
ENV TZ=Asia/Shanghai

# å¤åˆ¶phpé…ç½®æ–‡ä»¶ã€php-fpmé…ç½®æ–‡ä»¶
COPY php.ini /usr/local/etc/php/
COPY php-fpm.conf /usr/local/etc/
COPY php-fpm.d/* /usr/local/etc/php-fpm.d/

# å®‰è£…PHPæ‰©å±•â€”â€”swooleã€redisã€pdo_mysqlã€mysqli
RUN docker-php-ext-install pdo_mysql mysqli \
    &amp;&amp; pecl install redis swoole \
    &amp;&amp; docker-php-ext-enable redis swoole

# æŒ‚è½½ç«™ç‚¹ç›®å½•ã€php-fpmæ—¥å¿—ç›®å½•ä¸ºåŒ¿åå·
VOLUME /home/www /var/log/php-fpm

# æ·»åŠ wwwç”¨æˆ·åŠåˆ‡æ¢ç«™ç‚¹ç›®å½•æ‰€æœ‰è€…
RUN useradd www \
    &amp;&amp; chown -R www /home/www

# åˆ‡æ¢å·¥ä½œç›®å½•ä¸ºæ ¹ç›®å½•
WORKDIR /

# å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œå‘½ä»¤
CMD [&quot;/usr/local/sbin/php-fpm&quot;]

# å£°æ˜ä½¿ç”¨9000ç«¯å£
EXPOSE 9000
</code></pre>

<h3 id="toc_2">2. Nginx</h3>

<pre><code class="language-dockerfile">FROM nginx

LABEL maintainer=&quot;AlanAlbert&quot; version=&quot;1.0&quot; description=&quot;nginx&quot;

# è®¾ç½®æ—¶åŒº
ENV TZ=Asia/Shanghai

# å¤åˆ¶Nginxé…ç½®
COPY nginx.conf /etc/nginx/
COPY sites/*.conf /etc/nginx/conf.d/

# æŒ‚è½½ç«™ç‚¹ã€Nginxæ—¥å¿—ä¸ºåŒ¿åå·
VOLUME /home/www /var/log/nginx

# æ·»åŠ wwwç”¨æˆ·ã€æ›´æ¢ç«™ç‚¹ç›®å½•æ‰€æœ‰è€…
RUN useradd www \
    &amp;&amp; chown -R www /home/www

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /home/www

# è®¾ç½®å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤
CMD [&quot;/usr/sbin/nginx&quot;]

# å£°æ˜ä½¿ç”¨çš„ç«¯å£
EXPOSE 80 443
</code></pre>

<h3 id="toc_3">3. MySQL</h3>

<pre><code class="language-dockerfile">FROM mysql:5.7

LABEL maintainer=&quot;AlanAlbert&quot; version=&quot;1.0&quot; description=&quot;mysql&quot;

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV MYSQL_ALLOW_EMPTY_PASSWORD=true \
    MYSQL_ROOT_PASSWORD=&quot;&quot; \
    TZ=Asia/Shanghai

# å¤åˆ¶MySQLé…ç½®
COPY my.cnf /etc/mysql/

# æŒ‚è½½MySQLæ•°æ®ç›®å½•ä¸ºåŒ¿åå·
VOLUME /var/lib/mysql

# å£°æ˜ä½¿ç”¨çš„ç«¯å£
EXPOSE 3306
</code></pre>

<h3 id="toc_4">4. Redis</h3>

<pre><code class="language-dockerfile">FROM redis

LABEL maintainer=&quot;AlanAlbert&quot; version=&quot;1.0&quot; description=&quot;redis&quot;

# è®¾ç½®æ—¶åŒº
ENV TZ=Asia/Shanghai

# å£°æ˜éœ€è¦ä½¿ç”¨çš„ç«¯å£
EXPOSE 6379
</code></pre>

<h2 id="toc_5">äºŒã€ç¼–å†™shellè„šæœ¬ç®¡ç†å®¹å™¨</h2>

<p>å› ä¸ºæš‚æ—¶æ²¡æœ‰ä½¿ç”¨docker-composeï¼Œè€Œdockerå‘½ä»¤è¾ƒé•¿ï¼Œå¾ˆå¤æ‚ï¼Œæ‰€ä»¥ç¼–å†™è„šæœ¬æ¥ç®¡ç†å®¹å™¨</p>

<h3 id="toc_6">1. build</h3>

<pre><code class="language-bash">#!/bin/bash

# å‘ç”Ÿé”™è¯¯ï¼Œä¸­æ–­æ‰§è¡Œ
set -e

echo &quot;å¼€å§‹æ„å»º...&quot;
echo &quot;æ­£åœ¨æ„å»ºPHP-FPM...&quot;

# æ„å»ºPHP-FPMé•œåƒï¼Œå¹¶è®¾ç½®åç§°ä¸ºalan/php-fpm
docker build -t alan/php-fpm php-fpm

# åˆ›å»ºPHP-FPMå®¹å™¨ã€‚
# 1. -p: å°†å®¹å™¨9000ç«¯å£æ˜ å°„åˆ°ç‰©ç†æœº9000ç«¯å£ï¼›
# 2. --name: æŒ‡å®šåç§°ä¸ºalan_php-fpmï¼›
# 3. -i: å¼€å¯å®¹å™¨æ ‡å‡†è¾“å…¥
# 4. -t: åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯
# 5. -v: æŒ‚è½½wwwç›®å½•åˆ°/home/wwwã€logs/php-fpmç›®å½•åˆ°/car/log/php-fpm
# 6. --network: è¿æ¥åˆ°alan_php_envç½‘ç»œ
docker create -p 9000:9000 --name alan_php-fpm -it -v `pwd`/www:/home/www -v `pwd`/logs/php-fpm:/var/log/php-fpm --network alan_php_env alan/php-fpm

echo &quot;PHP-FPMæ„å»ºå®Œæˆ.&quot;
echo &quot;æ­£åœ¨æ„å»ºNginx...&quot;

# æ„å»ºNginxé•œåƒï¼Œè®¾ç½®åç§°ä¸ºalan/nginx
docker build -t alan/nginx nginx

# åˆ›å»ºNginxå®¹å™¨ã€‚
# 1. -p: æ˜ å°„ç«¯å£
# 2. --name: è®¾ç½®é•œåƒåç§°
# 3. -i: å¼€å¯æ ‡å‡†è¾“å…¥
# 4. -t: åˆ†é…ä¼ªè¾“å…¥ç»ˆç«¯
# 5. -v: æŒ‚è½½ç›®å½•
# 6. --network: è¿æ¥ç½‘ç»œ
docker create -p 80:80 --name alan_nginx -it -v `pwd`/www:/home/www -v `pwd`/logs/nginx:/var/log/nginx --network alan_php_env alan/nginx

echo &quot;Nginxæ„å»ºå®Œæˆ.&quot;
echo &quot;æ­£åœ¨æ„å»ºMySQL...&quot;

# æ„å»ºMySQLé•œåƒ
docker build -t alan/mysql mysql

# åˆ›å»ºMySQLå®¹å™¨
docker create -p 3306:3306 --name alan_mysql -it -v `pwd`/data:/var/lib/mysql --network alan_php_env alan/mysql

echo &quot;MySQLæ„å»ºå®Œæˆ.&quot;
echo &quot;æ­£åœ¨æ„å»ºRedis...&quot;

# æ„å»ºRedisé•œåƒ
docker build -t alan/redis redis

# åˆ›å»ºRediså®¹å™¨
# --requirepass: è®¾ç½®Rediså¯†ç 
docker create -p 6379:6379 --name alan_redis -it --network alan_php_env alan/redis --requirepass &quot;&quot;

echo &quot;Redisæ„å»ºå®Œæˆ.&quot;
echo &quot;æ­£åœ¨åˆ›å»ºç½‘ç»œ...&quot;

# åˆ›å»ºbridgeç½‘ç»œ
docker network create -d bridge alan_php_env

echo &quot;ç½‘ç»œåˆ›å»ºå®Œæˆ.&quot;
echo &quot;æ„å»ºå®Œæˆ.&quot;
</code></pre>

<h3 id="toc_7">2. start</h3>

<pre><code class="language-bash">#!/bin/bash
set -e

echo &quot;æ­£åœ¨å¯åŠ¨...&quot;

# å¯åŠ¨æ‰€æœ‰å®¹å™¨
docker start alan_php-fpm alan_nginx alan_mysql alan_redis

echo &quot;å¯åŠ¨å®Œæˆ.&quot;

</code></pre>

<h3 id="toc_8">3. stop</h3>

<pre><code class="language-bash">#!/bin/bash

echo &quot;æ­£åœ¨åœæ­¢...&quot;

# åœæ­¢æ‰€æœ‰å®¹å™¨
docker stop alan_redis alan_mysql alan_nginx alan_php-fpm

echo &quot;å·²åœæ­¢.&quot;
</code></pre>

<h3 id="toc_9">4. restart</h3>

<pre><code class="language-bash">#!/bin/bash
set -e

echo &quot;æ­£åœ¨é‡å¯...&quot;

# é‡å¯æ‰€æœ‰é•œåƒ
docker restart alan_redis alan_mysql alan_nginx alan_php-fpm

echo &quot;é‡å¯å®Œæˆ.&quot;
</code></pre>

<h3 id="toc_10">5. uninstall</h3>

<pre><code class="language-bash">#!/bin/bash

# åœæ­¢æ‰€æœ‰å®¹å™¨ &amp;&amp; åˆ é™¤æ‰€æœ‰å®¹å™¨ &amp;&amp; åˆ é™¤æ‰€æœ‰é•œåƒ &amp;&amp; åˆ é™¤ç½‘ç»œ

echo &quot;æ­£åœ¨å¸è½½...&quot;
echo &quot;æ­£åœ¨åœæ­¢è¿è¡Œå®¹å™¨...&quot;

docker stop alan_redis alan_mysql alan_nginx alan_php-fpm

echo &quot;å·²åœæ­¢.&quot;
echo &quot;æ­£åœ¨åˆ é™¤å®¹å™¨...&quot;

docker rm alan_redis alan_mysql alan_nginx alan_php-fpm

echo &quot;å·²åˆ é™¤å®¹å™¨.&quot;
echo &quot;æ­£åœ¨åˆ é™¤é•œåƒ...&quot;

docker rmi alan/redis alan/mysql alan/nginx alan/php-fpm

echo &quot;å·²åˆ é™¤é•œåƒ.&quot;
echo &quot;æ­£åœ¨åˆ é™¤ç½‘ç»œ...&quot;

docker network rm alan_php_env

echo &quot;å·²åˆ é™¤ç½‘ç»œ.&quot;
echo &quot;å¸è½½å®Œæˆ.&quot;
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[åˆæ¢Docker---DockeråŠDockerfile]]></title>
    <link href="https://anhoder.github.io/15981627591857.html"/>
    <updated>2020-08-23T14:05:59+08:00</updated>
    <id>https://anhoder.github.io/15981627591857.html</id>
    <content type="html"><![CDATA[
<p>å­¦ä¹ Dockerè¿‡ç¨‹ä¸­è‡ªå·±çš„ä¸€äº›ç†è§£ã€‚</p>

<ul>
<li>ä»€ä¹ˆæ˜¯Dockerã€Dockerfileï¼Ÿ</li>
<li>æ€ä¹ˆä½¿ç”¨Dockerï¼Ÿ</li>
<li>å¦‚ä½•ç¼–å†™Dockerfileï¼Ÿ</li>
</ul>

<span id="more"></span><!-- more -->

<h2 id="toc_0">1. é•œåƒ</h2>

<p>é•œåƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…å«æ‰€éœ€è¦çš„ç¨‹åºã€èµ„æºã€åº“ã€é…ç½®ç­‰æ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€äº›ä¸ºè¿è¡Œæ—¶å‡†å¤‡çš„é…ç½®å‚æ•°ã€‚Dockeré•œåƒå¹¶ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œæ˜¯ç”±å¤šå±‚æ–‡ä»¶ç³»ç»Ÿè”åˆç»„æˆçš„ã€‚é•œåƒæ˜¯ä¸€å±‚ä¸€å±‚æ„å»ºçš„ï¼Œè€Œä¸”åˆ é™¤å‰ä¸€å±‚æ–‡ä»¶çš„æ“ä½œå¹¶ä¸æ˜¯çœŸçš„åˆ é™¤æ–‡ä»¶ï¼Œè€Œæ˜¯å°†å…¶æ ‡è®°ä¸ºè¯¥æ–‡ä»¶å·²åˆ é™¤ã€‚</p>

<h2 id="toc_1">2. å®¹å™¨</h2>

<p>å®¹å™¨æ˜¯ä½¿ç”¨é•œåƒæ¥åˆ›å»ºçš„ï¼Œå…¶ç±»ä¼¼äº<code>ç±»</code>ä¸<code>å¯¹è±¡</code>çš„å…³ç³»ï¼š</p>

<ul>
<li>é•œåƒæ˜¯<code>ç±»</code>ï¼Œæ˜¯é™æ€çš„å®šä¹‰ï¼›</li>
<li>å®¹å™¨æ˜¯å®ä¾‹åŒ–çš„<code>å¯¹è±¡</code>ï¼Œæ˜¯åŠ¨æ€è¿è¡Œæ—¶çš„å®ä½“ã€‚</li>
</ul>

<h2 id="toc_2">3. ä»“åº“</h2>

<p><strong>ä»“åº“ï¼ˆRepositoryï¼‰</strong>æ˜¯ä¸€ä¸ªé›†ä¸­å­˜å‚¨ã€åˆ†å‘é•œåƒçš„åœºæ‰€ï¼Œä¾‹å¦‚ï¼šå­˜æ”¾Ubuntué•œåƒçš„ä»“åº“æ˜¯Ubuntuä»“åº“ã€‚å¦ä¸€ä¸ªæ¦‚å¿µæ˜¯<strong>æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰</strong>ï¼Œæ³¨å†ŒæœåŠ¡å™¨æ˜¯å­˜æ”¾ä»“åº“çš„åœ°æ–¹ã€‚</p>

<h2 id="toc_3">4. dockerå‘½ä»¤åˆ—è¡¨</h2>

<ul>
<li><code>docker help</code>: è·å–å¸®åŠ©ä¿¡æ¯</li>
<li><code>docker exec</code>: åœ¨æ­£åœ¨è¿è¡Œçš„å®¹å™¨ä¸­è¿è¡Œå‘½ä»¤</li>
<li><code>docker pull</code>: ä»æœåŠ¡å™¨æå–é•œåƒæˆ–å­˜å‚¨åº“</li>
<li><code>docker ps</code>: åˆ—å‡ºå®¹å™¨ä¿¡æ¯</li>
<li><code>docker images</code>: åˆ—å‡ºæ‰€æœ‰é•œåƒ</li>
<li><code>docker build</code>: é€šè¿‡Dockerfileæ„å»ºé•œåƒ</li>
<li><code>docker create IMAGE</code>: åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ä½†ä¸å¯åŠ¨</li>
<li><code>docker run IMAGE [COMMAND]</code>: åˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªå‘½ä»¤</li>
<li><code>docker restart CONTAINER</code>: é‡å¯å®¹å™¨</li>
<li><code>docker start CONTAINER</code>: å¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨</li>
<li><code>docker stop CONTAINER</code>: åœæ­¢å®¹å™¨</li>
<li><code>docker top CONTAINER</code>: æŸ¥çœ‹å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯</li>
<li><code>docker rm</code>: åˆ é™¤å®¹å™¨</li>
<li><code>docker rmi</code>: åˆ é™¤é•œåƒ</li>
<li><code>docker volume</code>: æ•°æ®å·ç®¡ç†</li>
<li><code>docker network</code>: ç½‘ç»œç®¡ç†</li>
<li><code>docker commit</code>: ä»å½“å‰æ›´æ”¹çš„å®¹å™¨çŠ¶æ€åˆ›å»ºæ–°é•œåƒ</li>
<li><code>docker search</code>: åœ¨æœåŠ¡å™¨ä¸­æœç´¢é•œåƒ</li>
<li><code>docker version</code>: æŸ¥çœ‹dockerç‰ˆæœ¬ä¿¡æ¯</li>
<li><code>docker attach</code>: å°†æœ¬åœ°è¾“å…¥ã€è¾“å‡ºã€é”™è¯¯æµé™„åŠ åˆ°æ­£åœ¨è¿è¡Œçš„å®¹å™¨</li>
<li><code>docker history</code>: æŸ¥çœ‹é•œåƒå†å²è®°å½•</li>
<li><code>docker info</code>: æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯</li>
<li><code>docker inspect</code>: è·å–å®¹å™¨/é•œåƒçš„å…ƒæ•°æ®</li>
<li><code>docker login</code>: ç™»å½•åˆ°æœåŠ¡å™¨</li>
<li><code>docker pause CONTAINER</code>: æš‚åœå®¹å™¨ä¸­æ‰€æœ‰çš„è¿›ç¨‹</li>
<li><code>docker unpause CONTAINER</code>: æ¢å¤å®¹å™¨ä¸­çš„æ‰€æœ‰è¿›ç¨‹</li>
<li><code>docker kill CONTAINER</code>: æ€æ‰ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨</li>
</ul>

<h2 id="toc_4">5. Dockerfile</h2>

<p>Dockerfileä¸­æä¾›äº†å¾ˆå¤šæŒ‡ä»¤ï¼Œä»¥ä¸‹å°†ä¼šæåˆ°è¿™äº›æŒ‡ä»¤çš„ä½œç”¨å’Œç”¨æ³•ã€‚</p>

<h3 id="toc_5"><code>FROM</code></h3>

<ul>
<li><p>æŒ‡å®š<strong>åŸºç¡€é•œåƒ</strong>ã€‚å¦‚: nginx, ubunuç­‰ã€‚</p></li>
<li><p>è¿˜å¯ä»¥ä½¿ç”¨ç©ºç™½é•œåƒ(<code>scratch</code>)ä½œä¸ºåŸºç¡€é•œåƒã€‚</p></li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>FROM nginx</code>ï¼Œæˆ–æŒ‡å®šç‰ˆæœ¬<code>FROM ubuntu:stretch</code></p>
</blockquote>

<h3 id="toc_6"><code>RUN</code></h3>

<ul>
<li><p>è¿è¡Œå‘½ä»¤ã€‚</p></li>
<li><p>å¯ä»¥è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼š<code>RUN [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;]</code></p></li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>RUN echo &#39;æµ‹è¯•&#39; &gt; a.txt</code></p>
</blockquote>

<h3 id="toc_7"><code>COPY</code></h3>

<ul>
<li><p>å¤åˆ¶æ–‡ä»¶ã€‚</p></li>
<li><p>å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼š<code>COPY *.txt /var/www/</code></p></li>
<li><p>å¯ä»¥æŒ‡å®šå¤åˆ¶åæ–‡ä»¶çš„æ‰€å±ç”¨æˆ·åŠç»„ï¼š<code>COPY --chown=name a.txt /var/www/</code></p></li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>COPY a.txt /var/www/</code></p>
</blockquote>

<h3 id="toc_8"><code>ADD</code></h3>

<ul>
<li><p>é«˜çº§çš„<code>COPY</code>æŒ‡ä»¤ï¼Œå¯ä»¥æŒ‡å®šURLã€‚ä»URLä¸‹è½½çš„æ–‡ä»¶é»˜è®¤æƒé™ä¸º600ã€‚</p></li>
<li><p>è¯¥å‘½ä»¤å¯ä»¥ç”¨<code>RUN</code>æŒ‡ä»¤æ‰§è¡Œ<code>wget</code>æˆ–<code>curl</code>æ›¿æ¢</p></li>
</ul>

<p><strong>ä¸æ¨èä½¿ç”¨</strong></p>

<h3 id="toc_9"><code>CMD</code></h3>

<ul>
<li><p>Dockerå®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œã€‚</p></li>
<li><p>ä¸RUNæŒ‡ä»¤ä¸€æ ·ï¼Œè¯¥æŒ‡ä»¤ä¹Ÿæ”¯æŒexecã€shellä¸¤ç§å†™æ³•ï¼š<code>CMD &lt;å‘½ä»¤&gt;</code>ã€ <code>CMD [&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;...]</code></p></li>
<li><p>ä¸€ä¸ªDockerfileåªèƒ½æœ‰ä¸€ä¸ªCMDå‘½ä»¤ã€‚</p></li>
</ul>

<blockquote>
<p>ä½¿ç”¨: <code>CMD [&quot;curl&quot;, &quot;-s&quot;, &quot;https://dogedoge.com&quot;]</code></p>
</blockquote>

<h3 id="toc_10"><code>ENTRYPOINT</code></h3>

<ul>
<li><p>ä¸<code>CMD</code>æŒ‡ä»¤ä¸€æ ·ï¼Œç”¨äºæŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°ã€‚</p></li>
<li><p>åŒæ ·æ”¯æŒexecåŠshellå†™æ³•</p></li>
<li><p>ä¸CMDæŒ‡ä»¤çš„åŒºåˆ«åœ¨äºï¼šcommandä¼šä½œä¸ºå‚æ•°ä¼ é€’ç»™ENTRYPOINTæŒ‡ä»¤</p></li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>ENTRYPOINT [&quot;curl&quot;, &quot;-s&quot;, &quot;https://dogedoge.com&quot;]</code></p>
</blockquote>

<h3 id="toc_11"><code>ENV</code></h3>

<ul>
<li>è®¾ç½®ç¯å¢ƒå˜é‡</li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>ENV &lt;key&gt; &lt;value&gt;</code> æˆ– <code>ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt; ...</code></p>
</blockquote>

<h3 id="toc_12"><code>ARG</code></h3>

<ul>
<li>ä¸ENVæŒ‡ä»¤æ•ˆæœä¸€æ ·ï¼Œéƒ½æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä½†ARGè®¾ç½®çš„ç¯å¢ƒå˜é‡åœ¨å®¹å™¨è¿è¡Œæ—¶æ˜¯ä¸ä¼šå­˜åœ¨çš„</li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>ARG name=Alan</code></p>
</blockquote>

<h3 id="toc_13"><code>VOLUME</code></h3>

<ul>
<li><p>æŒ‚è½½åŒ¿åå·(volume)ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·åœ¨è¿è¡Œæ—¶å¿˜è®°å°†åŠ¨æ€æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶æŒ‚è½½ä¸ºå·(docker -v)ï¼Œæˆ‘ä»¬å¯ä»¥äº‹å…ˆåœ¨Dockerfileä¸­æŒ‡å®šæŒ‚è½½æŸäº›ç›®å½•ä¸ºåŒ¿åå·ã€‚</p></li>
<li><p>Dockerè¿è¡Œæ—¶åº”ä¿æŒå®¹å™¨å­˜å‚¨å±‚ä¸å‘ç”Ÿå†™æ“ä½œï¼Œå®¹å™¨å­˜å‚¨å±‚çš„æ•°æ®åœ¨å®¹å™¨åœæ­¢åä¸ä¼šæŒç»­å­˜åœ¨ã€‚æ‰€ä»¥å°†æ•°æ®å†™å…¥åˆ°å·ä¸­ï¼Œå¯ä»¥æŒä¹…åŒ–å­˜å‚¨æ•°æ®ï¼Œæé«˜æ€§èƒ½ã€‚</p></li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>VOLUME /var/data</code></p>
</blockquote>

<h3 id="toc_14"><code>EXPOSE</code></h3>

<ul>
<li><p>å£°æ˜æ‰“ç®—ä½¿ç”¨çš„ç«¯å£ã€‚</p></li>
<li><p>ä¸<code>docker -p &lt;å®¿ä¸»ç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;</code>ä¸åŒï¼Œ<code>EXPOSE</code>åªæ˜¯å£°æ˜æ‰“ç®—ä½¿ç”¨çš„ç«¯å£ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨åšç«¯å£æ˜ å°„</p>
<blockquote>
<p>ä½¿ç”¨ï¼š<code>EXPOSE 8080</code></p>
</blockquote></li>
</ul>

<h3 id="toc_15"><code>WORKDIR</code></h3>

<ul>
<li>æŒ‡å®šå½“å‰å·¥ä½œç›®å½•ã€‚</li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>WORKDIR /var/data</code></p>
</blockquote>

<h3 id="toc_16"><code>USER</code></h3>

<ul>
<li>æŒ‡å®šå½“å‰ç”¨æˆ·ï¼Œ<code>USER &lt;ç”¨æˆ·å&gt;:&lt;ç”¨æˆ·ç»„&gt;</code></li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>USER php</code></p>
</blockquote>

<h3 id="toc_17"><code>HEALTHCHECK</code></h3>

<ul>
<li>æ£€æŸ¥å®¹å™¨çš„å¥åº·çŠ¶å†µ</li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>HEALTHCHECK [é€‰é¡¹] CMD [å‘½ä»¤]</code> æˆ– <code>HEALTHCHECK NONE</code></p>
</blockquote>

<h3 id="toc_18"><code>ONBUILD</code></h3>

<ul>
<li>å½“è¯¥é•œåƒä½œä¸ºåŸºç¡€é•œåƒè¢«å…¶ä»–é•œåƒä½¿ç”¨æ—¶æ‰ä¼šè¢«æ‰§è¡Œã€‚</li>
</ul>

<blockquote>
<p>ä½¿ç”¨ï¼š<code>ONBUILD RUN [&quot;npm&quot;, &quot;install&quot;]</code></p>
</blockquote>

<hr/>

<p><em>ä¸‹ä¸€ç¯‡ï¼š<a href="#">åˆæ¢Docker---ç¼–å†™Dockerfileæ­å»ºPHPçš„å¼€å‘ç¯å¢ƒ</a></em></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç™¾ä¸‡çº§æ•°æ®è¿ç§»ã€æ±‡æ€»]]></title>
    <link href="https://anhoder.github.io/15981630682166.html"/>
    <updated>2020-08-23T14:11:08+08:00</updated>
    <id>https://anhoder.github.io/15981630682166.html</id>
    <content type="html"><![CDATA[
<p>æœ€è¿‘åœ¨å·¥ä½œä¸­ï¼Œéœ€è¦å¯¹ä¸€äº›æ•°æ®è¡¨çš„æ•°æ®è¿›è¡Œè¿ç§»åŠæ±‡æ€»ï¼Œæ‰€ä»¥æ€»ç»“ä¸‹è‡ªå·±é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">ä¸€ã€æ•°æ®è¿ç§»</h2>

<p>å¯¹ç™¾ä¸‡çº§æ•°æ®è¿›è¡Œæ•°æ®è¿ç§»ã€‚</p>

<h3 id="toc_1">1. é—®é¢˜</h3>

<p>åœ¨è¿›è¡Œè¿ç§»è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œä¸”å­˜åœ¨å†…å­˜é™åˆ¶ï¼Œå› æ­¤å°†æ‰€æœ‰æ•°æ®ä¸€æ¬¡å…¨éƒ¨å–å‡ºæ¥æ˜¯è‚¯å®šä¸è¡Œçš„ã€‚é‚£å¦‚ä½•è¿›è¡Œæ•°æ®è¿ç§»å‘¢ï¼Ÿ</p>

<h3 id="toc_2">2. è§£å†³æ–¹æ³•</h3>

<p>æ—¢ç„¶ä¸€æ¬¡è£…ä¸ä¸‹æ‰€æœ‰æ•°æ®ï¼Œé‚£å°±ä½¿ç”¨<strong>åˆ†æ®µçš„å½¢å¼</strong>æ¥ä¾æ¬¡è¯»å–ã€‚</p>

<ul>
<li>è¯´åˆ°åˆ†æ®µè¯»å–ï¼Œæœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯ä½¿ç”¨MySQLæä¾›çš„åˆ†æ®µæ–¹å¼ <code>limit m,n</code> æ¥è¯»å–æ•°æ®ã€‚</li>
</ul>

<blockquote>
<p>ä½†æ˜¯ä½¿ç”¨<code>limit m,n</code>è¿›è¡Œåˆ†æ®µå–æ•°æ®ï¼ŒMySQLéœ€è¦é¦–å…ˆè®¡ç®—å‡ºmè¡Œæ•°æ®ï¼Œç„¶åå¾€åå–næ¡ã€‚å› æ­¤å½“må€¼è¶Šå¤§ï¼ŒæŸ¥è¯¢é€Ÿåº¦å°±ä¼šè¶Šæ…¢ã€‚</p>
</blockquote>

<ul>
<li>å¦å¤–ä¸€ç§æ–¹å¼ï¼Œç”¨<code>where</code>æ¡ä»¶æŸ¥è¯¢æ¥æŸ¥è¯¢æ•°æ®ï¼Œè¿›è€Œè®©MySQLä½¿ç”¨åˆ°ç´¢å¼•ã€‚</li>
</ul>

<blockquote>
<p>æ¯ä¸ªæ•°æ®è¡¨éƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå¢IDï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªè‡ªå¢IDä½œä¸ºæ¡ä»¶åˆ¤æ–­ã€‚æ¯æ¬¡å–å‡ºæ•°æ®åï¼Œéƒ½è®°å½•ä¸Šæ¬¡æœ€åä¸€è¡Œè®°å½•çš„IDï¼Œä»¥ä½œä¸ºä¸‹æ¬¡å–æ•°æ®çš„åˆ¤æ–­ä¾æ®ã€‚ä¾‹å¦‚ï¼š</p>

<pre><code class="language-sql">SELECT * FROM `test` WHERE id&gt;2000 LIMIT 1000;
</code></pre>

<p>å…¶ä¸­ï¼Œ2000å°±æ˜¯ä¸Šä¸€æ¬¡å–å‡ºçš„æ•°æ®ä¸­çš„æœ€å¤§IDã€‚</p>
</blockquote>

<p>ç”±æ­¤ï¼Œæˆ‘åŸºäºilluminate/databaseç¼–å†™äº†ä¸€ä¸ªç±»ä¼¼äºåˆ†é¡µå™¨çš„æ•°æ®è¯»å–ç»„ä»¶ï¼š</p>

<p>å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code class="language-php">use AlanAlbert\Segmenter\Contract\Processor;
use Illuminate\Database\Eloquent\Model;
use \Exception;
use Illuminate\Database\Eloquent\Builder;
class Segmenter
{
    const ALL_ROWS = -1;
    
    /**
     * æºæ¨¡å‹
     * @var array
     */
    protected $sourceModel = null;
    
    /**
     * ä¿å­˜æ¯ä¸ªæ¨¡å‹çš„æœ€åä¸€è¡Œä¸»é”®id
     * @var int
     */
    private $lastRowId = -1;
    
    /**
     *æ¨¡å‹ä¸­æœ€å¤§çš„ID
     * @var int
     */
    private $maxRowId = 0;
    
    /**
     * ä¸€æ¬¡å¤„ç†çš„æ•°æ®é‡
     * @var int
     */
    private $oneTimeRowNumber = -1;
    
    /**
     * ç”¨äºè®°å½•è¡Œæ•°çš„åˆ—åï¼ˆä¿è¯å…¶åœ¨æºæ¨¡å‹ä¸­å”¯ä¸€æ€§åŠé€’å¢æ€§ï¼‰
     * @var string
     */
    private $mainField = &#39;&#39;;
    
    /**
     * éœ€è¦è·å–çš„åˆ—
     * @var array|mixed
     */
    private $fields = [];
    
    /**
     * æ•°æ®è¡¨çš„åˆ«å
     * @var mixed|string
     */
    private $as = &#39;&#39;;
    
    /**
     * Segmenteræ„é€ å‡½æ•°
     *
     * @param Model|Builder $sourceModel
     * @param array $config
     *   é…ç½®çš„ç»“æ„ï¼š
     *      [
     *          rows_number: ä¸€æ¬¡è¯»å–æ•°æ®è¡Œæ•°,
     *          main_field: æ ¹æ®å“ªä¸€åˆ—è¿›è¡Œåˆ†æ®µï¼Œé»˜è®¤å–ä¸»é”®ID,
     *          fields: éœ€è¦è·å–çš„æ•°æ®åˆ—,
     *          table_alias: è¡¨çš„åˆ«å
     *      ]
     * 
     */
    public function __construct($sourceModel, array $config = [])
    {
        $this-&gt;sourceModel = $sourceModel;
        $this-&gt;oneTimeRowNumber = $config[&#39;rows_number&#39;] ?? self::ALL_ROWS;
        // è®¾ç½®main_field
        if (isset($config[&#39;main_field&#39;]) &amp;&amp; !empty($config[&#39;main_field&#39;])) {
            $this-&gt;mainField = $config[&#39;main_field&#39;];
        } else {
            $this-&gt;mainField = $sourceModel instanceof Model ?
                $sourceModel-&gt;newInstance()-&gt;getKeyName() : 
                $sourceModel-&gt;newModelInstance()-&gt;getKeyName();
        }
        // è®¾ç½®fields
        $this-&gt;fields = $config[&#39;fields&#39;] ?? [];
        // è®¾ç½®è¡¨åˆ«å
        $tableName = $sourceModel instanceof Model ?
            $sourceModel-&gt;newInstance()-&gt;getTable() : 
            $sourceModel-&gt;newModelInstance()-&gt;getTable();
        $this-&gt;as = $config[&#39;table_alias&#39;] ?? $tableName;
        // è·å–æœ€å¤§ID
        $maxRowId = (clone $sourceModel)
            -&gt;orderByDesc($this-&gt;as . &#39;.&#39; . $this-&gt;mainField)
            -&gt;limit(1)
            -&gt;value($this-&gt;mainField);
        $this-&gt;maxRowId = $maxRowId ?? 0;
        var_dump(&#39;æœ€å¤§ID: &#39; . $this-&gt;maxRowId);
    }
    
    /**
     * è¿ç§»æ•°æ®
     * @param Processor $processor å®ç°DataProcessoræ¥å£ï¼Œä¸»è¦å¤„ç†è¯»å‡ºåçš„æ•°æ®
     * @param mixed ...$args é¢å¤–éœ€è¦ä½¿ç”¨çš„å‚æ•°
     * @return bool
     */
    public function execute(Processor $processor, ...$args): bool
    {
        // å¾ªç¯è¯»å–æ•°æ®ï¼Œç›´è‡³ç»“å°¾
        while ($this-&gt;lastRowId &lt; $this-&gt;maxRowId) {
            if ($this-&gt;executeOneTime($processor, ...$args) === false) {
                return false;
            }
        }
    
        return true;
    }
    
    /**
     * 
     * @param Processor $processor
     * @param mixed ...$args
     * @return bool
     */
    protected function executeOneTime(Processor $processor, ...$args): bool
    {
        // è·å–åŸå§‹æ•°æ®
        $sourceModel = $this-&gt;sourceModel
            -&gt;where($this-&gt;as . &#39;.&#39; . $this-&gt;mainField, &#39;&gt;&#39;, $this-&gt;lastRowId)
            -&gt;orderBy($this-&gt;as . &#39;.&#39; . $this-&gt;mainField);
        if ($this-&gt;oneTimeRowNumber &gt; 0) {
            $sourceModel = $sourceModel
                -&gt;limit($this-&gt;oneTimeRowNumber);
        }
        if (!empty($this-&gt;fields)) {
            $sourceData = $sourceModel
                -&gt;get(array_merge($this-&gt;fields, [$this-&gt;as . &#39;.&#39; . $this-&gt;mainField]));
        } else {
            $sourceData = $sourceModel
                -&gt;get();
        }
        
        // æ›´æ–°å½“å‰ID
        $mainField = $this-&gt;mainField;
        $this-&gt;lastRowId = $sourceData-&gt;last()-&gt;$mainField;
        var_dump(&#39;å½“å‰ID: &#39; . $this-&gt;lastRowId . &#39;/&#39; . $this-&gt;maxRowId);
        return $processor-&gt;process($sourceData, ...$args);
    }
}
</code></pre>

<p><em>è™½ç„¶æœ€åå·¥ä½œä¸­ä¹Ÿæ²¡ç”¨åˆ°...</em></p>

<h2 id="toc_3">äºŒã€æ•°æ®æ±‡æ€»</h2>

<p>å¯¹ç™¾ä¸‡çº§æ•°æ®è¿›è¡Œåˆ†ç»„æ±‡æ€»ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šç»Ÿè®¡å‡ºè¿é”ç½‘å§çš„ç”¨æˆ·æ•°ã€‚</p>

<h3 id="toc_4">1. é—®é¢˜</h3>

<p>å¦‚æœé€‰è¯¾è¡¨ä¸º<code>user_log</code>ï¼Œç½‘å§IDä¸º<code>bar_id</code>ï¼Œç”¨æˆ·IDä¸º<code>user_id</code>ã€‚ç»Ÿè®¡çš„SQLè¯­å¥å¯ä»¥ä¸ºï¼š</p>

<pre><code class="language-sql">SELECT COUNT(DISTINCT `bar_id`, `user_id`) AS `user_number` 
  FROM `user_log`;
</code></pre>

<p>ä½†æ˜¯è¿™æ ·å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæ±‡æ€»çš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè„šæœ¬è¿è¡Œæ—¶é—´éœ€è¦ç”¨åˆ°<strong>ä¸€åˆ†åŠé’Ÿ</strong>ï¼Œè¿™å¯¹äº10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡çš„è„šæœ¬æ¥è¯´ï¼Œæ—¶é—´æœ‰ç‚¹é•¿ï¼Œå¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿ</p>

<h3 id="toc_5">2. è§£å†³æ–¹æ³•</h3>

<p>ä½¿ç”¨ä¸´æ—¶è¡¨ï¼š</p>

<ol>
<li>é¦–å…ˆå¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œ<code>group by</code>å¤šåˆ—åˆ†ç»„ï¼Œå°†å¾—åˆ°çš„ç»“æœä½œä¸ºä¸´æ—¶è¡¨</li>
<li>å¯¹ä¸´æ—¶è¡¨ä¸­çš„æ•°æ®è¿›è¡Œç»Ÿè®¡</li>
</ol>

<p>ä¾‹å¦‚ï¼š</p>

<pre><code class="language-sql">SELECT `bar_id`, COUNT(`bar_id`) AS `user_number`
  FROM (SELECT `bar_id` FROM `user_log` GROUP BY `bar_id`, `user_id`)
  GROUP BY `bar_id`;
</code></pre>

<h2 id="toc_6">ä¸‰ã€å…¶ä»–é—®é¢˜</h2>

<p>å½“æ’å…¥æˆ–æ›´æ–°çš„æ•°æ®è¡Œå¾ˆå¤šæ—¶ï¼Œå‡ºç°å ä½ç¬¦è¿‡å¤šçš„çš„é—®é¢˜ï¼š<code>Prepared statement contains too many placeholders</code>ã€‚</p>

<blockquote>
<p>è¿™æ˜¯å› ä¸ºMySQLæ”¯æŒçš„å ä½ç¬¦æœ‰æ•°é‡é™åˆ¶ï¼ˆ2<sup>16</sup> - 1ï¼‰ï¼Œå› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨<code>array_chunk</code>å‡½æ•°å¯¹éœ€è¦çš„æ•°æ®è¿›è¡Œåˆ†å—å¤„ç†ï¼Œç„¶åä¾æ¬¡æ’å…¥ã€‚</p>
</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPå®ç°å¼‚æ­¥å›è°ƒçš„æ€»ç»“]]></title>
    <link href="https://anhoder.github.io/15981638628871.html"/>
    <updated>2020-08-23T14:24:22+08:00</updated>
    <id>https://anhoder.github.io/15981638628871.html</id>
    <content type="html"><![CDATA[
<p>å¾ˆä¹…æ²¡æ›´æ–°åšå®¢äº†ï¼Œæœ€è¿‘åœ¨ä¸‹ç­æ—¶é—´å†™äº†ä¸€ä¸ªç®€å•çš„PHPåº“â€”â€”<a href="https://github.com/anhoder/php-async">php-async</a>åŠ<a href="https://github.com/anhoder/php-async-manager">php-async-manager</a>ï¼Œä»¥å®ç°PHPä¸­çš„ç®€å•å¼‚æ­¥å›è°ƒã€‚</p>

<span id="more"></span><!-- more -->

<p><em>Mission Start!</em></p>

<h2 id="toc_0">0. å‰è¨€</h2>

<blockquote>
<p>æœ€è¿‘é‡åˆ°ä¸ªé—®é¢˜ï¼ŒPHPçš„å¼‚æ­¥å›è°ƒæ€ä¹ˆå®ç°ï¼Ÿ</p>
</blockquote>

<p>Workmanã€Swooleã€fastcgi_finish_requestï¼Ÿ</p>

<ul>
<li>Workmanã€Swooleè¿™äº›æ¡†æ¶è™½ç„¶å¯¹å¼‚æ­¥å›è°ƒå®ç°çš„å¾ˆå¥½ï¼Œä½†æ˜¯å¦‚æœåªéœ€è¦ç®€å•çš„å¼‚æ­¥å›è°ƒå°±ä¸Šè¿™äº›æœªå…å¤§æå°ç”¨ã€‚</li>
<li>è€Œfastcgi_finish_requestè™½ç„¶ä½¿ç”¨æ–¹é¢ï¼Œä½†æ¯•ç«Ÿåªèƒ½åœ¨php-fpmæ¨¡å¼ä¸‹ä½¿ç”¨ï¼Œè€Œä¸”ä¸€æ¬¡è¯·æ±‚åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚</li>
</ul>

<p>ä¹‹åå°±ä¸€ç›´åœ¨æ€è€ƒï¼šèƒ½ä¸èƒ½è‡ªå·±å®ç°ä¸€ä¸ªPHPå¯ç”¨çš„ç®€å•å¼‚æ­¥å›è°ƒå‘¢ï¼Ÿæœ€åˆå‡ºç°åœ¨æˆ‘è„‘æµ·çš„æœ‰å‡ ä¸ªæ–¹æ¡ˆï¼š</p>

<ol>
<li>ç¼–å†™PHPæ‰©å±•ï¼Œä½¿ç”¨C/C++åˆ›å»ºå®ˆæŠ¤è¿›ç¨‹è¿›ç¨‹ï¼Œç”¨äºç›‘å¬æ˜¯å¦æœ‰å¼‚æ­¥ä»»åŠ¡åˆ°æ¥ï¼Œå¦‚æœæœ‰ä»»åŠ¡åˆ°æ¥ï¼Œåˆ™æ‰§è¡Œä»»åŠ¡åŠå›è°ƒå‡½æ•°ã€‚è€ŒPHPè¿›ç¨‹åˆ™å°†å¼‚æ­¥ä»»åŠ¡ä¼ é€’ç»™è¯¥ç›‘å¬è¿›ç¨‹ï¼Œä»è€Œå®ç°å¼‚æ­¥ã€‚</li>
<li>ä½¿ç”¨pcntlæ‰©å±•åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶è®©å­è¿›ç¨‹è„±ç¦»çˆ¶è¿›ç¨‹çš„æ§åˆ¶ï¼Œæˆä¸ºå®ˆæŠ¤è¿›ç¨‹ã€‚å­è¿›ç¨‹ç”¨äºå¤„ç†è€—æ—¶çš„å¼‚æ­¥ä»»åŠ¡ï¼Œçˆ¶è¿›ç¨‹å¤„ç†HTTPè¯·æ±‚åŠè¿”å›å“åº”ã€‚</li>
</ol>

<p>ç”±äºç¬¬äºŒç§æ–¹æ¡ˆæ›´ç®€å•ï¼Œå› æ­¤é€‰æ‹©ä½¿ç”¨ç¬¬äºŒç§æ–¹æ¡ˆè¿›è¡Œå®ç°ã€‚</p>

<h2 id="toc_1">1. å®ç°åŸç†åŠæ€è·¯</h2>

<p>å®ç°åŸç†æ¯”è¾ƒç®€å•ï¼š</p>

<blockquote>
<ol>
<li>åœ¨å½“å‰è¿›ç¨‹ä¸­åˆ›å»ºå­è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹å¤„ç†è€—æ—¶è¾ƒçŸ­çš„HTTPä¸šåŠ¡é€»è¾‘ï¼›å­è¿›ç¨‹å¤„ç†è€—æ—¶è¾ƒé•¿çš„ä»»åŠ¡ï¼Œä¾‹å¦‚é‚®ä»¶å‘é€ç­‰ã€‚</li>
<li>åˆ›å»ºå­è¿›ç¨‹åï¼Œè®©å­è¿›ç¨‹è„±ç¦»çˆ¶è¿›ç¨‹çš„æ§åˆ¶ï¼Œæˆä¸ºå®ˆæŠ¤è¿›ç¨‹ã€‚</li>
<li>çˆ¶è¿›ç¨‹é€šè¿‡è®¾ç½®<code>Callable</code>æˆ–<code>Closure</code>å‡½æ•°ï¼Œè®©å­è¿›ç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡åŠå›è°ƒå‡½æ•°ã€‚</li>
</ol>
</blockquote>

<p>æ¯ä¸ªå¼‚æ­¥ä»»åŠ¡éƒ½éœ€è¦ä¸¤ä¸ªå…³é”®å…ƒç´ ç»„æˆï¼šå¼‚æ­¥ä»»åŠ¡æœ¬èº«ã€å›è°ƒå‡½æ•°ã€‚æ‰€ä»¥è®¾è®¡äº†JobInterfaceæ¥å£ï¼Œè¯¥æ¥å£è¦æ±‚å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šjobã€callbackï¼Œåˆ†åˆ«å¯¹åº”å¼‚æ­¥ä»»åŠ¡åŠå›è°ƒå‡½æ•°ã€‚å…·ä½“ä»£ç ä¸ºï¼š</p>

<pre><code class="language-php">interface JobInterface
{
    /**
     * å¼‚æ­¥ä»»åŠ¡
     *
     * @return void
     */
    public function job();

    /**
     * å›è°ƒå‡½æ•°
     *
     * @return void
     */
    public function callback();
}
</code></pre>

<h2 id="toc_2">2. é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ³•</h2>

<p>åœ¨CLIæ¨¡å¼ä¸‹å¼€å‘è¿è¡Œååˆ†é¡ºåˆ©ï¼Œæ²¡é‡åˆ°ä»€ä¹ˆè¾ƒå¤§çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œä¸€åˆ‡å¼€å‘å®Œæˆä¹‹åï¼Œåœ¨php-fpmæ¨¡å¼ä¸‹æµ‹è¯•ï¼Œé‡åˆ°ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>

<h3 id="toc_3">é—®é¢˜</h3>

<ol>
<li><strong>åˆ›å»ºçš„å­è¿›ç¨‹ç”±php-fpmç®¡ç†è¿›ç¨‹æ§åˆ¶</strong>ï¼Œå½“å­è¿›ç¨‹æ‰§è¡Œå®Œæˆåï¼Œå› ä¸ºphp-fpmæ²¡æœ‰ç»™è¯¥å¼‚æ­¥è¿›ç¨‹â€œæ”¶å°¸â€ï¼Œ<strong>å¯¼è‡´å…¶æˆä¸ºåƒµå°¸è¿›ç¨‹ï¼Œå ç”¨ç³»ç»Ÿèµ„æº</strong>ã€‚</li>
<li>å› ä¸ºåœ¨php-fpmæ¨¡å¼ä¸‹ï¼Œè¿›ç¨‹å—php-fpmç®¡ç†è¿›ç¨‹çš„æ§åˆ¶ï¼Œå› æ­¤çŒœæµ‹<strong>å¼‚æ­¥è¿›ç¨‹çš„æ•°é‡å¯èƒ½å—php-fpmé…ç½®çš„è¿›ç¨‹æ•°é™åˆ¶</strong>ã€‚</li>
</ol>

<h3 id="toc_4">è§£å†³æ–¹æ¡ˆ</h3>

<ol>
<li>å¯¹äºâ€œåƒµå°¸è¿›ç¨‹â€çš„é—®é¢˜ï¼Œè®©çˆ¶è¿›ç¨‹å¿½ç•¥å­è¿›ç¨‹çš„ç»“æŸï¼Œä»è€Œå°†å­è¿›ç¨‹çš„å›æ”¶æƒç§»äº¤ç»™ç³»ç»Ÿçš„initè¿›ç¨‹ï¼Œç”±initè¿›ç¨‹å›æ”¶åˆ›å»ºçš„å­è¿›ç¨‹ï¼š<code>pcntl_signal(SIGCHLD, SIG_IGN);</code>ã€‚</li>
<li>php-fpmé…ç½®çš„è¿›ç¨‹æ•°é™åˆ¶ï¼Œç»è¿‡æµ‹è¯•ï¼ˆå°†php-fpmé…ç½®æ–‡ä»¶ä¸­çš„æœ€å¤§è¿›ç¨‹æ•°æ”¹ä¸º5ï¼Œå¹¶ä½¿ç”¨é™æ€æ¨¡å¼ï¼‰å‘ç°ï¼Œå¹¶æœªå‡ºç°çŒœæƒ³ä¸­çš„åˆ›å»ºå­è¿›ç¨‹è¢«é™åˆ¶çš„é—®é¢˜ã€‚</li>
</ol>

<h2 id="toc_5">3. æœ€åç»“æœ</h2>

<p>æœ€åå®ç°çš„ç»“æœä¸º: <a href="https://github.com/anhoder/php-async">php-async</a>ã€‚åœ¨CLIå’Œphp-fpmæ¨¡å¼ä¸‹éƒ½æ²¡æœ‰å‘ç°é—®é¢˜ã€‚</p>

<p>ä¹‹åï¼Œæˆ‘è¿˜åŸºäºsymfony/consoleå¼€å‘äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹å¼‚æ­¥ä»»åŠ¡çš„å‘½ä»¤è¡Œå·¥å…·â€”â€”<a href="https://github.com/anhoder/php-async-manager">php-async-manager</a>ï¼Œå¯ä»¥ç”¨äºæŸ¥çœ‹å¼‚æ­¥ä»»åŠ¡è¿è¡ŒçŠ¶æ€ã€åœæ­¢æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ç­‰ã€‚</p>

<h2 id="toc_6">4. åç»­æ‹“å±•</h2>

<p>è¯¥å¼‚æ­¥å®ç°æ–¹æ¡ˆè¿˜å­˜åœ¨ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå³ï¼Œæ¯æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å°±è¦åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œå½“å¤„ç†çš„è¯·æ±‚æ•°é‡æ¯”è¾ƒå¤šæ—¶ï¼Œå°±éœ€è¦åˆ›å»ºå¤ªå¤šçš„è¿›ç¨‹ã€‚</p>

<p>ä¹‹åäº†è§£äº†NodeJSçš„å¼‚æ­¥å®ç°åŸç†ï¼Œå…¶åº•å±‚ä½¿ç”¨libuvåº“ï¼Œä»¥äº‹ä»¶ä¸ºé©±åŠ¨ï¼Œlibuvè´Ÿè´£å°†æ¥è‡ªæ“ä½œç³»ç»Ÿçš„äº‹ä»¶æ”¶é›†èµ·æ¥ï¼Œæˆ–è€…ç›‘è§†å…¶ä»–æ¥æºçš„äº‹ä»¶ã€‚è¿™æ ·ï¼Œç”¨æˆ·å°±å¯ä»¥æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°ä¼šåœ¨äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™è¢«è°ƒç”¨ã€‚event-loopä¼šä¸€ç›´ä¿æŒè¿è¡ŒçŠ¶æ€ã€‚</p>

<p>å› æ­¤ï¼Œæœ€å¥½çš„å¼‚æ­¥å®ç°æ–¹æ¡ˆè¿˜æ˜¯ä½¿ç”¨Cè¯­è¨€å¼€å‘ä¸€ä¸ªPHPçš„æ‰©å±•ğŸ˜‚ã€‚</p>

<p><em>Mission Complete!</em></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPçš„ä¸€äº›åº•å±‚çŸ¥è¯†]]></title>
    <link href="https://anhoder.github.io/15981633177242.html"/>
    <updated>2020-08-23T14:15:17+08:00</updated>
    <id>https://anhoder.github.io/15981633177242.html</id>
    <content type="html"><![CDATA[
<p>è‡ªå·±åœ¨å­¦ä¹ PHPåº•å±‚æ—¶çš„ä¸€äº›ç¬”è®°ã€‚</p>

<span id="more"></span><!-- more -->

<blockquote>
<p><em>é˜…è¯»<a href="https://github.com/huanghantao/study-note/blob/master/PHP/PHP%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0.md">https://github.com/huanghantao/study-note/blob/master/PHP/PHP%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0.md</a>çš„ç¬”è®°</em></p>
</blockquote>

<h2 id="toc_0">1. php-config</h2>

<p><code>php-config</code>æ˜¯ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œè„šæœ¬ï¼Œ<strong>ç”¨äºè·å–PHPçš„å®‰è£…åŠé…ç½®ä¿¡æ¯</strong>ã€‚å½“å®‰è£…å¤šä¸ªPHPç‰ˆæœ¬æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>--with-php-config</code>æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„PHPæ¥è¿›è¡Œç¼–è¯‘ã€‚</p>

<h2 id="toc_1">2. PHPçš„æ‰©å±•ç±»å‹</h2>

<p>PHPçš„æ‰©å±•å¯åˆ†ä¸ºé™æ€æ‰©å±•å’ŒåŠ¨æ€æ‰©å±•ä¸¤ç±»ã€‚</p>

<ul>
<li>é™æ€æ‰©å±•æ˜¯ä¸PHPæºç ä¸€èµ·è¿›è¡Œç¼–è¯‘å®‰è£…çš„ï¼Œç¼–è¯‘PHPæ—¶é€šè¿‡æŒ‡å®šå‚æ•°<code>--enable</code>å’Œ<code>--with</code>æ¥å¯ç”¨æ‰©å±•ã€‚</li>
<li>åŠ¨æ€æ‰©å±•æ˜¯ç›´æ¥ç¼–è¯‘æ‰©å±•çš„æºä»£ç ï¼Œç”Ÿæˆ<code>.so</code>(Linux)æˆ–<code>.dll</code>(Windows)çš„åŠ¨æ€é“¾æ¥åº“ï¼Œç„¶ååœ¨php.inié…ç½®æ–‡ä»¶ä¸­å¼€å¯ã€‚</li>
</ul>

<blockquote>
<p>åœ¨é™æ€ç¼–è¯‘PHPæ—¶ï¼Œenable æ˜¯å¯ç”¨ PHP æºç åŒ…è‡ªå¸¦ï¼Œä½†æ˜¯é»˜è®¤ä¸å¯ç”¨çš„æ‰©å±•ï¼Œæ¯”å¦‚ ftp å’Œ exif æ‰©å±•ã€‚with æ˜¯æŒ‡å®šæ‰©å±•ä¾èµ–çš„èµ„æºåº“çš„ä½ç½®ï¼Œå¦‚æœæ˜¯é»˜è®¤ä½ç½®ï¼Œå°±å¯ä»¥ç•™ç©ºã€‚</p>
</blockquote>

<h2 id="toc_2">3. PHPå‡½æ•°çš„åº•å±‚å®ç°</h2>

<p>PHPçš„å‡½æ•°åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§ä¸ºå†…ç½®å‡½æ•°<code>zend_internal_function</code>ï¼Œå¦ä¸€ç§ä¸ºç”¨æˆ·å‡½æ•°<code>zend_user_function</code>ã€‚</p>

<ul>
<li>å†…ç½®å‡½æ•°åœ¨PHPçš„å†…æ ¸å®ç°ï¼Œé€šè¿‡c/c++è¿›è¡Œç¼–å†™</li>
<li>ç”¨æˆ·å‡½æ•°æ˜¯ç”¨æˆ·ä½¿ç”¨PHPè‡ªå®šä¹‰çš„å‡½æ•°ï¼Œè¿™ç§å‡½æ•°ä¼šè¢«ZE(Zend Engine)ç¼–è¯‘ä¸ºopcodeæ¥æ‰§è¡Œ</li>
</ul>

<p>PHPåœ¨ç¼–è¯‘é˜¶æ®µå°†ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°ç¼–è¯‘ä¸ºç‹¬ç«‹çš„opcodes,ä¿å­˜åœ¨EG(function_table)ä¸­,è°ƒç”¨æ—¶é‡æ–°åˆ†é…æ–°çš„zend_execute_data(ç›¸å½“äºè¿è¡Œæ ˆ),ç„¶åæ‰§è¡Œå‡½æ•°çš„opcodes,è°ƒç”¨å®Œå†è¿˜åŸåˆ°æ—§çš„zend_execute_dataï¼Œå³åŸæ¥çš„å‡½æ•°ï¼Œç»§ç»­æ‰§è¡Œã€‚</p>

<p>zend_functionçš„ç»“æ„ä¸­çš„op_arrayå­˜å‚¨äº†è¯¥å‡½æ•°ä¸­æ‰€æœ‰çš„æ“ä½œ,å½“å‡½æ•°è¢«è°ƒç”¨æ—¶,ZEå°±ä¼šå°†è¿™ä¸ªop_arrayä¸­çš„oplineä¸€æ¡æ¡é¡ºæ¬¡æ‰§è¡Œ, å¹¶å°†æœ€åçš„è¿”å›å€¼è¿”å›ã€‚ ä»VLDæ‰©å±•ä¸­æŸ¥çœ‹çš„å…³äºå‡½æ•°çš„ä¿¡æ¯å¯ä»¥çœ‹å‡º,å‡½æ•°çš„å®šä¹‰å’Œæ‰§è¡Œæ˜¯åˆ†å¼€çš„,ä¸€ä¸ªå‡½æ•°å¯ä»¥ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„è¿è¡Œå•å…ƒè€Œå­˜åœ¨ã€‚</p>

<h2 id="toc_3">4. PHPçš„çº¿ç¨‹å®‰å…¨</h2>

<p>é…ç½®ç¼–è¯‘PHPæ—¶åŠ å‚æ•°<code>--enable-maintainer-zts</code>åˆ™ç¼–è¯‘å‡ºçš„phpä¸ºZendçº¿ç¨‹å®‰å…¨ï¼ˆZTSï¼‰ï¼Œå¦åˆ™ä¸æ˜¯çº¿ç¨‹å®‰å…¨ï¼ˆNTSï¼‰ã€‚</p>

<p>å½“<strong>ä½¿ç”¨pthreadï¼ˆPOSIX threadsï¼‰æ‰©å±•æ—¶ï¼Œæˆ–è€…å½“webæœåŠ¡å™¨ä¸ºApache2 mpm-workeræˆ–IIS</strong>ä½¿ç”¨PHPä½œä¸ºæ¨¡å—æ—¶ï¼Œè¯·è€ƒè™‘ä½¿ç”¨ZTSã€‚å½“<strong>ä½¿ç”¨FastCGI / FPMæˆ–Apache2 mpm-prefork</strong>æ—¶ï¼Œæ‚¨ä¸éœ€è¦ZTSï¼Œå› ä¸ºåœ¨PHPè¿è¡Œæ—¶ä½¿ç”¨çš„å¤šè¿›ç¨‹å¤„ç†ã€‚</p>

<p>NTSæ˜¯è¿è¡ŒPHPçš„é¦–é€‰æ–¹å¼ã€‚NTSè¿˜ä½¿æ‚¨æ›´å®¹æ˜“ç¼–å†™å’Œè°ƒè¯•æ‰©å±•ã€‚</p>

<h2 id="toc_4">5. Zendå¼•æ“çš„æ‰§è¡Œè¿‡ç¨‹</h2>

<blockquote>
<ol>
<li>Zend Engineè°ƒç”¨è¯æ³•åˆ†æå™¨å°†PHPè„šæœ¬åˆ†å‰²ä¸ºä¸€ä¸ªä¸€ä¸ªçš„token</li>
<li>Zend Engineä¼šå°†å¾—åˆ°çš„tokenæäº¤ç»™è¯­æ³•åˆ†æå™¨ï¼Œç”ŸæˆæŠ½è±¡è¯­æ³•æ ‘(Abstract Syntax Tree)</li>
<li>ZEè°ƒç”¨zend_compile_top_stmt()å‡½æ•°å°†æŠ½è±¡è¯­æ³•æ ‘è§£æä¸ºä¸€ä¸ªä¸€ä¸ªçš„opcodeï¼Œopcodeä¸€èˆ¬ä¼šä»¥op_arrayçš„å½¢å¼å­˜åœ¨ï¼Œå®ƒæ˜¯PHPæ‰§è¡Œçš„ä¸­é—´è¯­è¨€</li>
<li>æœ€å,ZEè°ƒç”¨zend_executoræ¥æ‰§è¡Œop_arrayï¼Œè¾“å‡ºç»“æœ</li>
</ol>
</blockquote>

<h3 id="toc_5">Token</h3>

<p>PHPæä¾›<code>token_get_all</code>å‡½æ•°æ¥è·å–tokenï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-php">$token = token_get_all(&#39;&lt;?php echo \&#39;hello, world\&#39;;&#39;);
var_dump($token);
</code></pre>

<p>è¾“å‡ºç»“æœä¸ºï¼š</p>

<pre><code class="language-bash">array(5) {
  [0] =&gt;
  array(3) {
    [0] =&gt;
    int(379)
    [1] =&gt;
    string(6) &quot;&lt;?php &quot;
    [2] =&gt;
    int(1)
  }
  [1] =&gt;
  array(3) {
    [0] =&gt;
    int(328)
    [1] =&gt;
    string(4) &quot;echo&quot;
    [2] =&gt;
    int(1)
  }
  [2] =&gt;
  array(3) {
    [0] =&gt;
    int(382)
    [1] =&gt;
    string(1) &quot; &quot;
    [2] =&gt;
    int(1)
  }
  [3] =&gt;
  array(3) {
    [0] =&gt;
    int(323)
    [1] =&gt;
    string(14) &quot;&#39;hello, world&#39;&quot;
    [2] =&gt;
    int(1)
  }
  [4] =&gt;
  string(1) &quot;;&quot;
}
</code></pre>

<h3 id="toc_6">ASTæŠ½è±¡è¯­æ³•æ ‘</h3>

<p>ä»¥ä¸‹å·¥å…·å¯ä»¥ç”¨äºæŸ¥çœ‹ASTç»“æ„ä¿¡æ¯ï¼š</p>

<ul>
<li><a href="https://pecl.php.net/package/ast">https://pecl.php.net/package/ast</a>  (æ‰©å±•)</li>
<li><a href="https://dooakitestapp.herokuapp.com/phpast/webapp/">https://dooakitestapp.herokuapp.com/phpast/webapp/</a> (åœ¨çº¿)</li>
<li><a href="https://github.com/nikic/PHP-Parser">https://github.com/nikic/PHP-Parser</a> (PHPè§£æå·¥å…·)</li>
</ul>

<h3 id="toc_7">Opcode</h3>

<p>opcodeæ˜¯Zendè™šæ‹Ÿæœºå¯è¯†åˆ«çš„æŒ‡ä»¤ï¼Œphp7å…±æœ‰173ä¸ªopcodeï¼Œå®šä¹‰åœ¨zend_vm_opcodes.hä¸­ï¼Œè¿™äº›ä¸­é—´ä»£ç ä¼šè¢«Zend VM(Zendè™šæ‹Ÿæœº)ç›´æ¥æ‰§è¡Œã€‚</p>

<p>æŸ¥çœ‹opcodeå¯ä»¥ä½¿ç”¨ï¼š</p>

<ul>
<li><a href="https://pecl.php.net/package/vld">https://pecl.php.net/package/vld</a> (æ‰©å±•)</li>
<li><a href="https://3v4l.org/UBstu/vld#output">https://3v4l.org/UBstu/vld#output</a> (åœ¨çº¿)</li>
</ul>

<h2 id="toc_8">6. EGå˜é‡</h2>

<p>executor_globalsæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå­˜å‚¨ç€è®¸å¤šä¿¡æ¯(å½“å‰ä¸Šä¸‹æ–‡ã€ç¬¦å·è¡¨ã€å‡½æ•°/ç±»/å¸¸é‡è¡¨ã€å †æ ˆç­‰)ï¼ŒEGå®å°±æ˜¯ç”¨äºè®¿é—®executor_globalsçš„æŸä¸ªæˆå‘˜</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPä¸­çš„fastcgi_finish_requestå‡½æ•°]]></title>
    <link href="https://anhoder.github.io/15981638628901.html"/>
    <updated>2020-08-23T14:24:22+08:00</updated>
    <id>https://anhoder.github.io/15981638628901.html</id>
    <content type="html"><![CDATA[
<p>fastcgi_finish_requestæ˜¯<strong>å·¥ä½œåœ¨FastCGIæ¨¡å¼ä¸‹</strong>æ‰å¯ç”¨çš„å‡½æ•°ã€‚ä½¿ç”¨è¿™ä¸ªè„šæœ¬å¯ä»¥æé«˜è¯·æ±‚å“åº”é€Ÿåº¦ã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">CGI</h2>

<p>CGIï¼Œå…¬å…±ç½‘å…³æ¥å£ï¼Œæ˜¯ä¸€ç§WebæœåŠ¡å™¨ä¸åç«¯è¯­è¨€çš„é€šä¿¡è§„èŒƒã€‚CGIä¼šåœ¨è¯·æ±‚åˆ°æ¥æ—¶ï¼Œforkå‡ºä¸€ä¸ªå­è¿›ç¨‹ç”¨äºå¤„ç†è¯·æ±‚ï¼Œå½“å¤„ç†å®Œæˆåï¼Œä¼šæ€æ­»è¯¥è¿›ç¨‹ï¼Œä¸‹æ¬¡è¯·æ±‚åˆ°æ¥æ—¶ç»§ç»­åˆ›å»ºï¼Œå¦‚æ­¤å¾€å¤...</p>

<p>å› æ­¤ï¼ŒCGIåœ¨åˆ›å»ºè¿›ç¨‹ä¸Šä¼šå­˜åœ¨æå¤§åœ°èµ„æºæ¶ˆè€—ã€‚ç°åœ¨ä½¿ç”¨è¾ƒå°‘ã€‚</p>

<h2 id="toc_1">FastCGI</h2>

<p>FastCGIå¯ä»¥è¯´æ˜¯CGIçš„å‡çº§ç‰ˆæœ¬ï¼Œå…¶è§£å†³äº†CGIåœ¨åˆ›å»ºè¿›ç¨‹ä¸Šçš„èµ„æºæ¶ˆè€—ã€‚</p>

<p>å…·ä½“æ–¹æ³•ä¸ºï¼Œå½“FastCGIè¿›ç¨‹ç®¡ç†å™¨å¯åŠ¨æ—¶ï¼Œä¼šåˆ›å»ºè‹¥å¹²ä¸ªCGIè¿›ç¨‹ï¼ˆæ•°é‡å¯é…ç½®ï¼‰ç­‰å¾…è¯·æ±‚åˆ°æ¥ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½èŠ±æ—¶é—´å»åˆ›å»ºï¼ŒåŒæ—¶å¯ä»¥æ ¹æ®è¯·æ±‚æ•°å¯¹CGIè¿›ç¨‹æ•°è¿›è¡Œä¼¸ç¼©ã€‚</p>

<h2 id="toc_2">fastcgi_finish_request</h2>

<p>è¯¥å‡½æ•°å°±æ˜¯<strong>å·¥ä½œåœ¨FastCGIæ¨¡å¼ä¸‹çš„</strong>ã€‚å…·ä½“ä½œç”¨ä¸ºï¼Œå½“æ‰§è¡Œåˆ°è¯¥å‡½æ•°æ—¶ï¼Œç›´æ¥å‘å®¢æˆ·ç«¯è¿”å›å“åº”ï¼Œä½†åç»­è„šæœ¬ä»ç„¶æ‰§è¡Œï¼Œåªæ˜¯å¯¹ç”¨æˆ·ä¸å¯è§ã€‚</p>

<p>ä¾‹å¦‚è„šæœ¬æ–‡ä»¶a.phpï¼š</p>

<pre><code class="language-php">echo &#39;Hello, Alan&#39;;

fastcgi_finish_request();

sleep(5);
file_put_contents(&#39;a.txt&#39;, &#39;æµ‹è¯•å†…å®¹&#39;);
</code></pre>

<p>åŒæ—¶ï¼Œä½¿ç”¨tailå‘½ä»¤ç›‘æ§a.txtæ–‡ä»¶çš„å†…å®¹ï¼š</p>

<pre><code class="language-bash">$ tail -f -n 5 a.txt
</code></pre>

<p>å¯åŠ¨Nginxã€PHP-FPMï¼Œå¹¶è®¿é—®a.phpï¼Œå¯ä»¥å‘ç°å¾ˆå¿«å°±èƒ½å¾—åˆ°å“åº”ï¼Œå¹¶ä¸ä¼šå—åé¢<code>sleep(5)</code>çš„å½±å“ï¼Œ5ç§’ä¹‹åa.txtæ–‡ä»¶ä¹Ÿä¼šå‡ºç°<code>æµ‹è¯•å†…å®¹</code>ã€‚</p>

<h2 id="toc_3">å…¶ä»–</h2>

<p>å› ä¸ºè¯¥å‡½æ•°<strong>åªèƒ½åœ¨FastCGIæ¨¡å¼ä¸‹å¯ç”¨</strong>ï¼Œå› æ­¤ï¼Œå¦‚æœéœ€è¦è€ƒè™‘å¯ç§»æ¤æ€§ï¼Œå¯ä»¥è‡ªå·±æ ¹æ®ä¸šåŠ¡é€»è¾‘å®ç°fastcgi_finish_requestå‡½æ•°ï¼š</p>

<pre><code class="language-php">if (!function_exists(&#39;fastcgi_finish_request&#39;)) {
  function fastcgi_finish_request() {
  
  }
}
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPæ‰©å±•ä¹‹å…¨å±€å˜é‡çš„ä½¿ç”¨]]></title>
    <link href="https://anhoder.github.io/15981633177280.html"/>
    <updated>2020-08-23T14:15:17+08:00</updated>
    <id>https://anhoder.github.io/15981633177280.html</id>
    <content type="html"><![CDATA[
<p>ä½¿ç”¨Cè¯­è¨€å¼€å‘PHPæ‰©å±•æ—¶å¯èƒ½éœ€è¦ä½¿ç”¨åˆ°å…¨å±€å˜é‡ï¼Œåœ¨ä½¿ç”¨å…¨å±€å˜é‡æ—¶æ¶‰åŠåˆ°çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼ŒPHPè®¾è®¡äº†TSRM(çº¿ç¨‹å®‰å…¨èµ„æºç®¡ç†å™¨)æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨æ‰©å±•å¼€å‘ä¸­éœ€è¦æŒ‰ç…§TSRMçš„è§„èŒƒå®šä¹‰å…¨å±€å˜é‡ã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">ZEND_BEGIN_MODULE_GLOBALSã€ZEND_END_MODULE_GLOBALS</h2>

<p>PHPä¸ºæ‰©å±•çš„å…¨å±€å˜é‡æä¾›ä¸€ç§å­˜å‚¨æ–¹å¼ï¼šæ¯ä¸ªæ‰©å±•å°†è‡ªå·±æ‰€æœ‰çš„å…¨å±€å˜é‡ç»Ÿä¸€å®šä¹‰åœ¨ç»“æ„ä½“ä¸­ï¼Œç„¶åå°†è¿™ä¸ªç»“æ„ä½“æ³¨å†Œåˆ°TSRMä¸­ã€‚</p>

<p>ZEND_BEGIN_MODULE_GLOBALSã€ZEND_END_MODULE_GLOBALSä¾¿æ˜¯ç”¨æ¥å®šä¹‰è¿™ä¸ªç»“æ„ä½“çš„ã€‚ä½¿ç”¨æ–¹å¼ä¸ºï¼š</p>

<pre><code class="language-c">ZEND_BEGIN_MODULE_GLOBALS(extension_name)
    zend_long   val
    HashTable   table
ZEND_END_MODULE_GLOBALS(extension_name)
</code></pre>

<h2 id="toc_1">ZEND_DECLARE_MODULE_GLOBALS</h2>

<p>å®šä¹‰å¥½å­˜å‚¨å…¨å±€å˜é‡çš„ç»“æ„ä½“åï¼Œä¾¿éœ€è¦å°†è¯¥ç»“æ„ä½“æ³¨å†Œè¿›TSRMä¸­ã€‚ZEND_DECLARE_MODULE_GLOBALSå®å°±æ˜¯ç”¨äºå¤„ç†è¿™ä¸ªæ“ä½œã€‚</p>

<pre><code class="language-c">ZEND_DECLARE_MODULE_GLOBALS(extension_name)
</code></pre>

<h2 id="toc_2">ZEND_MODULE_GLOBALS_ACCESSOR</h2>

<p>è®¿é—®æ‰©å±•ä¸­å®šä¹‰çš„å…¨å±€å˜é‡ï¼š</p>

<pre><code class="language-c">ZEND_MODULE_GLOBALS_ACCESSOR(extension_name, val)
</code></pre>

<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ä¸€ä¸ªå®è¿›è¡Œè®¿é—®ï¼š</p>

<pre><code class="language-c">#define TEST_G(val) ZEND_MODULE_GLOBALS_ACCESSOR(extension_name, val)
</code></pre>

<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸€ä¸ªPHPæ‰©å±•ä¸­å¹¶ä¸æ˜¯åªèƒ½å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ç»“æ„ä½“ï¼Œæ•°é‡æ˜¯ä¸é™åˆ¶çš„ã€‚</p>
</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[config.m4è¯¦è§£]]></title>
    <link href="https://anhoder.github.io/15981633177311.html"/>
    <updated>2020-08-23T14:15:17+08:00</updated>
    <id>https://anhoder.github.io/15981633177311.html</id>
    <content type="html"><![CDATA[
<p>config.m4æ˜¯æ‰©å±•çš„ç¼–è¯‘é…ç½®æ–‡ä»¶ï¼Œå…¶ä¼šè¢«åŒ…å«åˆ°configure.inä¸­ï¼Œæœ€ç»ˆè¢«autoconfç¼–è¯‘ä¸ºconfigureã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">PHPæä¾›çš„å®</h2>

<h3 id="toc_1">PHP_ARG_WITH(arg_name, check_message, help_info)</h3>

<ul>
<li>å®šä¹‰ä¸€ä¸ª<code>--with-param[=arg]</code>çš„ç¼–è¯‘å‚æ•°ã€‚</li>
<li>è¿™ä¸ªå®æœ‰äº”ä¸ªå‚æ•°ï¼Œä½†å¸¸ç”¨çš„æ˜¯å‰ä¸‰ä¸ªã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸º<code>å‚æ•°å</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º<code>æ‰§è¡Œ./configureæ—¶çš„å±•ç¤ºä¿¡æ¯</code>ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸º<code>æ‰§è¡Œ --help æ—¶çš„å±•ç¤ºä¿¡æ¯</code>ã€‚</li>
<li>è¯¥å®å®šä¹‰çš„å‚æ•°å¯ä»¥åœ¨config.m4ä¸­é€šè¿‡<code>$PHP_å¤§å†™å‚æ•°å</code>çš„å½¢å¼è¿›è¡Œè®¿é—®ã€‚</li>
</ul>

<p>ä¾‹å¦‚ï¼š</p>

<pre><code class="language-php">PHP_ARG_WITH(extname, for extname support, [--with-extname=yes])
# é€šè¿‡$PHP_EXTNAMEå³å¯è·å¾—--with-extname=yesä¸­çš„yes
</code></pre>

<h3 id="toc_2">PHP_ARG_ENABLE(arg_name, check_message, help_info)</h3>

<ul>
<li>å®šä¹‰ä¸€ä¸ª<code>--enable-param[=arg]</code>æˆ–<code>--disable-param</code>ï¼ˆç­‰ä»·äº<code>--enable-param=no</code>ï¼‰</li>
<li>è¯¥å®ä¸<code>PHP_ARG_WITH</code>ç±»ä¼¼ï¼Œå¦‚æœå‚æ•°éœ€è¦è®¾ç½®å…·ä½“çš„å€¼ï¼Œåˆ™ä½¿ç”¨<code>PHP_ARG_WITH</code>ï¼Œå¦åˆ™ä½¿ç”¨<code>PHP_ARG_ENABLE</code></li>
</ul>

<h3 id="toc_3">AC_MSG_CHECKINGã€AC_MSG_RESULTã€AC_MSG_ERROR</h3>

<ul>
<li>AC_MSG_CHECKING([æç¤ºä¿¡æ¯]): åœ¨æ‰§è¡Œ./configureæ—¶ï¼Œcheckçš„æç¤ºä¿¡æ¯ã€‚</li>
<li>AC_MSH_RESULT([æ£€æµ‹çš„è·¯å¾„]): ç»“æŸcheckï¼Œç»§ç»­æ‰§è¡Œ</li>
<li>AC_MSG_ERROR([é”™è¯¯ä¿¡æ¯]): è¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶é€€å‡º./configureçš„æ‰§è¡Œ</li>
</ul>

<h3 id="toc_4">AC_DEFINE(variable, value, [description])</h3>

<ul>
<li>å®šä¹‰ä¸€ä¸ªå®ï¼Œä¾‹å¦‚ï¼š<code>AC_DEFINE(DEBUG_MODEL, 1, [open debug model])</code>ï¼Œæœ€ç»ˆä¼šæ‰§è¡Œ<code>#define DEBUG_MODEL 1</code></li>
</ul>

<h3 id="toc_5">PHP_ADD_INCLUDE(path)</h3>

<ul>
<li>æ·»åŠ includeè·¯å¾„ï¼Œç›¸å½“äº<code>#include &quot;file&quot;</code></li>
<li>å¼•ç”¨å¤–éƒ¨åº“æˆ–åˆ†ä¸ºå¤šä¸ªç›®å½•æ—¶ä¼šä½¿ç”¨åˆ°</li>
</ul>

<h3 id="toc_6">PHP_CHECK_LIBRARY(library, function [, action-found [, action-not-found [, extra-libs]]])</h3>

<ul>
<li>æ£€æŸ¥ä¾èµ–åº“libraryä¸­æ˜¯å¦å­˜åœ¨éœ€è¦çš„functionï¼Œaction-foundä¸ºå­˜åœ¨æ—¶æ‰§è¡Œçš„åŠ¨ä½œï¼Œaction-not-foundæ˜¯ä¸å­˜åœ¨æ—¶æ‰§è¡Œçš„åŠ¨ä½œ</li>
</ul>

<p>ä¾‹å¦‚ï¼š</p>

<pre><code class="language-php">PHP_CHECK_LIBRARY($EXAMPLE_LIB_NAME, example_critical_function, [
  dnl æ·»åŠ æ‰€éœ€çš„ include ç›®å½•
  PHP_EVAL_INCLINE($EXAMPLE_INCDIRS)
  dnl æ·»åŠ æ‰€éœ€çš„æ‰©å±•åº“åŠæ‰©å±•åº“æ‰€åœ¨ç›®å½•
  PHP_EVAL_LIBLINE($EXAMPLE_LIBS, EXAMPLE_SHARED_LIBADD)
],[
  dnl è·³å‡º
  AC_MSG_ERROR([example library not found. Check config.log for more information.])
],[$EXAMPLE_LIBS])
</code></pre>

<h3 id="toc_7">AC_CHECK_FUNC(function, [action-if-found], [action-if-not-found])</h3>

<ul>
<li>æ£€æŸ¥å‡½æ•°functionæ˜¯å¦å­˜åœ¨ï¼Œaction-if-foundä¸ºå­˜åœ¨æ—¶æ‰§è¡Œçš„åŠ¨ä½œï¼Œaction-if-not-foundä¸ºä¸å­˜åœ¨æ—¶æ‰§è¡Œçš„åŠ¨ä½œ</li>
</ul>

<h3 id="toc_8">PHP_ADD_LIBRARY_WITH_PATH</h3>

<ul>
<li>æ ¼å¼ä¸ºï¼š<code>PHP_ADD_LIBRARY_WITH_PATH($LIBNAME, $XXX_DIR/$PHP_LIBDIR, XXX_SHARED_LIBADD)</code>ï¼Œæ·»åŠ é“¾æ¥åº“</li>
</ul>

<p>ä¾‹å¦‚ï¼š</p>

<pre><code class="language-php">PHP_ADD_LIBRARY_WITH_PATH(example-extra, $PHP_EXAMPLE_EXTRA/lib, EXAMPLE_SHARED_LIBADD)
</code></pre>

<h3 id="toc_9">PHP_ADD_BUILD_DIR</h3>

<ul>
<li>åŠ è½½æ‰€éœ€æ‰€æœ‰Cæ–‡ä»¶</li>
</ul>

<h3 id="toc_10">PHP_REQUIRE_CXX()</h3>

<ul>
<li>ä½¿ç”¨C++è¿›è¡Œå¼€å‘</li>
</ul>

<h3 id="toc_11">PHP_SUBST(XXX_SHARED_LIBADD)</h3>

<ul>
<li>æ‰©å±•ç¼–è¯‘æˆåŠ¨æ€é“¾æ¥åº“çš„å½¢å¼</li>
</ul>

<h3 id="toc_12">PHP_NEW_EXTENSION(extname, sources , $ext_shared [, sapi_class [, extra-cflags [, cxx [, zend_ext]]]])</h3>

<ul>
<li>æ³¨å†Œä¸€ä¸ªæ‰©å±•</li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰©å±•çš„åç§°ï¼Œå’ŒåŒ…å«å®ƒçš„ç›®å½•åŒå</li>
<li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯åšä¸ºæ‰©å±•çš„ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æºæ–‡ä»¶çš„åˆ—è¡¨</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°æ€»æ˜¯ $ext_shared</li>
<li>ç¬¬å››ä¸ªå‚æ•°æŒ‡å®šä¸€ä¸ªâ€œSAPI ç±»â€ï¼Œä»…ç”¨äºä¸“é—¨éœ€è¦ CGI æˆ– CLI SAPI çš„æ‰©å±•</li>
<li>ç¬¬äº”ä¸ªå‚æ•°æŒ‡å®šäº†æ„å»ºæ—¶è¦åŠ å…¥ CFLAGS çš„æ ‡å¿—åˆ—è¡¨</li>
<li>ç¬¬å…­ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œä¸º &quot;yes&quot; æ—¶ä¼šå¼ºè¿«æ•´ä¸ªæ‰©å±•ä½¿ç”¨ <code>$CXX</code> ä»£æ›¿ <code>$CC</code> æ¥æ„å»º</li>
<li>ç¬¬ä¸‰ä¸ªä»¥åçš„æ‰€æœ‰å‚æ•°éƒ½æ˜¯å¯é€‰çš„</li>
</ul>

<p>ä¾‹å¦‚ï¼š</p>

<pre><code class="language-php">PHP_NEW_EXTENSION(example, example.c $EXAMPLE_SOURCES, $ext_shared)
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHPæ‰©å±•ç¼–å†™]]></title>
    <link href="https://anhoder.github.io/15981633177343.html"/>
    <updated>2020-08-23T14:15:17+08:00</updated>
    <id>https://anhoder.github.io/15981633177343.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<p><em>Mission Start!</em></p>

<p>PHPçš„æ‰©å±•åˆ†ä¸ºä¸¤ç±»ï¼šPHPæ‰©å±•ã€Zendæ‰©å±•ï¼Œåœ¨å†…æ ¸ä¸­åˆ†åˆ«ç§°ä¸ºmoduleã€extensionï¼Œä»¥ä¸‹çš„ä¸»è¦æ˜¯å…³äºmoduleçš„å†…å®¹ã€‚    </p>

<p>æ‰©å±•å¯ä»¥åœ¨ç¼–è¯‘PHPæ—¶ä¸€èµ·ç¼–è¯‘ï¼ˆé™æ€ç¼–è¯‘ï¼‰ï¼Œä¹Ÿå¯ä»¥å°†æ‰©å±•ç¼–è¯‘ä¸ºå…±äº«åº“ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶php.iniä¸­åŠ å…¥è¿›å»ã€‚</p>

<h2 id="toc_0">åŠ è½½PHPæ‰©å±•çš„è¿‡ç¨‹</h2>

<p><a href="https://blog.alan123.xyz/php/592.html">PHPç”Ÿå‘½å‘¨æœŸ</a>æœ‰5ä¸ªé˜¶æ®µï¼šæ¨¡å—åˆå§‹åŒ–é˜¶æ®µï¼ˆphp_module_startupï¼‰ã€è¯·æ±‚åˆå§‹åŒ–é˜¶æ®µï¼ˆphp_request_startupï¼‰ã€è„šæœ¬æ‰§è¡Œé˜¶æ®µï¼ˆscript executeï¼‰ã€è¯·æ±‚å…³é—­é˜¶æ®µï¼ˆphp_request_shutdown()ï¼‰ã€æ¨¡å—å…³é—­é˜¶æ®µï¼ˆphp_module_shutdown()ï¼‰ã€‚    </p>

<blockquote>
<p>â‘  PHPæ‰©å±•ä¼šåœ¨æ¨¡å—åˆå§‹åŒ–é˜¶æ®µè§£æphp.inié…ç½®æ–‡ä»¶ï¼Œå°†ç›¸å¯¹åº”çš„æ‰©å±•å…±äº«åº“åŠ è½½åˆ°PHPä¸­ï¼Œä¿å­˜åœ¨å…¨å±€å˜é‡extension_listsä¸­ï¼›<br/><br/>
â‘¡ åœ¨php_ini_register_extensions()ä¸­ä¾æ¬¡éå†php_extension_lists.engineã€php_extension_lists.functionsï¼Œç„¶ååˆ†åˆ«è°ƒç”¨php_load_zend_extension_cb()ã€php_load_php_extension_cb()å®ŒæˆZendæ‰©å±•ã€PHPæ‰©å±•çš„æ³¨å†ŒåŠ è½½ã€‚</p>
</blockquote>

<h2 id="toc_1">æ‰©å±•çš„ç»„æˆ</h2>

<p>â‘  é€šè¿‡zend_module_entryç»“æ„ä½“æ¥å®šä¹‰æ‰©å±•çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰©å±•åç§°ã€ç‰ˆæœ¬å·ã€hookå‡½æ•°ç­‰ã€‚ä¸”zend_module_entryç»“æ„ä½“å£°æ˜çš„å˜é‡åç§°éœ€è¦éµå¾ªmodulename_module_entryçš„æ ¼å¼ã€‚    </p>

<blockquote>
<ul>
<li><strong>name</strong>: æ‰©å±•åç§°</li>
<li><strong>functions</strong>: æ‰©å±•å®šä¹‰çš„å†…éƒ¨å‡½æ•°entry</li>
<li><strong>module_startup_func</strong>: åœ¨æ¨¡å—åˆå§‹åŒ–é˜¶æ®µå›è°ƒçš„hookå‡½æ•°</li>
<li><strong>module_shutdown_func</strong>: åœ¨æ¨¡å—å…³é—­é˜¶æ®µå›è°ƒçš„hookå‡½æ•°</li>
<li><strong>request_startup_func</strong>: åœ¨è¯·æ±‚åˆå§‹åŒ–é˜¶æ®µå›è°ƒçš„hookå‡½æ•°</li>
<li><strong>request_shutdown_func</strong>: åœ¨è¯·æ±‚å…³é—­é˜¶æ®µå›è°ƒçš„hookå‡½æ•°</li>
<li><strong>info_func</strong>: php_info()å‡½æ•°æ—¶è°ƒç”¨</li>
<li><strong>version</strong>: æ‰©å±•çš„ç‰ˆæœ¬ä¿¡æ¯</li>
</ul>
</blockquote>

<p>â‘¡ å®šä¹‰å®ZEND_GET_MODULE(extension_name)ä»¥è·å–æ‰©å±•çš„zend_module_entryç»“æ„åœ°å€ï¼š    </p>

<pre><code class="language-c">ZEND_GET_MODULE(extension_name)
</code></pre>
<br />
<p>åœ¨PHPä¸­ï¼ŒZEND_GET_MODULEå®çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>

<pre><code class="language-c">#define ZEND_GET_MODULE(name) \
    BEGIN_EXTERN_C() \
    ZEND_DLEXPORT zend_module_entry *get_module(void) { return &amp;name##_module_entry; } \    // ##èµ·åˆ°æ‹¼æ¥å­—ç¬¦ä¸²çš„ä½œç”¨
    END_EXTERN_C()
</code></pre>

<h2 id="toc_2">å¼€å‘PHPæ‰©å±•çš„æ­¥éª¤</h2>

<h3 id="toc_3">1ã€ext_skelç”Ÿæˆæ‰©å±•åŸºæœ¬æ¡†æ¶</h3>

<p>é€šè¿‡ext_skelè„šæœ¬ç”Ÿæˆæ‰©å±•çš„åŸºæœ¬æ¡†æ¶ï¼Œext_skelåœ¨PHPæºç çš„extç›®å½•ä¸‹ï¼Œä½¿ç”¨æ–¹æ³•ï¼š    </p>

<pre><code class="language-bash">./ext_skel --extname=extension_name
</code></pre>

<p>ç”Ÿæˆçš„ç›®å½•æ¡†æ¶å¦‚ä¸‹ï¼š    </p>

<pre><code class="language-bash">$ ./ext_skel --extname=TestExtension

TestExtension
â”œâ”€â”€ CREDITS
â”œâ”€â”€ EXPERIMENTAL
â”œâ”€â”€ TestExtension.c     // æ‰©å±•æºç 
â”œâ”€â”€ TestExtension.php   // ç”¨äºåœ¨PHPä¸­æµ‹è¯•æ‰©å±•æ˜¯å¦å¯ç”¨ï¼Œå¯å»é™¤
â”œâ”€â”€ config.m4           // æ‰©å±•ç¼–è¯‘æ—¶çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºphpizeè„šæœ¬ç”Ÿæˆconfigureæ–‡ä»¶
â”œâ”€â”€ config.w32          // windowsç¯å¢ƒçš„é…ç½®
â”œâ”€â”€ php_TestExtension.h // å¤´æ–‡ä»¶
â””â”€â”€ tests               // æµ‹è¯•ç”¨ä¾‹ï¼Œç”¨äºmake testçš„æµ‹è¯•
    â””â”€â”€ 001.phpt
</code></pre>

<h3 id="toc_4">2ã€ä¿®æ”¹config.m4é…ç½®</h3>

<p><a href="mweblib://15629867837001">config.m4è¯¦è§£</a><br/>
<a href="https://www.php.net/manual/zh/internals2.buildsys.configunix.php">PHPå®˜ç½‘</a></p>

<p>ä»¥ä¸‹ä¸ºPHPå®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„config.m4æ ·ä¾‹</p>

<pre><code class="language-m4">dnl $Id$
dnl config.m4 for extension example
PHP_ARG_WITH(example, for example support,
[  --with-example[=FILE]       Include example support. File is the optional path to example-config])
PHP_ARG_ENABLE(example-debug, whether to enable debugging support in example,
[  --enable-example-debug        example: Enable debugging support in example], no, no)
PHP_ARG_WITH(example-extra, for extra libraries for example,
[  --with-example-extra=DIR      example: Location of extra libraries for example], no, no)

dnl æ£€æµ‹æ‰©å±•æ˜¯å¦å·²å¯ç”¨
if test &quot;$PHP_EXAMPLE&quot; != &quot;no&quot;; then
  
  dnl æ£€æµ‹ example-configã€‚é¦–å…ˆå°è¯•æ‰€ç»™å‡ºçš„è·¯å¾„ï¼Œç„¶ååœ¨ $PATH ä¸­å¯»æ‰¾
  AC_MSG_CHECKING([for example-config])
  EXAMPLE_CONFIG=&quot;example-config&quot;
  if test &quot;$PHP_EXAMPLE&quot; != &quot;yes&quot;; then
    EXAMPLE_PATH=$PHP_EXAMPLE
  else
    EXAMPLE_PATH=`$php_shtool path $EXAMPLE_CONFIG`
  fi
  
  dnl å¦‚æœæ‰¾åˆ°å¯ç”¨çš„ example-configï¼Œå°±ä½¿ç”¨å®ƒï¼ˆæ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ˜¯å¦å¯æ‰§è¡Œä»¥åŠæ‰§è¡Œçš„ç»“æœï¼‰
  if test -f &quot;$EXAMPLE_PATH&quot; &amp;&amp; test -x &quot;$EXAMPLE_PATH&quot; &amp;&amp; $EXAMPLE_PATH --version &gt; /dev/null 2&gt;&amp;1; then
    AC_MSG_RESULT([$EXAMPLE_PATH]) dnl ç»“æŸcheckï¼Œç»§ç»­æ‰§è¡Œ
    EXAMPLE_LIB_NAME=`$EXAMPLE_PATH --libname`
    EXAMPLE_INCDIRS=`$EXAMPLE_PATH --incdirs`
    EXAMPLE_LIBS=`$EXAMPLE_PATH --libs`
    
    dnl æ£€æµ‹æ‰©å±•åº“æ˜¯å¦å·¥ä½œæ­£å¸¸
    dnl PHP_CHECK_LIBRARY() å°è¯•ç¼–è¯‘ã€é“¾æ¥å’Œæ‰§è¡Œç¨‹åºï¼Œ
    dnl åœ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„åº“ä¸­è°ƒç”¨ç”±ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç¬¦å·ï¼Œä½¿ç”¨ç¬¬äº”ä¸ªå‚æ•°ç»™å‡ºçš„å­—ç¬¦ä¸²ä½œä¸ºé¢å¤–çš„é“¾æ¥é€‰é¡¹ã€‚
    dnl å¦‚æœå°è¯•æˆåŠŸäº†ï¼Œåˆ™è¿è¡Œç¬¬ä¸‰ä¸ªå‚æ•°æ‰€ç»™å‡ºçš„è„šæœ¬ã€‚æ­¤è„šæœ¬ä» example-config æ‰€æä¾›çš„åŸå§‹çš„é€‰é¡¹å­—ç¬¦ä¸²ä¸­å–å‡ºå¤´æ–‡ä»¶è·¯å¾„ã€åº“æ–‡ä»¶è·¯å¾„å’Œåº“åç§°ï¼Œå‘Šè¯‰ PHP æ„å»ºç³»ç»Ÿã€‚
    dnl å¦‚æœå°è¯•å¤±è´¥ï¼Œè„šæœ¬åˆ™è¿è¡Œç¬¬å››ä¸ªå‚æ•°ä¸­çš„è„šæœ¬ã€‚æ­¤æ—¶è°ƒç”¨ AC_MSG_ERROR() æ¥ä¸­æ–­ç¨‹åºæ‰§è¡Œã€‚
    PHP_CHECK_LIBRARY($EXAMPLE_LIB_NAME, example_critical_function,
    [
      dnl æ·»åŠ æ‰€éœ€çš„ include ç›®å½•
      PHP_EVAL_INCLINE($EXAMPLE_INCDIRS)
      dnl æ·»åŠ æ‰€éœ€çš„æ‰©å±•åº“åŠæ‰©å±•åº“æ‰€åœ¨ç›®å½•
      PHP_EVAL_LIBLINE($EXAMPLE_LIBS, EXAMPLE_SHARED_LIBADD)
    ],[
      dnl è·³å‡º
      AC_MSG_ERROR([example library not found. Check config.log for more information.])
    ],[$EXAMPLE_LIBS]
    )
  else
    dnl æ²¡æœ‰å¯ç”¨çš„ example-configï¼Œè·³å‡º
    AC_MSG_RESULT([not found])   dnl ç»“æŸcheck
    AC_MSG_ERROR([Please check your example installation.]) dnl æŠ¥é”™
  fi
  
  dnl æ£€æµ‹æ˜¯å¦å¯ç”¨è°ƒè¯•
  if test &quot;$PHP_EXAMPLE_DEBUG&quot; != &quot;no&quot;; then
    dnl æ˜¯ï¼Œåˆ™è®¾ç½® C è¯­è¨€å®æŒ‡ä»¤
    AC_DEFINE(USE_EXAMPLE_DEBUG,1,[Include debugging support in example])
  fi
  
  dnl æ£€æµ‹é¢å¤–çš„æ”¯æŒ
  if test &quot;$PHP_EXAMPLE_EXTRA&quot; != &quot;no&quot;; then
    if test &quot;$PHP_EXAMPLE_EXTRA&quot; == &quot;yes&quot;; then
      AC_MSG_ERROR([You must specify a path when using --with-example-extra])
    fi
    
    PHP_CHECK_LIBRARY(example-extra, example_critical_extra_function,
    [
      dnl æ·»åŠ æ‰€éœ€è·¯å¾„
      PHP_ADD_INCLUDE($PHP_EXAMPLE_EXTRA/include)
      PHP_ADD_LIBRARY_WITH_PATH(example-extra, $PHP_EXAMPLE_EXTRA/lib, EXAMPLE_SHARED_LIBADD)
      AC_DEFINE(HAVE_EXAMPLEEXTRALIB,1,[Whether example-extra support is present and requested])
      EXAMPLE_SOURCES=&quot;$EXAMPLE_SOURCES example_extra.c&quot;
    ],[
      AC_MSG_ERROR([example-extra lib not found. See config.log for more information.])
    ],[-L$PHP_EXAMPLE_EXTRA/lib]
    )
  fi
  
  dnl æœ€åï¼Œå°†æ‰©å±•åŠå…¶æ‰€éœ€æ–‡ä»¶ç­‰ä¿¡æ¯ä¼ ç»™æ„å»ºç³»ç»Ÿ
  dnl PHP_NEW_EXTENSION
  dnl ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰©å±•çš„åç§°ï¼Œå’ŒåŒ…å«å®ƒçš„ç›®å½•åŒåã€‚
  dnl ç¬¬äºŒä¸ªå‚æ•°æ˜¯åšä¸ºæ‰©å±•çš„ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æºæ–‡ä»¶çš„åˆ—è¡¨ã€‚å‚è§ PHP_ADD_BUILD_DIR() ä»¥è·å–å°†åœ¨å­ç›®å½•ä¸­æºæ–‡ä»¶æ·»åŠ åˆ°æ„å»ºè¿‡ç¨‹çš„ç›¸å…³ä¿¡æ¯ã€‚
  dnl ç¬¬ä¸‰ä¸ªå‚æ•°æ€»æ˜¯ $ext_sharedï¼Œ å½“ä¸ºäº† --with-example[=FILE] è€Œè°ƒç”¨ PHP_ARG_WITH()æ—¶ï¼Œç”± configure å†³å®šå‚æ•°çš„å€¼ã€‚
  dnl ç¬¬å››ä¸ªå‚æ•°æŒ‡å®šä¸€ä¸ªâ€œSAPI ç±»â€ï¼Œä»…ç”¨äºä¸“é—¨éœ€è¦ CGI æˆ– CLI SAPI çš„æ‰©å±•ã€‚å…¶ä»–æƒ…å†µä¸‹åº”ç•™ç©ºã€‚
  dnl ç¬¬äº”ä¸ªå‚æ•°æŒ‡å®šäº†æ„å»ºæ—¶è¦åŠ å…¥ CFLAGS çš„æ ‡å¿—åˆ—è¡¨ã€‚
  dnl ç¬¬å…­ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œä¸º &quot;yes&quot; æ—¶ä¼šå¼ºè¿«æ•´ä¸ªæ‰©å±•ä½¿ç”¨ $CXX ä»£æ›¿ $CC æ¥æ„å»ºã€‚
  dnl ç¬¬ä¸‰ä¸ªä»¥åçš„æ‰€æœ‰å‚æ•°éƒ½æ˜¯å¯é€‰çš„ã€‚
  PHP_NEW_EXTENSION(example, example.c $EXAMPLE_SOURCES, $ext_shared)
  dnl PHP_SUBST() æ¥å¯ç”¨æ‰©å±•çš„å…±äº«æ„å»º
  PHP_SUBST(EXAMPLE_SHARED_LIBADD)
fi

</code></pre>

<h3 id="toc_5">3ã€ç¼–å†™æ‰©å±•çš„åŠŸèƒ½</h3>

<p>åœ¨TestExtension.cæ–‡ä»¶ä¸­ç¼–å†™æ‰©å±•å®ç°çš„å…·ä½“åŠŸèƒ½ã€‚</p>

<h2 id="toc_6">ç¼–è¯‘å®‰è£…æ‰©å±•çš„æ­¥éª¤</h2>

<h3 id="toc_7">1ã€ä½¿ç”¨phpizeè§£æconfig.m4ï¼Œç”ŸæˆconfigureåŠå…¶ä»–é…ç½®æ–‡ä»¶</h3>

<p>å½“ä»£ç é‡è¾ƒå°‘ï¼Œç»“æ„ç®€å•çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šæ‰‹åŠ¨ç¼–å†™Makefileæ–‡ä»¶ï¼Œä½†æ˜¯åœ¨å¤§å‹é¡¹ç›®ä¸­ç¼–å†™Makefileæ˜¯å¾ˆéš¾çš„ï¼Œäºæ˜¯å‡ºç°äº†autoconf/automake/autoheader/autolocalç­‰ä¸€ç³»åˆ—ç”¨äºç”Ÿæˆconfigureçš„è‡ªåŠ¨åŒ–å·¥å…·ã€‚    </p>

<p>è€Œphpizeå°±æ˜¯ä¸€æ¬¾æ“ä½œè¿™ä¸€ç³»åˆ—å¤æ‚å·¥å…·çš„è„šæœ¬ï¼Œå®ƒä¼šè¯»å–å¹¶è§£æconfig.m4æ–‡ä»¶ï¼Œå¹¶ä»¥æ­¤ç”ŸæˆconfigureåŠå…¶ä»–æ–‡ä»¶ã€‚    </p>

<p>ä½¿ç”¨æ–¹å¼ï¼š    </p>

<blockquote>
<p>åœ¨å¾…ç¼–è¯‘çš„æ‰©å±•ç›®å½•ä½¿ç”¨ phpize å³å¯ï¼Œå¦‚ï¼š</p>

<pre><code class="language-text">$ phpize
Configuring for:
PHP Api Version:        
Zend Module Api No:     
Zend Extension Api No:
</code></pre>
</blockquote>

<h3 id="toc_8">2ã€ç¼–è¯‘å®‰è£…</h3>

<p>ä½¿ç”¨ä¸Šä¸€æ­¥ç”Ÿæˆçš„configureæ–‡ä»¶æ£€æµ‹å®‰è£…å¹³å°çš„ç‰¹å¾ï¼š    </p>

<pre><code class="language-bash">./configure
</code></pre>

<p>ä½ å¯ä»¥åŠ ä¸Šä¸€äº›å‚æ•°ï¼Œä¾‹å¦‚ï¼š    </p>

<pre><code class="language-bash">./configure --with-php-config=php-config_path   
// php-configæ˜¯åœ¨PHPå®‰è£…æ—¶ä¿å­˜PHPå®‰è£…ä¿¡æ¯çš„è„šæœ¬ï¼ŒæŒ‡å®šphp-configæ›´å¥½
</code></pre>

<p>æœ€åï¼Œä½¿ç”¨makeã€make installå‘½ä»¤å®Œæˆæ‰©å±•çš„å®‰è£…ã€‚</p>

<p><em>Mission Complete!</em></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Git Flowä¸git-flowçš„ä»‹ç»]]></title>
    <link href="https://anhoder.github.io/15981624548765.html"/>
    <updated>2020-08-23T14:00:54+08:00</updated>
    <id>https://anhoder.github.io/15981624548765.html</id>
    <content type="html"><![CDATA[
<p>å‰ä¸¤å¤©åœ¨é¢è¯•ä¸­ï¼Œé‡åˆ°GitFlowçš„é—®é¢˜ï¼Œæ¶‰åŠåˆ°çŸ¥è¯†ç›²åŒºï¼Œä»Šå¤©è¶æœ‰ç©ºå­¦ä¹ ä¸€ä¸‹ã€‚</p>

<span id="more"></span><!-- more -->

<p><em>Mission Start!</em></p>

<h2 id="toc_0">ä»€ä¹ˆæ˜¯Git Flow</h2>

<p>Git Flowæ˜¯2010å¹´ç”±<a href="https://nvie.com/about/">Vincent Driessen</a>æå‡ºçš„åœ¨è¿›è¡Œäº§å“å¼€å‘æ—¶Gitçš„è¡Œä¸ºè§„èŒƒï¼ˆ<a href="https://nvie.com/posts/a-successful-git-branching-model/">åŸæ–‡é“¾æ¥</a>ï¼‰ã€‚ç±»ä¼¼çš„è§„èŒƒè¿˜æœ‰Github Flowã€Gitlab Flowã€‚</p>

<h2 id="toc_1">Git Flowçš„åˆ†æ”¯</h2>

<p>Git Flowä¸­å®šä¹‰äº†ä¸¤ç±»åˆ†æ”¯ï¼šä¸»åˆ†æ”¯ã€è¾…åŠ©åˆ†æ”¯ã€‚</p>

<blockquote>
<p>ä¸»åˆ†æ”¯ç”¨äºç»„ç»‡ä¸è½¯ä»¶å¼€å‘ã€éƒ¨ç½²ç›¸å…³çš„æ´»åŠ¨ã€‚ä¸»åˆ†æ”¯æ˜¯æ‰€æœ‰å¼€å‘æ´»åŠ¨çš„æ ¸å¿ƒåˆ†æ”¯ï¼Œå¯åˆ†ä¸º<code>masteråˆ†æ”¯</code>ã€<code>developåˆ†æ”¯</code>ã€‚</p>

<p>è¾…åŠ©åˆ†æ”¯æ˜¯ä¸ºäº†è§£å†³ç‰¹å®šçš„é—®é¢˜è€Œè¿›è¡Œçš„å„ç§å¼€å‘æ´»åŠ¨ã€‚è¾…åŠ©åˆ†æ”¯æœ‰<code>featureåˆ†æ”¯</code>ã€<code>releaseåˆ†æ”¯</code>ã€<code>hotfixåˆ†æ”¯</code>ã€‚</p>
</blockquote>

<h3 id="toc_2">masteråˆ†æ”¯</h3>

<p>masteråˆ†æ”¯ç”¨äºå­˜æ”¾å¯ä¸Šçº¿çš„ç¨³å®šä»£ç ã€‚</p>

<ul>
<li>æ¥æºï¼š<code>releaseåˆ†æ”¯</code>ã€<code>hotfixåˆ†æ”¯</code></li>
<li>å»å‘ï¼šæ— </li>
</ul>

<h3 id="toc_3">developåˆ†æ”¯</h3>

<p>develop åˆ†æ”¯æ˜¯å¼€å‘çš„åŸºç¡€åˆ†æ”¯ï¼Œå½“éœ€è¦å¢åŠ åŠŸèƒ½æ—¶å¯ä»¥ä»è¯¥åˆ†æ”¯åˆ‡å‡ºä¸€ä¸ª feature åˆ†æ”¯ã€‚</p>

<ul>
<li>æ¥æºï¼š<code>featureåˆ†æ”¯</code>ã€<code>releaseåˆ†æ”¯</code>ã€<code>hotfixåˆ†æ”¯</code></li>
<li>å»å‘ï¼š<code>releaseåˆ†æ”¯</code></li>
</ul>

<h3 id="toc_4">featureåˆ†æ”¯</h3>

<p>å½“éœ€è¦å¢åŠ æ–°åŠŸèƒ½æ—¶ï¼Œä½¿ç”¨ feature åˆ†æ”¯ã€‚feature åˆ†æ”¯ä» develop åˆ†æ”¯åˆ‡å‡ºï¼Œå®Œæˆæ—¶ä¹Ÿè¦åˆå¹¶åˆ° develop åˆ†æ”¯ã€‚</p>

<ul>
<li>æ¥æºï¼š<code>developåˆ†æ”¯</code></li>
<li>å»å‘ï¼š<code>developåˆ†æ”¯</code></li>
</ul>

<h3 id="toc_5">releaseåˆ†æ”¯</h3>

<p>release åˆ†æ”¯æ˜¯å‘å¸ƒåˆ° master åˆ†æ”¯å‰çš„ç‰ˆæœ¬ã€‚å¯ä»¥æŠŠå·²å®Œæˆçš„ develop åˆ†æ”¯åˆå¹¶åˆ° release åˆ†æ”¯ï¼Œåœ¨è¯¥åˆ†æ”¯ä¸Šåšæœ€åçš„æµ‹è¯•ã€‚æµ‹è¯•é€šè¿‡å³å¯å®Œæˆ release åˆ†æ”¯ï¼Œå®Œæˆæ—¶ä¼šå°† release åˆå¹¶åˆ° master ä»¥åŠ develop ä¸¤ä¸ªåˆ†æ”¯ä¸Šã€‚åˆå¹¶åˆ° develop åˆ†æ”¯æ˜¯å› ä¸ºåœ¨ Release åˆ†æ”¯ä¸Šå¯èƒ½ä¼šæœ‰ä»£ç ä¿®æ”¹ï¼Œéœ€è¦å°†ä¿®æ”¹åŒæ­¥åˆ° develop åˆ†æ”¯ä¸Šã€‚</p>

<ul>
<li>æ¥æºï¼š<code>developåˆ†æ”¯</code></li>
<li>å»å‘ï¼š<code>masteråˆ†æ”¯</code>ã€<code>developåˆ†æ”¯</code></li>
</ul>

<blockquote>
<p>å¸¸ç”¨å‘½åï¼šrelease-*</p>
</blockquote>

<h3 id="toc_6">hotfixåˆ†æ”¯</h3>

<p>å½“çº¿ä¸Šäº§å“äº§ç”ŸBugæ—¶ï¼Œä» master åˆ†æ”¯å¼€ä¸€ä¸ª hotfix åˆ†æ”¯ç”¨äºä¿®å¤ï¼Œä¿®å¤å®Œæˆåä¼šåˆå¹¶åˆ° masterã€develop åˆ†æ”¯ã€‚</p>

<ul>
<li>æ¥æºï¼š<code>masteråˆ†æ”¯</code></li>
<li>å»å‘ï¼š<code>masteråˆ†æ”¯</code>ã€<code>developåˆ†æ”¯</code></li>
</ul>

<blockquote>
<p>å¸¸ç”¨å‘½åï¼šhotfix-*</p>
</blockquote>

<h2 id="toc_7">æ€»ç»“</h2>

<p>ä»¥ä¸Šåˆ†æ”¯çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå¼•ç”¨è‡ª<a href="https://segmentfault.com/a/1190000006194051">Git Flowç®€ä»‹</a>ï¼‰ï¼š</p>

<p><img src="media/15981624548765/3652838737-57a69c4ba2103_articlex.png" alt="Git Flowåˆ†æ”¯"/></p>

<h2 id="toc_8">git-flow</h2>

<p>git-flowæ˜¯é…åˆGit Flowå·¥ä½œæµç¨‹ä½¿ç”¨çš„ä¸€ä¸ªGitæ‰©å±•ã€‚å¯ä»¥ç®€åŒ–Git Flowçš„æ“ä½œã€‚</p>

<h3 id="toc_9">å®‰è£…</h3>

<p><strong>Mac OSX</strong></p>

<pre><code class="language-bash">brew install git-flow
</code></pre>

<p><strong>Debian/Ubuntu Linux</strong></p>

<pre><code class="language-bash">apt-get install git-flow
</code></pre>

<p><strong>Windowsæ­é…Cygwin</strong></p>

<pre><code class="language-bash">wget -q -O - --no-check-certificate https://github.com/nvie/gitflow/raw/develop/contrib/gitflow-installer.sh | bash
</code></pre>

<h3 id="toc_10">åˆå§‹åŒ–</h3>

<pre><code class="language-bash">git flow init
</code></pre>

<h3 id="toc_11">feature</h3>

<ul>
<li>æ–°å»ºfeatureåˆ†æ”¯</li>
</ul>

<pre><code class="language-bash">git flow feature start FeatureName
</code></pre>

<ul>
<li>ç»“æŸfeatureåˆ†æ”¯ï¼ˆå°†å½“å‰featureåˆ†æ”¯åˆå¹¶åˆ°developï¼›åˆ é™¤å½“å‰åˆ†æ”¯ï¼›å¹¶åˆ‡æ¢åˆ°developåˆ†æ”¯ï¼‰</li>
</ul>

<pre><code class="language-bash">git flow feature finish FeatureName
</code></pre>

<ul>
<li>å…¬å¸ƒfeatureåˆ†æ”¯ï¼ˆå½“éœ€è¦ä¸åŒä¼´ä¸€èµ·å¼€å‘æ—¶ï¼Œå°†featureåˆ†æ”¯å…¬å¸ƒåˆ°æœåŠ¡å™¨ä¸Šï¼‰</li>
</ul>

<pre><code class="language-bash">git flow feature publish FeatureName
</code></pre>

<ul>
<li>ä»æœåŠ¡å™¨ä¸Šè·å–ä¸€ä¸ªåˆ«äººå…¬å¸ƒçš„featureåˆ†æ”¯</li>
</ul>

<pre><code class="language-bash">git flow feature pull origin FeatureName
</code></pre>

<h3 id="toc_12">release</h3>

<ul>
<li>åˆ›å»ºä¸€ä¸ªreleaseåˆ†æ”¯</li>
</ul>

<pre><code class="language-bash">git flow release start ReleaseName
</code></pre>

<ul>
<li>å…¬å¸ƒä¸€ä¸ªreleaseåˆ†æ”¯</li>
</ul>

<pre><code class="language-bash">git flow release publish ReleaseName
</code></pre>

<ul>
<li>ç»“æŸä¸€ä¸ªreleaseåˆ†æ”¯ï¼ˆæŠŠreleaseåˆ†æ”¯åˆå¹¶å›masterï¼Œç»™æœ¬æ¬¡å‘å¸ƒæ‰“tagï¼›æŠŠreleaseåˆå¹¶å›developï¼›åˆ é™¤releaseåˆ†æ”¯ï¼‰</li>
</ul>

<pre><code class="language-bash">git flow release finish ReleaseName
// æœ€åä¸è¦å¿˜è®°æŠŠtag pushåˆ°æœåŠ¡å™¨ï¼šgit push --tags
</code></pre>

<h3 id="toc_13">hotfix</h3>

<ul>
<li>åˆ›å»ºä¸€ä¸ªhotfixåˆ†æ”¯</li>
</ul>

<pre><code class="language-bash">git flow hotfix start HotfixName
</code></pre>

<ul>
<li>ç»“æŸä¸€ä¸ªhotfixåˆ†æ”¯ï¼ˆåˆå¹¶åˆ°developã€masteråˆ†æ”¯ï¼Œå¹¶åˆ é™¤hotfixåˆ†æ”¯ï¼‰</li>
</ul>

<pre><code class="language-bash">git flow hotfix finish HotfixName
</code></pre>

<p><em>Mission Complete!</em></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Gitè¡¥å‘]]></title>
    <link href="https://anhoder.github.io/15981624548821.html"/>
    <updated>2020-08-23T14:00:54+08:00</updated>
    <id>https://anhoder.github.io/15981624548821.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<p>è¿™æ®µæ—¶é—´ä¸€ç›´å¿™ç€å†™ä½œä¸šå’Œè®ºæ–‡ï¼Œå¿ƒåŠ›äº¤ç˜ï¼Œä»Šå¤©çªç„¶å‘ç°å¥½ä¹…æ²¡å†™åšå®¢äº†ï¼ˆå¿ƒç—›çš„æ„Ÿè§‰QAQï¼‰ï¼Œæ‰€ä»¥æ¥ç»™ç½‘ç«™æ“¦æ“¦ç°ã€‚ã€‚</p>

<p><em>Mission Start!</em></p>

<p>å…¶å®ä»¥å‰æ˜¯å¾ˆè€å¿ƒå­¦è¿‡Gitçš„ï¼Œåªæ˜¯æ²¡æœ‰å†™åšå®¢è®°å½•ç›¸å…³å†…å®¹ï¼Œç°åœ¨æ¥è¡¥ä¸Šè¿™ä¸ªå‘ :)   </p>

<p><span style="color:red;"><strong>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šGitåªèƒ½è·Ÿè¸ªæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹å˜åŒ–ï¼Œè€Œä¸èƒ½è·Ÿè¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„å†…å®¹å˜åŒ–ï¼ˆåŒ…æ‹¬Wordæ–‡æ¡£ï¼‰</strong></span></p>

<h2 id="toc_0">ä¸€ã€å®‰è£…Git</h2>

<blockquote>
<h3 id="toc_1">Windows</h3>

<p>åœ¨Windowsä¸‹ï¼Œå¯ä»¥åœ¨<a href="https://git-scm.com/downloads">å®˜ç½‘</a>ä¸Šä¸‹è½½Windowsçš„å®‰è£…ç¨‹åºè¿›è¡Œå®‰è£…ï¼Œå®‰è£…å®Œæˆæ‰“å¼€Git Bashå³å¯ã€‚</p>

<h3 id="toc_2">Mac</h3>

<p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šä½¿ç”¨Homebrewè¿›è¡Œå®‰è£…ï¼ˆå¦‚æœå·²ç»å®‰è£…äº†<a href="https://brew.sh/index_zh-cn">Homebrew</a>çš„è¯ï¼‰ï¼Œä½¿ç”¨å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p>

<pre><code class="language-bash">brew install git
</code></pre>

<p>ç¬¬äºŒç§æ–¹æ³•ï¼šå®‰è£…Xcodeï¼ŒXcodeé›†æˆäº†Gitï¼Œä½†æ˜¯é»˜è®¤æœªå®‰è£…ï¼Œä½ å¯ä»¥åœ¨Xcodeçš„Preferences-&gt;Downloadä¸­å®‰è£…Command Line Toolsã€‚</p>

<h3 id="toc_3">Linux</h3>

<p>Linuxä¸åŒçš„å‘è¡Œç‰ˆæœ‰ä¸åŒçš„å®‰è£…æ–¹å¼ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p>

<pre><code class="language-bash">sudo apt-get install git
</code></pre>

<p>æˆ–è€…</p>

<pre><code class="language-bash">sudo yum install git
</code></pre>
</blockquote>

<p>å®‰è£…å®Œæˆåï¼Œä½¿ç”¨</p>

<pre><code class="language-bash">git config --global user.name &quot;Your Name&quot;
git config --global user.email &quot;user@example.com&quot;
</code></pre>

<p>é…ç½®ç”¨æˆ·åå’Œé‚®ç®±ã€‚</p>

<h2 id="toc_4">äºŒã€Gitç›¸å…³æ“ä½œ</h2>

<h3 id="toc_5">1.åˆ›å»ºç‰ˆæœ¬åº“(ä»“åº“ï¼ŒRepository)</h3>

<pre><code class="language-bash">$ mkdir Test  
$ cd Test
$ git init    // åˆ›å»ºä»“åº“
Initialized empty Git repository in /Volumes/åŠå…¬/Alan/Test/.git/
</code></pre>

<p>OK, ä»“åº“å·²ç»å»ºå¥½ï¼ŒGitä¼šåœ¨è¯¥ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªç›®å½•.gitï¼ˆ.å¼€å¤´ä¸ºéšè—ç›®å½•ï¼‰ï¼Œå…¶ç”¨äºè·Ÿè¸ªç®¡ç†è¿™ä¸ªä»“åº“ã€‚   </p>

<p>å¦‚æœä½¿ç”¨çš„æ˜¯æŸäº›ç‰¹æ®Šçš„shellï¼Œå½“åˆ‡æ¢åˆ°è¯¥ç›®å½•æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°æ˜æ˜¾çš„å˜åŒ–ï¼Œä¾‹å¦‚æˆ‘ä½¿ç”¨çš„zshï¼Œå½“æ‰§è¡Œgit initåˆ›å»ºå¥½ä»“åº“åï¼Œåˆ‡æ¢åˆ°è¯¥ç›®å½•ä¸‹æ—¶ï¼ˆå³Testï¼‰ï¼Œè·¯å¾„æ˜¾ç¤ºå˜æˆ</p>

<pre><code class="language-bash">Test git:(master) âœ— $
</code></pre>

<h3 id="toc_6">2.æ·»åŠ æ–‡ä»¶åˆ°ç‰ˆæœ¬åº“</h3>

<p>æ·»åŠ æ–‡ä»¶åˆ°ä»“åº“ï¼Œè®©Gitè·Ÿè¸ªè¯¥æ–‡ä»¶ï¼š</p>

<pre><code class="language-bash">$ touch readme.md     // åˆ›å»ºreadme.mdæ–‡ä»¶
$ git add readme.md   // æ·»åŠ readme.mdåˆ°ä»“åº“
$ git add test.php    // æ·»åŠ test.phpåˆ°ä»“åº“
</code></pre>

<h3 id="toc_7">3.æäº¤æ–‡ä»¶åˆ°ç‰ˆæœ¬åº“</h3>

<pre><code class="language-bash">$ git commit -m &quot;add readme.me test.php&quot; // æäº¤åˆ°ä»“åº“ï¼ˆ-må‚æ•°æ˜¯æäº¤çš„ç›¸å…³è¯´æ˜ï¼Œæ·»åŠ æäº¤è¯´æ˜è‡³å…³é‡è¦ï¼‰
</code></pre>

<p>å¯å¤šæ¬¡ä½¿ç”¨git addæ·»åŠ å¤šä¸ªæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨git commitä¸€æ¬¡è¿›è¡Œæäº¤ã€‚æ¯æ¬¡çš„git commitéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ã€‚</p>

<h3 id="toc_8">4.æŸ¥çœ‹æäº¤æ—¥å¿—</h3>

<pre><code class="language-bash">$ git log
</code></pre>

<p>æ˜¾ç¤ºç»“æœä¸ºï¼š</p>

<pre><code class="language-bash">commit bc916412b5b6ca835a21c72a530598db3ae38fb0 (HEAD -&gt; master)
Author: AlanAlbert &lt;1766447919@qq.com&gt;
Date:   Thu Jun 21 09:27:42 2018 +0800

    upload Sort

commit ee45db03f09b212562520be5c1a4e1d853064a2e
Author: AlanAlbert &lt;1766447919@qq.com&gt;
Date:   Thu Jun 21 09:17:41 2018 +0800

    upload readme.md test.php
</code></pre>

<p>git logä¼šæ ¹æ®æ—¶é—´å€’åºæ˜¾ç¤ºæ¯æ¡æäº¤è®°å½•ï¼ŒåŒ…æ‹¬æäº¤è€…ã€æäº¤æ—¶é—´ä»¥åŠæäº¤è¯´æ˜ï¼Œä¹Ÿå¯ä»¥ç»™git logåŠ ä¸Šå‚æ•°--pretty=onelineè®©å…¶åªæ˜¾ç¤ºä¸€è¡Œï¼ŒåªåŒ…æ‹¬æäº¤è¯´æ˜ï¼š</p>

<pre><code class="language-bash">bc916412b5b6ca835a21c72a530598db3ae38fb0 (HEAD -&gt; master) upload Sort
ee45db03f09b212562520be5c1a4e1d853064a2e upload readme.md test.php
</code></pre>

<p>ä¸Šé¢ä¸¤æ¬¡éƒ½å‡ºç°çš„å¾ˆé•¿ä¸€ä¸²çš„å­—ç¬¦ä¸²æ˜¯æ¯æ¬¡æäº¤çš„idï¼Œå…¶é€šè¿‡SHA1è®¡ç®—å‡ºæ¥çš„åå…­è¿›åˆ¶æ•°å­—ï¼Œä¿è¯å”¯ä¸€æ€§ã€‚</p>

<h3 id="toc_9">5.é‡ç½®ç‰ˆæœ¬</h3>

<p>å½“å‰ç‰ˆæœ¬å¯ä»¥åœ¨git logçš„ç»“æœä¸­çœ‹åˆ°ï¼Œå…¶ç”¨HEADæŒ‡å‘å½“å‰ç‰ˆæœ¬ã€‚ä¸Šä¸€ä¸ªç‰ˆæœ¬åˆ™ä¸º<code>HEAD^</code>ï¼Œä¸Šä¸Šä¸ªç‰ˆæœ¬ä¸º<code>HEAD^^</code>ï¼Œä¸Š5ä¸ªç‰ˆæœ¬å¯ä»¥è¡¨ç¤ºä¸º<code>HEAD~5</code>ã€‚é‡ç½®åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸ºï¼š</p>

<pre><code class="language-bash">$ git reset --hard HEAD^
HEAD is now at ee45db0 upload readme.md test.php
</code></pre>

<p>ä½¿ç”¨git log --pretty=onelineæ˜¾ç¤ºç»“æœï¼š</p>

<pre><code class="language-bash">ee45db03f09b212562520be5c1a4e1d853064a2e (HEAD -&gt; master) upload readme.md test.php
</code></pre>

<p>å¯è§HEADæŒ‡å‘äº†ä¸Šä¸€ä¸ªcommitç‰ˆæœ¬ã€‚</p>

<blockquote>
<p>git resetå‘½ä»¤å°†HEADæŒ‡å‘å¦ä¸€ä¸ªcommitç‰ˆæœ¬ï¼Œå¹¶å°†å·¥ä½œç›®å½•è¿›è¡Œæ›´æ–°ã€‚</p>

<p>é‚£ä¹ˆ--hardå‚æ•°æ˜¯å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿgit resetçš„å‚æ•°æœ‰ä¸‰ä¸ªï¼š--softã€--hardã€--mixedï¼Œé»˜è®¤ä¸ºmixedã€‚</p>

<p>â‘  <strong>--soft</strong>: HEADæŒ‡å‘å¦ä¸€ä¸ªcommitç‰ˆæœ¬ï¼Œè€Œå·¥ä½œåŒºå’Œæš‚å­˜åŒºä¸å‘ç”Ÿå˜åŒ–ã€‚å³ï¼Œå°†HEADå¤´æŒ‡é’ˆæ¢å¤ï¼Œè€Œaddçš„ç¼“å­˜å’Œå·¥ä½œåŒºçš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¸å˜ã€‚</p>

<p>â‘¡ <strong>--mixed</strong>: HEADçš„æŒ‡å‘ã€æš‚å­˜åŒºéƒ½å‘ç”Ÿå˜åŒ–ï¼Œå·¥ä½œåŒºä¸å‘ç”Ÿå˜åŒ–ã€‚å³ï¼Œå°†HEADå¤´æŒ‡é’ˆæ¢å¤ï¼Œaddçš„ç¼“å­˜ä¹Ÿä¼šä¸¢å¤±ï¼Œä½†å·¥ä½œåŒºæ–‡ä»¶ä¸å˜ã€‚</p>

<p>â‘¢ <strong>--hard</strong>: HEADçš„æŒ‡å‘ã€æš‚å­˜åŒºã€å·¥ä½œåŒºéƒ½å‘ç”Ÿå˜åŒ–ã€‚å³ï¼ŒHEADå¤´æŒ‡é’ˆæ¢å¤ã€addçš„ç¼“å­˜ä¸¢å¤±ã€å·¥ä½œåŒºçš„ä»£ç ä¿®æ”¹å°†æ¢å¤ã€‚</p>
</blockquote>

<p>åœ¨å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬åï¼Œæœ€æ–°çš„é‚£ä¸ªç‰ˆæœ¬ä¸è§äº†ï¼Œå¦‚æœåˆæƒ³å›åˆ°æœ€æ–°çš„ç‰ˆæœ¬æ€ä¹ˆåŠï¼Ÿ<br/>
åŠæ³•æ˜¯æœ‰çš„ï¼Œåªè¦ä½ çŸ¥é“æœ€æ–°ç‰ˆæœ¬çš„commit idï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>

<pre><code class="language-bash">$ git reset --hard bc91641
HEAD is now at bc91641 upload Sort
</code></pre>

<p>commit idå¹¶ä¸éœ€è¦è¾“å…¥å®Œæ•´ï¼Œåªè¦èƒ½å¤Ÿå”¯ä¸€åŒºåˆ†ç›®æ ‡ç‰ˆæœ¬å³å¯ã€‚</p>

<blockquote>
<p>å¦‚æœå®åœ¨ä¸è®°å¾—ç‰ˆæœ¬çš„idï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è¿›è¡ŒæŸ¥æ‰¾ï¼Œ</p>

<p>ç¬¬ä¸€ç§è¾ƒç®€å•ï¼šä½¿ç”¨å‘½ä»¤git reflogï¼Œç¬¬ä¸€åˆ—æ˜¾ç¤ºå°±æ˜¯ç‰ˆæœ¬id</p>

<p>ç¬¬äºŒç§æ¯”è¾ƒéº»çƒ¦ï¼šåœ¨æ—¥å¿—æ–‡ä»¶.git/logs/refs/heads/masterä¸­æŸ¥çœ‹ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p>

<pre><code class="language-bash">0000000000000000000000000000000000000000 ee45db03f09b212562520be5c1a4e1d853064a2e username &lt;user@example.com&gt; 1529543861 +0800    commit (initial): upload readme.md test.php
ee45db03f09b212562520be5c1a4e1d853064a2e bc916412b5b6ca835a21c72a530598db3ae38fb0 username &lt;user@example.com&gt; 1529544462 +0800    commit: upload Sort
/*ç»“æ„ç»„æˆå¦‚ä¸‹ï¼š
ä¸Šä¸€ä¸ªç‰ˆæœ¬id å½“å‰ç‰ˆæœ¬id ç”¨æˆ·å ç”¨æˆ·é‚®ç®± æ—¶é—´æˆ³ æ—¶åŒº(+0800è¡¨ç¤ºæ­£8æ—¶åŒºï¼ŒåŒ—äº¬æ‰€åœ¨æ—¶åŒº) æ‰§è¡Œçš„æ“ä½œ: æ“ä½œè¯´æ˜
</code></pre>
</blockquote>

<h3 id="toc_10">6.å·¥ä½œåŒº ï¼ˆworking copyï¼‰å’Œæš‚å­˜åŒºï¼ˆstaging copyï¼‰</h3>

<p>å·¥ä½œåŒºä¸ç”¨å¤šè¯´ï¼Œå…¶å°±æ˜¯æˆ‘ä»¬å¯è§çš„ç›®å½•ã€‚<br/>
è€Œåœ¨å·¥ä½œåŒºä¸‹çš„éšè—æ–‡ä»¶å¤¹.gitä¸‹åŒ…å«ä¸€ä¸ªå«åšstageæˆ–indexçš„æš‚å­˜åŒºã€ç¬¬ä¸€ä¸ªåˆ†æ”¯masterä»¥åŠæŒ‡å‘masterçš„æŒ‡é’ˆHEADï¼Œgit addå°±æ˜¯å°†æ–‡ä»¶æ·»åŠ è‡³æš‚å­˜åŒºï¼Œgit commitå°†æš‚å­˜åŒºçš„æ‰€æœ‰å†…å®¹æäº¤åˆ°å½“å‰åˆ†æ”¯ï¼Œæäº¤åæš‚å­˜åŒºçš„å†…å®¹æ¸…ç©ºã€‚   </p>

<h3 id="toc_11">7.æŸ¥çœ‹çŠ¶æ€</h3>

<p>ä½¿ç”¨git statuså¯ä»¥æŸ¥çœ‹çŠ¶æ€ï¼š</p>

<pre><code class="language-bash">$ git status
On branch master
Changes to be committed:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)

  new file:   test1.php
    modified:   test2.php
    
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

    modified:   test3.php

Untracked files:
  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)
  
    test4.php

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</code></pre>

<p>masteråˆ†æ”¯ä¸‹çŠ¶æ€ç»“æœæ˜¾ç¤ºåˆ†ä¸‰ä¸ªçŠ¶æ€ï¼š<br/><br/>
â‘  Changes to be committedè¡¨ç¤ºå·²æ·»åŠ åˆ°æš‚å­˜åŒºä½†æœªæäº¤çš„ä¿®æ”¹<br/><br/>
â‘¡ Changes not staged for commitè¡¨ç¤ºè¢«ä¿®æ”¹ä½†æœªæœªæ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œæ‰§è¡Œgit add filenameåè¯¥ä¿®æ”¹ä¾¿ä¼šå‡ºç°åœ¨çŠ¶æ€â‘  Changes to be committedä¸­ï¼Œå¹¶æ˜¾ç¤ºä¸ºmodified: filename<br/><br/>
â‘¢ Untracked filesè¡¨ç¤ºæœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼Œæ‰§è¡Œgit add filenameåè¯¥æ–‡ä»¶ä¾¿ä¼šå‡ºç°åœ¨çŠ¶æ€â‘  Changes to be committedä¸­ï¼Œå¹¶æ˜¾ç¤ºä¸ºnew file: filename   </p>

<h3 id="toc_12">8.æŸ¥çœ‹å·®å¼‚</h3>

<p>ä½¿ç”¨git diff HEADå¯ä»¥æ˜¾ç¤ºæœ€æ–°æäº¤ç‰ˆæœ¬å’Œå·¥ä½œåŒºçš„å·®å¼‚ï¼š</p>

<pre><code class="language-bash">$ git diff HEAD
diff --git a/test.php b/test.php
index 94fd6d7..46a8d83 100644
--- a/test.php
+++ b/test.php
@@ -1,7 +1,6 @@
 &lt;?php
 /**
- * add line
+ * test line
  */
    
diff --git a/test2.php b/test2.php
index 10d6ee9..4a3f8ca 100644
--- a/test2.php
+++ b/test2.php
@@ -1,6 +1,6 @@
 &lt;?php
-
+// test.line
</code></pre>

<p>å› æ­¤ï¼Œgit diff HEADä¼šæ˜¾ç¤ºå·¥ä½œåŒºå’Œæœ€æ–°ç‰ˆæœ¬ä¹‹é—´æ‰€æœ‰çš„å·®å¼‚ï¼Œå¦‚æœè¦æ£€æŸ¥æŸä¸€ä¸ªæ–‡ä»¶åœ¨å·¥ä½œåŒºå’Œæœ€æ–°æäº¤ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚åˆ™ä½¿ç”¨git diff HEAD -- test.phpï¼š</p>

<pre><code class="language-bash">$git diff HEAD -- test.php
diff --git a/test.php b/test.php
index 94fd6d7..46a8d83 100644
--- a/test.php
+++ b/test.php
@@ -1,7 +1,6 @@
 &lt;?php
 /**
- * add line
+ * test line
  */
</code></pre>

<h3 id="toc_13">9.æ’¤é”€ä¿®æ”¹</h3>

<p>å¯¹å·¥ä½œåŒºè¿›è¡Œä¿®æ”¹åï¼Œå¦‚æœæƒ³è¦æ”¾å¼ƒè¿™æ¬¡çš„ä¿®æ”¹å¯ä»¥ä½¿ç”¨ï¼š</p>

<pre><code class="language-bash">$ git checkout -- test.php
</code></pre>

<p>è¯¥å‘½ä»¤ä¼šè®©å·¥ä½œåŒºçš„æ–‡ä»¶å›åˆ°æœ€è¿‘ä¸€æ¬¡git commitæˆ–git addæ—¶çš„çŠ¶æ€ã€‚</p>

<h3 id="toc_14">10.åˆ é™¤æ–‡ä»¶</h3>

<p>å½“åˆ é™¤å·¥ä½œåŒºçš„æ–‡ä»¶åï¼Œä½¿ç”¨git statusæŸ¥çœ‹çŠ¶æ€ï¼š</p>

<pre><code class="language-bash">$ git status 
Changes not staged for commit:
  (use &quot;git add/rm &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

    deleted:    readme.md
    
</code></pre>

<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ é™¤ç‰ˆæœ¬åº“çš„filenameæ–‡ä»¶ï¼š</p>

<pre><code class="language-bash">$ git rm filename
</code></pre>

<p>ç„¶åä½¿ç”¨git commitå°†ä¿®æ”¹æäº¤åˆ°ç‰ˆæœ¬åº“ã€‚</p>

<h3 id="toc_15">11.æ·»åŠ è¿œç¨‹ä»“åº“</h3>

<p>ä»¥ä½¿ç”¨çš„è¾ƒå¤šçš„GitHubä¸ºä¾‹ã€‚<br/><br/>
é¦–å…ˆï¼Œéœ€è¦åœ¨GitHubä¸Šä¸ºä½ çš„è´¦æˆ·é…ç½®sshå¯†é’¥ï¼Œç¡®ä¿åœ¨ç”µè„‘ä¸Šå¯ä»¥é€šè¿‡GitHubçš„éªŒè¯ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œæˆ–ç»ˆç«¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæµ‹è¯•ï¼š</p>

<pre><code class="language-bash">$ ssh git@github.com
</code></pre>

<p>è‹¥ç»“æœæ˜¾ç¤ºä¸ºï¼š</p>

<pre><code class="language-bash">PTY allocation request failed on channel 0
Hi username! You&#39;ve successfully authenticated, but GitHub does not provide shell access.
Connection to github.com closed.
</code></pre>

<p>åˆ™è¡¨ç¤ºé€šè¿‡GitHubçš„éªŒè¯ï¼›   </p>

<p>ç„¶åï¼Œä½¿ç”¨å‘½ä»¤å…³è”è¿œç¨‹ä»“åº“ï¼š</p>

<pre><code class="language-bash">$ git remote add origin git@github.com:username/test.git 
</code></pre>

<p>å…¶ä¸­ï¼Œoriginä¸ºè¿œç¨‹åº“çš„åå­—ï¼Œç„¶åä½¿ç”¨git pushå°†æœ¬åœ°åº“å†…å®¹æ¨é€åˆ°è¿œç¨‹åº“ï¼š</p>

<pre><code class="language-bash">$ git push -u origin master
</code></pre>

<p>ç¬¬ä¸€æ¬¡æ¨é€æ—¶åŠ ä¸Š-uå‚æ•°ï¼ŒGitä¸ä½†ä¼šæŠŠmasteråˆ†æ”¯å†…å®¹æ¨é€ç»™è¿œç¨‹æ–°çš„masteråˆ†æ”¯ï¼Œè¿˜ä¼šæŠŠæœ¬åœ°masteråˆ†æ”¯å’Œè¿œç¨‹masteråˆ†æ”¯å…³è”èµ·æ¥ã€‚åœ¨ä»¥åå°†æœ¬åœ°å†…å®¹æ¨é€åˆ°è¿œç¨‹ä»“åº“æ—¶ï¼Œåªéœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š</p>

<pre><code class="language-bash">$ git push origin master
</code></pre>

<p>å°†è¿œç¨‹åº“çš„æ›´æ”¹åˆå¹¶è‡³å½“å‰åº“ï¼š</p>

<pre><code class="language-bash">$ git pull origin master:test // è¿œç¨‹masterä¸teståˆ†æ”¯åˆå¹¶
$ git pull origin master // è¿œç¨‹masterå’Œå½“å‰åˆ†æ”¯åˆå¹¶
</code></pre>

<h3 id="toc_16">11.ä»è¿œç¨‹ä»“åº“å…‹éš†</h3>

<p>è¿œç¨‹ä»“åº“çš„å†…å®¹å…‹éš†åˆ°æœ¬åœ°ï¼š</p>

<pre><code class="language-bash">$ git clone git@github.com:username/test.git
</code></pre>

<p>ç„¶åï¼ŒGitå°±ä¼šä¸‹è½½è¿œç¨‹ä»“åº“çš„å†…å®¹åˆ°æœ¬åœ°ã€‚<br/><br/>
Gité»˜è®¤ä½¿ç”¨çš„æ˜¯sshåè®®ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ä½¿ç”¨httpsç­‰åè®®ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-bash">$ git clone https://github.com/username/test.git
</code></pre>

<h3 id="toc_17">12.åˆ†æ”¯ç®¡ç†</h3>

<p>é¦–å…ˆäº†è§£ä¸€ä¸‹åˆ†æ”¯æ˜¯ä»€ä¹ˆï¼Ÿæ¯ä¸ªåˆ†æ”¯éƒ½æ˜¯ä¸€æ¡timeline(æ—¶é—´çº¿)ï¼Œå‰é¢ç”¨åˆ°çš„åˆ†æ”¯å°±æ˜¯masterä¸»åˆ†æ”¯ï¼Œç”¨æˆ·å¯ä»¥åœ¨åˆ†æ”¯ä¸Šå•ç‹¬æ“ä½œäº’ä¸å½±å“ã€‚<br/><br/>
åˆ›å»ºteståˆ†æ”¯ï¼š</p>

<pre><code class="language-bash">$ git branch test
</code></pre>

<p>åˆ‡æ¢åˆ°teståˆ†æ”¯ï¼š</p>

<pre><code class="language-bash">$ git checkout test
Switched to branch &#39;test&#39;
</code></pre>

<p>ä»¥ä¸Šä¸¤æ­¥ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤å®Œæˆï¼š</p>

<pre><code class="language-bash">$ git checkout -b test
</code></pre>

<p>æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆ*å·è¡¨ç¤ºå½“å‰åˆ†æ”¯ï¼‰ï¼š</p>

<pre><code class="language-bash">$ git branch
  master
* test
</code></pre>

<p>åˆå¹¶åˆ†æ”¯ï¼š</p>

<pre><code class="language-bash">$ git checkout master
$ git merge test
Updating 8d8593e..4b01548
Fast-forward
 google.md | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 google.md
</code></pre>

<p>åˆ é™¤åˆ†æ”¯ï¼š</p>

<pre><code class="language-bash">$ git branch -d test
Deleted branch test (was cfc8d84).
</code></pre>

<p>ä¸ºäº†æ›´å¥½çš„ç†è§£Gitçš„åˆ†æ”¯ï¼Œæˆ‘ä»¬åšä¸€ä¸ªå°è¯•éªŒï¼š</p>

<blockquote>
<p>â‘  git initåˆ›å»ºä¸€ä¸ªä»“åº“</p>

<p>â‘¡ åœ¨masteråˆ†æ”¯ä¸­æ–°å»ºreadme.mdï¼Œä½¿ç”¨git addå’Œgit commitæäº¤è‡³ä»“åº“</p>

<p>â‘¢ ä½¿ç”¨git checkout -b test1æ–°å»ºå¹¶åˆ‡æ¢è‡³test1åˆ†æ”¯ï¼Œåœ¨test1åˆ†æ”¯ä¸­æ–°å»ºå¹¶æäº¤test1.md</p>

<p>â‘£ ä½¿ç”¨git checkout -b test2æ–°å»ºå¹¶åˆ‡æ¢è‡³test2åˆ†æ”¯ï¼Œåœ¨test2åˆ†æ”¯ä¸­æ–°å»ºå¹¶æäº¤test2.md</p>

<p>â‘¤ ä½¿ç”¨git checkout masteråˆ‡æ¢è‡³masteråˆ†æ”¯ï¼Œåœ¨masteråˆ†æ”¯ä¸­æ–°å»ºtest.mdæ–‡ä»¶ï¼Œå¹¶æäº¤   </p>

<p>â‘¥ æ­¤æ—¶ï¼Œå„åˆ†æ”¯çŠ¶å†µå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>

<p><img src="https://media.alan123.xyz/imgs/blogs/git/1.png" alt="åˆ†æ”¯çŠ¶å†µ1"/></p>

<p>â‘¦ åœ¨masterã€test1ã€test2åˆ†æ”¯ä¸­åˆ‡æ¢æ—¶ï¼Œå·¥ä½œåŒºçš„æ–‡ä»¶ä¹Ÿä¼šéšä¹‹å˜åŒ–ï¼šåˆ‡æ¢åˆ°masteræ—¶ï¼Œå·¥ä½œåŒºæœ‰readme.mdå’Œtest.mdï¼›åˆ‡æ¢è‡³test1åˆ†æ”¯æ—¶ï¼Œå·¥ä½œåŒºæœ‰readme.mdå’Œtest1.mdï¼›åˆ‡æ¢è‡³test2åˆ†æ”¯æ—¶ï¼Œå·¥ä½œåŒºæœ‰readme.mdå’Œtest2.mdæ–‡ä»¶</p>

<p>â‘§ åˆ‡æ¢è‡³masteråˆ†æ”¯ï¼Œä½¿ç”¨git merge test1 test2å°†test1å’Œtest2åˆ†æ”¯åˆå¹¶è‡³master</p>

<p>â‘¨ æ­¤æ—¶ï¼Œmasteråˆ†æ”¯ä¸‹çš„æ–‡ä»¶åŒ…å«åŸæ¥çš„readme.mdã€test.mdä»¥åŠåŠ å…¥çš„test1.mdã€test2.mdï¼Œè€Œtest1å’Œtest2åˆ†æ”¯æœªå‘ç”Ÿå˜åŒ–</p>

<p>â‘© è¿™æ—¶çš„test1å’Œtest2å¯ä»¥ç”¨git branch -d test1 test2è¿›è¡Œåˆ é™¤ </p>
</blockquote>

<p>é‚£ä¹ˆï¼Œå¦‚æœå­˜åœ¨ä¸¤ä¸ªåˆ†æ”¯masterã€testï¼Œå®ƒä»¬å¯¹åŒä¸€ä¸ªæ–‡ä»¶readme.mdè¿›è¡Œä¿®æ”¹ï¼ˆmasteråœ¨æ–‡ä»¶æœ«å°¾åŠ å…¥master lineï¼Œteståœ¨æ–‡ä»¶æœ«å°¾åŠ å…¥test lineï¼‰ï¼Œè¿™æ—¶ï¼Œå½“å°†teståˆ†æ”¯åˆå¹¶åˆ°masteråˆ†æ”¯æ—¶Gitä¼šæŠ¥é”™ã€‚</p>

<pre><code class="language-bash">$ git merge test
Auto-merging readme.md
CONFLICT (content): Merge conflict in readme.md
Automatic merge failed; fix conflicts and then commit the result.
</code></pre>

<p>ä½¿ç”¨git statusæŸ¥çœ‹çŠ¶æ€ä¹Ÿä¼šæç¤ºæ–‡ä»¶åœ¨ä¸¤ä¸ªåˆ†æ”¯éƒ½ä¿®æ”¹äº†ï¼š</p>

<pre><code class="language-bash">On branch master
Your branch is ahead of &#39;origin/master&#39; by 6 commits.
  (use &quot;git push&quot; to publish your local commits)

You have unmerged paths.
  (fix conflicts and run &quot;git commit&quot;)
  (use &quot;git merge --abort&quot; to abort the merge)

Unmerged paths:
  (use &quot;git add &lt;file&gt;...&quot; to mark resolution)

    both modified:   readme.md

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</code></pre>

<p>æ­¤æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨å¯¹masterä¸»åˆ†æ”¯ä¸‹çš„readme.mdæ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œä½¿ç”¨vim readme.mdæ‰“å¼€æ–‡ä»¶ï¼š</p>

<pre><code class="language-bash">  1 &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
  2 master line
  3 =======
  4 test line
  5 &gt;&gt;&gt;&gt;&gt;&gt;&gt; test
</code></pre>

<p>Gitå°†ä¸¤ä¸ªåˆ†æ”¯çš„readme.mdçš„å†…å®¹ä½¿ç”¨&lt;&lt;&lt;&lt;&lt;&lt;&lt;ã€=======ã€&gt;&gt;&gt;&gt;&gt;&gt;&gt;åŒºåˆ†å¼€æ¥ã€‚å°†å†…å®¹ä¿®æ”¹ä¸ºç›®æ ‡å†…å®¹ï¼Œç„¶ågit addã€git commitå³å¯å®Œæˆåˆå¹¶ã€‚ï¼ˆä½¿ç”¨git log --graphå¯ä»¥æŸ¥çœ‹åˆ†æ”¯åˆå¹¶å›¾ï¼‰</p>

<h3 id="toc_18">13.åˆ†æ”¯ç®¡ç†ç­–ç•¥</h3>

<p>åœ¨åˆå¹¶åˆ†æ”¯æ—¶ï¼Œå¦‚æœä¸æŒ‡å®šåˆå¹¶æ¨¡å¼ï¼ŒGitä¼šé»˜è®¤ä½¿ç”¨Fast forwardæ¨¡å¼ï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œåˆ é™¤åˆ†æ”¯ä¿¡æ¯åï¼Œä¼šä¸¢å¤±åˆ†æ”¯ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥åœ¨åˆå¹¶åˆ†æ”¯æ—¶åŠ ä¸Š--no-ffå‚æ•°ç¦ç”¨Fast forwardæ¨¡å¼ï¼Œæ­¤æ—¶Gitåœ¨åˆå¹¶æ—¶ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„commitï¼š</p>

<pre><code class="language-bash">$ git merge --no-ff -m &#39;merge test&#39; test
</code></pre>

<p>ä½¿ç”¨git log --graph --pretty=onelineåˆ†åˆ«æŸ¥çœ‹ç¦ç”¨Fast forwardå’Œä¸ç¦ç”¨æ—¶çš„åŒºåˆ«ï¼š</p>

<pre><code class="language-bash"># ä¸ç¦ç”¨æ—¶ï¼š
$ git merge test
* 06cf0607846548da37edf16cba68a4b46ba95835 (HEAD -&gt; master) add test.md
* 9ee02e9c78cde794543df93ab508fefb2b7f7667 add readme.md

# ç¦ç”¨æ—¶ï¼š
% git merge --no-ff -m &#39;merge test&#39; test
*   2e6de5d4c6f4c919d63b553615181f51411b3a99 (HEAD -&gt; master) merge test
|\  
| * bbfb8e492523ba516e69813ce7b6b09b7ccd3778 test.md
|/  
* 9ee02e9c78cde794543df93ab508fefb2b7f7667 add readme.md

</code></pre>

<h3 id="toc_19">14.éšè—æ”¹å˜</h3>

<p>å½“æ­£åœ¨ä¸ºä¸€ä¸ªWebåº”ç”¨ç¨‹åºè¿›è¡Œå‡çº§æ—¶ï¼Œçªç„¶å‘ç°å½“å‰ç‰ˆæœ¬çš„ç¨‹åºå­˜åœ¨Bugï¼Œéœ€è¦ä¼˜å…ˆä¿®å¤Bugï¼Œæ­¤æ—¶ï¼Œå‡çº§çš„å·¥ä½œæœªå®Œæˆï¼Œå°šä¸èƒ½commitï¼Œè€Œç”±äºå‡çº§ä¿®æ”¹çš„æ–‡ä»¶ä¼šå½±å“åŸæ¥ç‰ˆæœ¬ï¼Œæ€ä¹ˆåŠï¼Ÿ  </p>

<p>ä½¿ç”¨git stashå‘½ä»¤å³å¯éšè—å·¥ä½œåŒºæœªæäº¤çš„å·¥ä½œï¼ˆå‰æéœ€è¦å°†æ–‡ä»¶æ·»åŠ åˆ°ä»“åº“ï¼Œä½¿å¾—Gitèƒ½å¤Ÿè¿½è¸ªè¿™äº›æ–‡ä»¶ï¼‰ã€‚ä¾‹å¦‚ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºtest.mdæ–‡ä»¶å¹¶æ·»åŠ è‡³ä»“åº“ï¼Œæ­¤æ—¶ä½¿ç”¨</p>

<pre><code class="language-bash">$ git stash
Saved working directory and index state WIP on master: 9ee02e9 add readme.md
</code></pre>

<p>æ­¤æ—¶ï¼Œé‚£äº›æœªä¸Šä¼ çš„æ–‡ä»¶åœ¨å·¥ä½œåŒºæ¶ˆå¤±äº†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ï¼š</p>

<pre><code class="language-bash">$ git stash list
stash@{0}: WIP on master: 9ee02e9 add readme.md
</code></pre>

<p>Gitå°†ç›¸å¯¹äºæœ€è¿‘commitçš„ä¿®æ”¹ä¿å­˜è‡³ä¸€ä¸ªç±»ä¼¼é˜Ÿåˆ—çš„ç»“æ„ä¸­ï¼Œå¯ä»¥å°è¯•åœ¨ä½¿ç”¨git stashåå†æ¬¡æ·»åŠ ä¸€ä¸ªæ–‡ä»¶å¹¶ä½¿ç”¨git stashï¼Œç„¶åä½¿ç”¨git stash listå³å¯æŸ¥çœ‹åˆ°ä¸¤ä¸ªstashã€‚   </p>

<p>éšè—åå¦‚ä½•æ¢å¤å‘¢ï¼Ÿ<br/><br/>
â‘  ä½¿ç”¨git stash applyï¼Œä½¿ç”¨åstashçš„è®°å½•å’Œå†…å®¹ä¸ä¼šåˆ é™¤ï¼Œå¯ä»¥ä½¿ç”¨git stash dropè¿›è¡Œåˆ é™¤ï¼›<br/><br/>
â‘¡ ä½¿ç”¨git stash popå¼¹å‡ºstashï¼Œåœ¨æ¢å¤çš„åŒæ—¶ï¼Œåˆ é™¤stash   </p>

<h3 id="toc_20">15.æ ‡ç­¾ç®¡ç†</h3>

<p>æ·»åŠ æ ‡ç­¾ï¼š</p>

<pre><code class="language-bash">$ git tag v1.0
</code></pre>

<p>Gité»˜è®¤æ˜¯ä¸ºå½“å‰åˆ†æ”¯ä¸‹çš„æœ€æ–°commitç‰ˆæœ¬æ·»åŠ æ ‡ç­¾ï¼Œå¦‚æœæƒ³ä¸ºå†å²æäº¤çš„ç‰ˆæœ¬æ·»åŠ æ ‡ç­¾ï¼Œæ·»åŠ ä¸Šcommit idå³å¯ï¼š</p>

<pre><code class="language-bash">$ git tag v1.0 commitid
</code></pre>

<p>æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾ï¼š</p>

<pre><code class="language-bash">$ git tag
v1.0
</code></pre>

<p>æŸ¥çœ‹æ ‡ç­¾è¯¦ç»†ä¿¡æ¯ï¼š</p>

<pre><code class="language-bash">$ git show v1.0
</code></pre>

<p>åˆ é™¤æ ‡ç­¾ï¼š</p>

<pre><code class="language-bash">$ git tag -d v1.0
</code></pre>

<p>æœ¬åœ°æ ‡ç­¾ä¸ä¼šè‡ªåŠ¨æ¨é€è‡³è¿œç¨‹ï¼Œå¯ä»¥æ‰‹åŠ¨æ¨é€è‡³è¿œç¨‹åº“ï¼š</p>

<pre><code class="language-bash">$ git push origin v1.0   // æ¨é€æ ‡ç­¾åv1.0è‡³è¿œç¨‹åº“
$ git push origin --tags // æ¨é€æ‰€æœ‰æ ‡ç­¾è‡³è¿œç¨‹åº“
</code></pre>

<p>åˆ é™¤è¿œç¨‹åº“æ ‡ç­¾ï¼š</p>

<pre><code class="language-bash">$ git push origin :refs/tags/v1.0  // åˆ é™¤æ ‡ç­¾v1.0
</code></pre>

<h3 id="toc_21">16.å¤šäººåä½œçš„å·¥ä½œæµç¨‹</h3>

<p>å¤šäººåä½œçš„å·¥ä½œæ¨¡å¼é€šå¸¸æ˜¯è¿™æ ·ï¼š</p>

<ol>
<li><p>é¦–å…ˆï¼Œå¯ä»¥è¯•å›¾ç”¨git push origin <branch-name>æ¨é€è‡ªå·±çš„ä¿®æ”¹ï¼›</p></li>
<li><p>å¦‚æœæ¨é€å¤±è´¥ï¼Œåˆ™å› ä¸ºè¿œç¨‹åˆ†æ”¯æ¯”ä½ çš„æœ¬åœ°æ›´æ–°ï¼Œéœ€è¦å…ˆç”¨git pullè¯•å›¾åˆå¹¶ï¼›</p></li>
<li><p>å¦‚æœåˆå¹¶æœ‰å†²çªï¼Œåˆ™è§£å†³å†²çªï¼Œå¹¶åœ¨æœ¬åœ°æäº¤ï¼›</p></li>
<li><p>æ²¡æœ‰å†²çªæˆ–è€…è§£å†³æ‰å†²çªåï¼Œå†ç”¨git push origin <branch-name>æ¨é€å°±èƒ½æˆåŠŸï¼</p></li>
</ol>

<p>å¦‚æœgit pullæç¤ºno tracking informationï¼Œåˆ™è¯´æ˜æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„é“¾æ¥å…³ç³»æ²¡æœ‰åˆ›å»ºï¼Œç”¨å‘½ä»¤git branch --set-upstream-to <branch-name> origin/<branch-name>ã€‚</p>

<p>è¿™å°±æ˜¯å¤šäººåä½œçš„å·¥ä½œæ¨¡å¼ï¼Œä¸€æ—¦ç†Ÿæ‚‰äº†ï¼Œå°±éå¸¸ç®€å•ã€‚</p>

<h2 id="toc_22">ä¸‰ã€æ€»ç»“</h2>

<p>å–„ç”¨Gitçš„--helpå¯ä»¥å¸®åŠ©æ›´å¥½çš„ä½¿ç”¨å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-bash">$ git --help
$ git pull --help
</code></pre>

<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>

<tbody>
<tr>
<td>git config â€”global user.name â€œ&lt; username &gt;&quot;</td>
<td>é…ç½®ç”¨æˆ·å</td>
</tr>
<tr>
<td>git config â€”global user.email â€œ&lt; <a href="mailto:user@example.com">user@example.com</a> &gt;&quot;</td>
<td>é…ç½®é‚®ç®±</td>
</tr>
<tr>
<td>git init</td>
<td>åˆ›å»ºç‰ˆæœ¬åº“</td>
</tr>
<tr>
<td>git add &lt; file &gt;</td>
<td>æ·»åŠ æ–‡ä»¶åˆ°ç‰ˆæœ¬åº“ï¼ˆGitè¿½è¸ªè¯¥æ–‡ä»¶ï¼‰</td>
</tr>
<tr>
<td>git commit -m â€œ&lt; commit message &gt;&quot;</td>
<td>å°†æ”¹åŠ¨æäº¤åˆ°ç‰ˆæœ¬åº“</td>
</tr>
<tr>
<td>git log [--graph --pretty=oneline ...]</td>
<td>æŸ¥çœ‹ç‰ˆæœ¬åº“æ—¥å¿—ä¿¡æ¯</td>
</tr>
<tr>
<td>git reflog</td>
<td>æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œæ—¥å¿—</td>
</tr>
<tr>
<td>git reset --hard &lt; version &gt;</td>
<td>é‡ç½®ç‰ˆæœ¬,HEAD<sup>,HEAD~5,commit</sup> id</td>
</tr>
<tr>
<td>git status</td>
<td>æŸ¥çœ‹çŠ¶æ€</td>
</tr>
<tr>
<td>git diff &lt; version &gt;Â </td>
<td>æŸ¥çœ‹ç‰ˆæœ¬å’Œå½“å‰å·¥ä½œåŒºå·®å¼‚</td>
</tr>
<tr>
<td>git checkout â€” &lt; file &gt;</td>
<td>æ¢å¤è‡³æœ€è¿‘commitæˆ–addæ—¶çš„çŠ¶æ€</td>
</tr>
<tr>
<td>git rm &lt; file &gt;</td>
<td>ä»ç‰ˆæœ¬åº“åˆ é™¤æ–‡ä»¶</td>
</tr>
<tr>
<td>git remote add &lt; è¿œç¨‹åº“å &gt; &lt; address &gt;</td>
<td>å…³è”è¿œç¨‹ä»“åº“ï¼ˆè¿œç¨‹åº“åã€åœ°å€ï¼‰</td>
</tr>
<tr>
<td>git push [-u] &lt; è¿œç¨‹åº“å &gt; &lt; branch &gt;</td>
<td>æœ¬åœ°åº“å†…å®¹æ¨é€è‡³è¿œç¨‹ï¼Œç¬¬ä¸€æ¬¡åŠ -uï¼ˆï¼Œåˆ†æ”¯ï¼‰</td>
</tr>
<tr>
<td>git pull origin &lt; è¿œç¨‹åˆ†æ”¯å &gt;:&lt; æœ¬åœ°åˆ†æ”¯å &gt;</td>
<td>å°†è¿œç¨‹åº“çš„æ›´æ”¹åˆå¹¶è‡³å½“å‰åº“</td>
</tr>
<tr>
<td>git clone &lt; address &gt;</td>
<td>è¿œç¨‹ä»“åº“çš„å†…å®¹å…‹éš†åˆ°æœ¬åœ°</td>
</tr>
<tr>
<td>git branch &lt; branch &gt;</td>
<td>æ·»åŠ åˆ†æ”¯</td>
</tr>
<tr>
<td>git branch -d &lt; branch &gt;</td>
<td>åˆ é™¤åˆ†æ”¯</td>
</tr>
<tr>
<td>git branch</td>
<td>æ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯</td>
</tr>
<tr>
<td>git checkout &lt; branch &gt;</td>
<td>åˆ‡æ¢åˆ†æ”¯</td>
</tr>
<tr>
<td>git checkout -b &lt; branch &gt;</td>
<td>æ–°å»ºå¹¶åˆ‡æ¢åˆ†æ”¯</td>
</tr>
<tr>
<td>git merge &lt; branch &gt;</td>
<td>åˆå¹¶åˆ†æ”¯</td>
</tr>
<tr>
<td>git merge --no-ff -m â€œ&lt; commit message &gt;â€ &lt; branch &gt;</td>
<td>ç¦ç”¨Fast forwardæ¨¡å¼åˆå¹¶åˆ†æ”¯</td>
</tr>
<tr>
<td>git stash</td>
<td>éšè—å·²è·Ÿè¸ªæœªæäº¤çš„å·¥ä½œåŒºå†…å®¹</td>
</tr>
<tr>
<td>git stash list</td>
<td>æ˜¾ç¤ºstash</td>
</tr>
<tr>
<td>git stash apply</td>
<td>æ¢å¤éšè—å†…å®¹ï¼Œä½†ä¸åˆ é™¤</td>
</tr>
<tr>
<td>git stash drop</td>
<td>åˆ é™¤stashè®°å½•</td>
</tr>
<tr>
<td>git stash pop</td>
<td>æ¢å¤éšè—å†…å®¹ï¼Œå¹¶åˆ é™¤</td>
</tr>
<tr>
<td>git tag &lt; tag name &gt; [&lt; commit id &gt;]</td>
<td>æ·»åŠ æ ‡ç­¾</td>
</tr>
<tr>
<td>git tag</td>
<td>æ˜¾ç¤ºæ‰€æœ‰æ ‡ç­¾</td>
</tr>
<tr>
<td>git show &lt; tag name &gt;</td>
<td>æ˜¾ç¤ºtagè¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td>git tag -d &lt; tag name &gt;</td>
<td>åˆ é™¤æ ‡ç­¾</td>
</tr>
<tr>
<td>git push &lt; è¿œç¨‹åº“å &gt; &lt; tag name &gt;</td>
<td>æ¨é€æ ‡ç­¾è‡³è¿œç¨‹åº“</td>
</tr>
<tr>
<td>git push &lt; è¿œç¨‹åº“å &gt; --tags</td>
<td>æ¨é€æ‰€æœ‰æ ‡ç­¾è‡³è¿œç¨‹åº“</td>
</tr>
<tr>
<td>git push &lt; è¿œç¨‹åº“å &gt; :refs/tags/&lt; tag name &gt;</td>
<td>åˆ é™¤è¿œç¨‹åº“æ ‡ç­¾</td>
</tr>
</tbody>
</table>

<h2 id="toc_23">å››ã€å®é™…ä½¿ç”¨</h2>

<h3 id="toc_24">1ã€åœ¨GitHubä¸Šï¼Œä¿®æ”¹ä»–äººé¡¹ç›®çš„ä»£ç </h3>

<p>â‘  åœ¨GitHubä¸Šï¼Œå°†é¡¹ç›®ä»ä»–äººä»“åº“forkåˆ°è‡ªå·±ä»“åº“ï¼›</p>

<p>â‘¡ ä½¿ç”¨git cloneå°†è‡ªå·±ä»“åº“çš„é¡¹ç›®cloneåˆ°æœ¬åœ°ï¼›</p>

<p>â‘¢ ä¿®æ”¹å®Œä»£ç åï¼Œå°†ä¿®æ”¹pushåˆ°è‡ªå·±è¿œç¨‹ä»“åº“ï¼›</p>

<p>â‘£ åœ¨GitHubä¸Šï¼Œåˆ›å»ºPull Requestï¼Œç­‰å¾…åŸä»“åº“ç®¡ç†å‘˜çš„å®¡æ ¸ï¼›</p>

<h3 id="toc_25">2ã€Pull Requestè¢«åˆå¹¶å</h3>

<p>æœ€è¿‘åœ¨GitHubä¸Šä¿®æ”¹åˆ«äººçš„ä»£ç ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘åœ¨ç¬¬äºŒæ¬¡æäº¤Pull Requestæ—¶ï¼Œå°†ç¬¬ä¸€æ¬¡å·²åˆå¹¶çš„Pull Requestå†æ¬¡æäº¤äº†ä¸Šå»ã€‚ï¼ˆæ¯•ç«Ÿç¬¬ä¸€æ¬¡å˜›ğŸ˜‚   </p>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æˆ‘ä»¬çš„Pull Requestè¢«åˆå¹¶æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å·¥ä½œæœ‰ï¼š</p>

<blockquote>
<p>â‘  ç»™forké…ç½®è¿œç¨‹åº“ï¼š</p>

<p>ä½¿ç”¨<code>git remote -v</code>å¯ä»¥æŸ¥çœ‹è¿œç¨‹ä»“åº“çŠ¶æ€ã€‚å¦‚æœç»“æœä¸­æ²¡æœ‰åŸä»“åº“çš„é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨<code>git remote add è‡ªå®šä¹‰å åŸä»“åº“åœ°å€</code>è¿›è¡Œé…ç½®ï¼Œä¾‹å¦‚ï¼š<code>git remote add nickname https://github.com/username/repostory.git</code></p>

<p>â‘¡ ä½¿ç”¨<code>git fetch nickname</code>ä»åŸä»“åº“fetchåˆ†æ”¯å’Œæäº¤ç‚¹åˆ°æœ¬åœ°ï¼Œå¹¶å­˜å‚¨åˆ°æœ¬åœ°åˆ†æ”¯nickname/master</p>

<p>â‘¢ åˆ‡æ¢åˆ°masteråˆ†æ”¯ï¼š<code>git checkout master</code></p>

<p>â‘£ å°†nickname/masteråˆ†æ”¯åˆå¹¶åˆ°æœ¬åœ°masterï¼š<code>git merge nickname/master</code></p>

<p>â‘¤ æ›´æ–°åˆ°GitHubçš„forkä¸Šï¼š<code>git push origin master</code></p>

<p><strong>ï¼ˆåŸä»“åº“å³ä¸Šæ¸¸ä»“åº“ï¼‰</strong></p>
</blockquote>

<p><em>Mission Complete!</em></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[æ•°æ®åº“ä½¿ç”¨å’Œè®¾è®¡çš„ä¼˜åŒ–]]></title>
    <link href="https://anhoder.github.io/15981630682201.html"/>
    <updated>2020-08-23T14:11:08+08:00</updated>
    <id>https://anhoder.github.io/15981630682201.html</id>
    <content type="html"><![CDATA[
<p>è‡ªå·±æ”¶é›†çš„ä¸€äº›æ•°æ®åº“è®¾è®¡å’Œä½¿ç”¨çš„ä¼˜åŒ–æ–¹æ³•ã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">ä¼˜åŒ–SQLè¯­å¥</h2>

<ul>
<li>åº”é¿å…å…¨è¡¨æ‰«æï¼Œé¦–å…ˆåº”è€ƒè™‘åœ¨whereå’Œorder byçš„åˆ—ä¸Šå»ºç«‹ç´¢å¼•</li>
<li><p>é¿å…åœ¨whereæ¡ä»¶ä¸­è¿›è¡Œnullåˆ¤æ–­ï¼Œä¸”è¡¨çš„è®¾è®¡ä¹Ÿåº”è¯¥å°½é‡ä½¿ç”¨not null</p>
<blockquote>
<p>ã€Šé«˜æ€§èƒ½MySQLã€‹ä¹¦ä¸­æåˆ°ï¼šMySQLéš¾ä»¥ä¼˜åŒ–å¼•ç”¨å¯ä¸ºnullçš„æŸ¥è¯¢ï¼Œå®ƒä¼šä½¿ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ›´åŠ å¤æ‚ã€‚å¯ä¸ºnullçš„åˆ—éœ€è¦æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œè¿˜éœ€è¦mysqlå†…éƒ¨è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚å¯ç©ºåˆ—è¢«ç´¢å¼•åï¼Œæ¯æ¡è®°å½•éƒ½éœ€è¦ä¸€ä¸ªé¢å¤–çš„å­—èŠ‚ï¼Œè¿˜èƒ½å¯¼è‡´MyISAMä¸­å›ºå®šå¤§å°çš„ç´¢å¼•å˜æˆå¯å˜å¤§å°çš„ç´¢å¼•ã€‚</p>
</blockquote></li>
<li><p>åº”é¿å…ä½¿ç”¨<code>!=</code>æˆ–<code>&lt;&gt;</code>æ“ä½œç¬¦ï¼ŒMySQLåªæœ‰å¯¹ä»¥ä¸‹æ“ä½œæ‰ä½¿ç”¨ç´¢å¼•ï¼š<code>&lt;</code>ã€<code>&lt;=</code>ã€<code>=</code>ã€<code>=&gt;</code>ã€<code>&gt;</code>ã€<code>BETWEEN</code>ã€<code>IN</code>ã€ä»¥åŠå½¢å¦‚<code>name LIKE &#39;Alan%&#39;</code>çš„<code>LIKE</code>(%æ”¾åœ¨åé¢ï¼Œ%æ”¾åœ¨å‰é¢çš„å¯ä»¥ä½¿ç”¨å…¨æ–‡ç´¢å¼•)</p></li>
<li><p>åº”é¿å…åœ¨<code>where</code>ä¸­ä½¿ç”¨<code>or</code>æ¥è¿æ¥æ¡ä»¶ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œå¯ä»¥ä½¿ç”¨<code>union all</code>è¿›è¡Œè”åˆæŸ¥è¯¢</p></li>
<li><p>ä½¿ç”¨è”åˆæŸ¥è¯¢æ—¶ï¼Œåº”å°½é‡ä½¿ç”¨<code>union all</code>ä»£æ›¿<code>union</code>ï¼Œå› ä¸º<code>union</code>ä¼šå¯¹ç»“æœè¿›è¡Œå»é‡</p></li>
<li><p><code>in</code>å’Œ<code>not in</code>ä¹Ÿä¼šå¯¼è‡´å…¨è¡¨æ‰«æï¼Œå¯¹äºè¿ç»­çš„æ•°å€¼ï¼Œåº”å°½é‡ä½¿ç”¨<code>between ... and ...</code></p></li>
<li><p>é¿å…åœ¨<code>where</code>ä¸­å¯¹å­—æ®µè¿›è¡Œ<strong>è¡¨è¾¾å¼æ“ä½œ</strong>å’Œ<strong>å‡½æ•°æ“ä½œ</strong></p></li>
<li><p>é¿å…åœ¨<code>whereä¸­</code>ä½¿ç”¨å‚æ•°ï¼Œå…¶ä¹Ÿä¼šå¯¼è‡´å…¨è¡¨æ‰«æã€‚å› ä¸ºSQLåœ¨æ‰§è¡Œæ—¶æ‰èƒ½è§£æå±€éƒ¨å˜é‡ï¼Œå› æ­¤åœ¨ç¼–è¯‘æ—¶æ— æ³•å»ºç«‹ç´¢å¼•ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºå¼ºåˆ¶ä½¿ç”¨ç´¢å¼•ï¼š<code>SELECT id FROM table FORCE INDEX(index_name) WHERE num=@num</code></p></li>
<li><p>å¯ä»¥ä½¿ç”¨<code>exists</code>ä»£æ›¿<code>in</code></p></li>
<li><p>ä¸€å¼ è¡¨çš„ç´¢å¼•åº”å°½é‡ä¸å¤šäº6ä¸ªï¼Œè™½ç„¶ç´¢å¼•å¯ä»¥åŠ é€ŸæŸ¥è¯¢ï¼Œä½†åŒæ—¶ä¹Ÿæé«˜äº†ç´¢å¼•çš„ç»´æŠ¤æˆæœ¬ï¼Œé™ä½æ’å…¥æ•°æ®åŠæ›´æ–°æ•°æ®çš„é€Ÿåº¦</p></li>
<li><p>å°½å¯èƒ½é¿å…æ›´æ–°èšé›†(clustered)ç´¢å¼•æ•°æ®åˆ—ï¼Œå› ä¸ºæ“ä½œèšé›†ç´¢å¼•ä¼šæ¶ˆè€—ç›¸å½“å¤§çš„èµ„æºï¼ˆ<a href="mweblib://15628148741975">èšé›†ç´¢å¼•ã€éèšé›†ç´¢å¼•åŠä¸»é”®</a>ï¼‰</p></li>
<li><p>åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œä»¥æé«˜æŸ¥è¯¢å’Œè¿æ¥çš„æ€§èƒ½</p></li>
<li><p>ä½¿ç”¨<code>varchar</code>ä»£æ›¿<code>char</code></p></li>
<li><p>æŸ¥è¯¢æ—¶åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µï¼Œè€Œä¸æ˜¯ä½¿ç”¨<code>*</code></p></li>
<li><p>å½“è¿æ¥å¤šä¸ªè¡¨æ—¶ï¼Œä½¿ç”¨<code>as</code>è®¾ç½®è¡¨çš„åˆ«åå¹¶ä½¿ç”¨åˆ«åè®¿é—®åˆ—ï¼Œå¦‚ï¼š<code>SELECT t1.name, t2.class_name FROM table1 AS t1 JOIN table2 AS t2 ON t1.class_id=t2.id</code></p></li>
<li><p>å°½é‡å°‘ç”¨å­æŸ¥è¯¢</p></li>
<li><p>ä¸è¦è¶…è¿‡5ä¸ªä»¥ä¸Šçš„<code>JOIN</code>ï¼Œå¯ä»¥ä½¿ç”¨ä¸­é—´å˜é‡æˆ–ä¸´æ—¶è¡¨å­˜æ”¾ä¸­é—´ç»“æœ</p></li>
<li><p>ç»Ÿè®¡è¡Œæ•°æ—¶ä½¿ç”¨<code>COUNT(*)</code></p></li>
<li><p>å°½é‡ä½¿ç”¨<code>&gt;=</code>ä»£æ›¿<code>&gt;</code></p></li>
<li><p>é€šè¿‡å°†ä¸éœ€è¦çš„è®°å½•åœ¨<code>GROUP BY</code>ä¹‹å‰è¿‡æ»¤æ‰</p></li>
<li><p>ä½¿ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—æŸ¥çœ‹æ…¢æŸ¥è¯¢çš„è¯­å¥</p></li>
<li><p>ä½¿ç”¨<code>explain</code>åˆ†æSQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’</p></li>
<li><p>ä½¿ç”¨<code>LIMIT</code>æŸ¥è¯¢åªéœ€è¦çš„æ•°æ®</p></li>
<li><p>å»ºç«‹ç´¢å¼•<code>index(a,b,c)</code>ï¼Œå­˜å‚¨å¼•æ“ä¸èƒ½ä½¿ç”¨ç´¢å¼•èŒƒå›´æ¡ä»¶å³è¾¹çš„åˆ—ä½œä¸ºç´¢å¼•ï¼Œä¾‹å¦‚ï¼š<code>select * from where a=&#39;Alan&#39; and b&gt;25 and c=&#39;dev&#39;</code>ï¼Œæ­¤æ—¶ï¼Œåªæœ‰aå’Œbä½¿ç”¨åˆ°ç´¢å¼•</p></li>
<li><p>å°½é‡åªè®¿é—®ç´¢å¼•åˆ—çš„æŸ¥è¯¢ï¼Œé¿å…<code>select *</code></p></li>
<li><p><code>is null</code>æˆ–<code>is not null</code>ä¹Ÿä¼šæ— æ³•ä½¿ç”¨ç´¢å¼•</p></li>
<li><p>éšå¼è½¬æ¢ï¼š<code>select * from test where name=123</code>ï¼Œæ­¤æ—¶ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œåº”ä¸º<code>name</code>åŠ ä¸Šå•å¼•å·</p></li>
<li><p>å°‘ç”¨<code>or</code></p></li>
</ul>

<h2 id="toc_1">å¦‚ä½•å»ºç«‹ç´¢å¼•</h2>

<ul>
<li>æ¯ä¸ªè¡¨éƒ½éœ€è¦ä¸»é”®ç´¢å¼•</li>
<li>æ•°æ®é‡è¶…è¿‡300çš„è¡¨åº”è¯¥å»ºç«‹ç´¢å¼•</li>
<li>å¯¹ç»å¸¸å‡ºç°åœ¨whereæ¡ä»¶ä¸­æˆ–order byä¸­çš„å­—æ®µå»ºç«‹ç´¢å¼•</li>
<li>ç»å¸¸éœ€è¦ä¸å…¶ä»–è¡¨è¿›è¡Œè¿æ¥çš„è¡¨ï¼Œåœ¨å…¶è¿æ¥å­—æ®µä¸Šå»ºç«‹ç´¢å¼•</li>
<li>ç´¢å¼•åº”è¯¥å»ºç«‹åœ¨æ•°æ®é‡å°çš„å­—æ®µ</li>
<li>é¢‘ç¹è¿›è¡Œæ•°æ®æ“ä½œçš„è¡¨ä¸åº”å»ºç«‹è¿‡å¤šç´¢å¼•</li>
<li>å¤åˆç´¢å¼•åº”æ³¨æ„å‰ç¼€åŸåˆ™</li>
</ul>

<h2 id="toc_2">æ…ç”¨</h2>

<ul>
<li><code>NULL</code></li>
<li><code>!=</code>æˆ–<code>&lt;&gt;</code></li>
<li>å½¢å¦‚<code>name LIKE %Alan</code>çš„<code>LIKE</code></li>
<li><code>IN</code>å’Œ<code>NOT IN</code></li>
<li><code>*</code></li>
<li>å­æŸ¥è¯¢</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SVNå‘½ä»¤çš„ä½¿ç”¨]]></title>
    <link href="https://anhoder.github.io/15981624934747.html"/>
    <updated>2020-08-23T14:01:33+08:00</updated>
    <id>https://anhoder.github.io/15981624934747.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<p><em>Mission Start!</em></p>

<h2 id="toc_0">svnadmin</h2>

<h3 id="toc_1">1ã€ä½¿ç”¨svnadminåˆå§‹åŒ–SVNé¡¹ç›®:</h3>

<pre><code class="language-bash">svnadmin create /home/user1/project
</code></pre>

<h3 id="toc_2">2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶</h3>

<p>â‘  ä¿®æ”¹passwdï¼Œæ·»åŠ ç”¨æˆ·å¯†ç ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-ini">[users]
alan = 123456
</code></pre>

<p>â‘¡ ä¿®æ”¹æƒé™æ–‡ä»¶authzï¼Œç»™ç”¨æˆ·è®¾ç½®æƒé™ï¼š</p>

<pre><code class="language-ini">[aliases]

[groups]

[/]
alan = rw
</code></pre>

<p>â‘¢ ä¿®æ”¹SVNæœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼š</p>

<pre><code class="language-ini">[general]
# ä»¥ä¸‹ä¸¤ä¸ªé…ç½®çš„å¯é€‰é€‰é¡¹æœ‰readã€writeã€noneï¼Œreadä¸ºåªè¯»æƒé™ï¼Œwriteä¸ºå¯è¯»å¯å†™æƒé™ï¼Œnoneä¸ºä¸å¯è¯»ä¸å¯å†™
# æœªè®¤è¯ç”¨æˆ·æƒé™
anon-access = read    
# è®¤è¯ç”¨æˆ·æƒé™
auth-access = write  

# ç”¨æˆ·å¯†ç æ•°æ®ï¼ŒæŒ‡å®šä¸ºç¬¬ä¸€æ­¥ä¿®æ”¹çš„æ–‡ä»¶
password-db = passwd
# ç”¨æˆ·æƒé™æ•°æ®ï¼ŒæŒ‡å®šä¸ºç¬¬äºŒæ­¥ä¿®æ”¹çš„æ–‡ä»¶
authz-db = authz
</code></pre>

<h2 id="toc_3">svnserve</h2>

<p>svnserveå‘½ä»¤ç”¨äºå¯åŠ¨SVNæœåŠ¡ã€‚å¯é€‰å‚æ•°æœ‰ï¼š</p>

<blockquote>
<p>-r: æŒ‡å®šSVNæœåŠ¡çš„rootç›®å½•<br/>
-d: Daemonå®ˆæŠ¤ç¨‹åºæ–¹å¼è¿è¡Œ<br/>
-R: Read Only<br/>
-i: è¶…çº§æœåŠ¡å™¨æ¨¡å¼<br/>
-t: éš§é“æ¨¡å¼</p>
</blockquote>

<p>å¯åŠ¨SVNæœåŠ¡ï¼š</p>

<pre><code class="language-bash">svnserve -d -r /home/user1/project
</code></pre>

<h2 id="toc_4">svn</h2>

<h3 id="toc_5">1ã€ä»SVNæœåŠ¡å™¨ä¸‹æ‹‰ä»£ç </h3>

<pre><code class="language-bash">svn chekout svn://127.0.0.1
// æˆ– svn co svn://127.0.0.1
</code></pre>

<h3 id="toc_6">2ã€æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•ä¸‹çš„æ–‡ä»¶çŠ¶æ€</h3>

<pre><code class="language-bash">svn status
// æˆ– svn st
// ? è¡¨ç¤ºæœªåœ¨SVNçš„æ§åˆ¶ä¸‹
// M è¡¨ç¤ºå·²ä¿®æ”¹
// A è¡¨ç¤ºå·²æ·»åŠ 
// D è¡¨ç¤ºå·²åˆ é™¤
// C è¡¨ç¤ºå†²çªæ–‡ä»¶
// I è¡¨ç¤ºå¿½ç•¥çš„æ–‡ä»¶
// R è¡¨ç¤ºè¢«æ›¿æ¢
</code></pre>

<h3 id="toc_7">3ã€æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•ä¸‹æ–‡ä»¶çš„ç‰ˆæœ¬å·®å¼‚</h3>

<pre><code class="language-bash">svn diff [file]
// fileä¸ºå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºæŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„å·®å¼‚
svn diff -r m:n file
// æŸ¥çœ‹mç‰ˆæœ¬å’Œnç‰ˆæœ¬çš„æ–‡ä»¶å·®å¼‚

</code></pre>

<h3 id="toc_8">4ã€æäº¤æ–‡ä»¶åˆ°SVNæœåŠ¡å™¨</h3>

<pre><code class="language-bash">svn commit -m &#39;ã€æ–°å¢ã€‘a.php&#39;
// æˆ– svn ci -m &#39;ã€æ–°å¢ã€‘a.php&#39;
</code></pre>

<h3 id="toc_9">5ã€ä»SVNæœåŠ¡å™¨æ›´æ–°æ–‡ä»¶åˆ°æœ¬åœ°</h3>

<pre><code class="language-bash">svn update [file]
// æˆ– svn up [file]
// fileä¸ºå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºåªæ›´æ–°æŒ‡å®šæ–‡ä»¶å†…å®¹
</code></pre>

<h3 id="toc_10">6ã€åŠ é”ä¸è§£é”</h3>

<pre><code class="language-bash">// åŠ é”ï¼Œé”å®šç›®å½•ï¼Œè®©åˆ«äººæ— æ³•æäº¤æ›´æ–°åˆ°è¿™é‡Œ
svn lock file -m &#39;ã€é”å®šã€‘a.php&#39;
// è§£é”
svn unlock file
</code></pre>

<h3 id="toc_11">7ã€æŸ¥çœ‹SVNæ—¥å¿—</h3>

<pre><code class="language-bash">svn log [file]
// æŸ¥çœ‹ç‰ˆæœ¬æ—¥å¿—ä¿¡æ¯
</code></pre>

<h3 id="toc_12">8ã€æŸ¥çœ‹æ–‡ä»¶æˆ–é¡¹ç›®è¯¦ç»†ä¿¡æ¯</h3>

<pre><code class="language-bash">svn info [file]
</code></pre>

<h3 id="toc_13">9ã€åˆå¹¶åˆ†æ”¯</h3>

<pre><code class="language-bash">svn merge -r m:n file
// åˆå¹¶mç‰ˆæœ¬å’Œnç‰ˆæœ¬çš„fileæ–‡ä»¶å·®å¼‚ï¼Œä¾‹å¦‚ï¼šsvn merge -r 500:502 a.php
</code></pre>

<h3 id="toc_14">10ã€æ¢å¤æœ¬åœ°ä¿®æ”¹</h3>

<pre><code class="language-bash">svn revert file
</code></pre>

<h3 id="toc_15">11ã€ç§»é™¤å†²çªçŠ¶æ€</h3>

<p>åœ¨å¤„ç†å®Œæ–‡ä»¶å†²çªåï¼Œå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤ç§»é™¤æ–‡ä»¶å†²çªçš„çŠ¶æ€ï¼š</p>

<pre><code class="language-bash">svn resolved file
</code></pre>

<h3 id="toc_16">SVNä»£ç åº“è¡¨æ›´</h3>

<pre><code class="language-bash">svn switch URL
</code></pre>

<p><em>Mission Complete!</em></p>

]]></content>
  </entry>
  
</feed>
